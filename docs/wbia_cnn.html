<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>wbia_cnn package &mdash; wbia-cnn 4.0.1.dev0+dirty documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="wbia_cnn.models package" href="wbia_cnn.models.html" />
    <link rel="prev" title="Welcome to wbia_cnn’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> wbia-cnn
          </a>
              <div class="version">
                4.0.1.dev0+dirty
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">wbia_cnn package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="wbia_cnn.models.html">wbia_cnn.models package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-wbia_cnn.__main__">wbia_cnn.__main__ module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-wbia_cnn._plugin">wbia_cnn._plugin module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-wbia_cnn._plugin_grabmodels">wbia_cnn._plugin_grabmodels module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-wbia_cnn.augment">wbia_cnn.augment module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-wbia_cnn.batch_processing">wbia_cnn.batch_processing module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-wbia_cnn.custom_layers">wbia_cnn.custom_layers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-wbia_cnn.dataset">wbia_cnn.dataset module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-wbia_cnn.draw_net">wbia_cnn.draw_net module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-wbia_cnn.draw_results">wbia_cnn.draw_results module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-wbia_cnn.experiments">wbia_cnn.experiments module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-wbia_cnn.harness">wbia_cnn.harness module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-wbia_cnn.ingest_data">wbia_cnn.ingest_data module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-wbia_cnn.ingest_helpers">wbia_cnn.ingest_helpers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-wbia_cnn.ingest_wbia">wbia_cnn.ingest_wbia module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-wbia_cnn.lasagne_ext">wbia_cnn.lasagne_ext module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-wbia_cnn.net_strs">wbia_cnn.net_strs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-wbia_cnn.netrun">wbia_cnn.netrun module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-wbia_cnn.process">wbia_cnn.process module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-wbia_cnn.sandbox">wbia_cnn.sandbox module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-wbia_cnn.test">wbia_cnn.test module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-wbia_cnn.theano_ext">wbia_cnn.theano_ext module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-wbia_cnn.utils">wbia_cnn.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-wbia_cnn">Module contents</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">wbia-cnn</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>wbia_cnn package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/wbia_cnn.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="wbia-cnn-package">
<h1>wbia_cnn package<a class="headerlink" href="#wbia-cnn-package" title="Permalink to this headline"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="wbia_cnn.models.html">wbia_cnn.models package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.models.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.models.html#module-wbia_cnn.models._model_legacy">wbia_cnn.models._model_legacy module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.models.html#module-wbia_cnn.models.abstract_models">wbia_cnn.models.abstract_models module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.models.html#module-wbia_cnn.models.aoi">wbia_cnn.models.aoi module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.models.html#module-wbia_cnn.models.aoi2">wbia_cnn.models.aoi2 module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.models.html#module-wbia_cnn.models.background">wbia_cnn.models.background module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.models.html#module-wbia_cnn.models.classifier">wbia_cnn.models.classifier module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.models.html#module-wbia_cnn.models.classifier2">wbia_cnn.models.classifier2 module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.models.html#module-wbia_cnn.models.dummy">wbia_cnn.models.dummy module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.models.html#module-wbia_cnn.models.labeler">wbia_cnn.models.labeler module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.models.html#module-wbia_cnn.models.mnist">wbia_cnn.models.mnist module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.models.html#module-wbia_cnn.models.pretrained">wbia_cnn.models.pretrained module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.models.html#module-wbia_cnn.models.quality">wbia_cnn.models.quality module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.models.html#module-wbia_cnn.models.siam">wbia_cnn.models.siam module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.models.html#module-wbia_cnn.models.viewpoint">wbia_cnn.models.viewpoint module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.models.html#module-wbia_cnn.models">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline"></a></h2>
</section>
<section id="module-wbia_cnn.__main__">
<span id="wbia-cnn-main-module"></span><h2>wbia_cnn.__main__ module<a class="headerlink" href="#module-wbia_cnn.__main__" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.__main__.main">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.__main__.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/__main__.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.__main__.main" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-wbia_cnn._plugin">
<span id="wbia-cnn-plugin-module"></span><h2>wbia_cnn._plugin module<a class="headerlink" href="#module-wbia_cnn._plugin" title="Permalink to this headline"></a></h2>
<p>tests a test set of data using a specified, pre-trained model and weights</p>
<p>python -c “import wbia_cnn”</p>
<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn._plugin.convert_label">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn._plugin.</span></span><span class="sig-name descname"><span class="pre">convert_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/_plugin.html#convert_label"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn._plugin.convert_label" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn._plugin.convert_species_viewpoint">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn._plugin.</span></span><span class="sig-name descname"><span class="pre">convert_species_viewpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">viewpoint</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/_plugin.html#convert_species_viewpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn._plugin.convert_species_viewpoint" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn._plugin.detect_annot_species_viewpoint_cnn">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn._plugin.</span></span><span class="sig-name descname"><span class="pre">detect_annot_species_viewpoint_cnn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aid_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/_plugin.html#detect_annot_species_viewpoint_cnn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn._plugin.detect_annot_species_viewpoint_cnn" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ibs</strong> (<em>IBEISController</em>) – ibeis controller object</p></li>
<li><p><strong>aid_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – list of annotation ids</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>species_viewpoint_list</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn._plugin –exec-detect_annot_species_viewpoint_cnn</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn._plugin</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">wbia</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s1">&#39;testdb1&#39;</span><span class="p">,</span> <span class="n">allow_newdir</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">species_viewpoint_list</span> <span class="o">=</span> <span class="n">detect_annot_species_viewpoint_cnn</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;species_viewpoint_list = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">species_viewpoint_list</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn._plugin.detect_annot_whale_fluke_background_mask">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn._plugin.</span></span><span class="sig-name descname"><span class="pre">detect_annot_whale_fluke_background_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aid_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'whale_fluke'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config2_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/_plugin.html#detect_annot_whale_fluke_background_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn._plugin.detect_annot_whale_fluke_background_mask" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ibs</strong> (<em>IBEISController</em>) – ibeis controller object</p></li>
<li><p><strong>aid_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – list of annotation ids</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mask_list</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn._plugin.detect_annot_zebra_background_mask">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn._plugin.</span></span><span class="sig-name descname"><span class="pre">detect_annot_zebra_background_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aid_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config2_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/_plugin.html#detect_annot_zebra_background_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn._plugin.detect_annot_zebra_background_mask" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ibs</strong> (<em>IBEISController</em>) – ibeis controller object</p></li>
<li><p><strong>aid_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – list of annotation ids</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mask_list</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn._plugin.detect_image_cnn">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn._plugin.</span></span><span class="sig-name descname"><span class="pre">detect_image_cnn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bing'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/_plugin.html#detect_image_cnn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn._plugin.detect_image_cnn" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ibs</strong> (<em>IBEISController</em>) – ibeis controller object</p></li>
<li><p><strong>gid</strong> – </p></li>
<li><p><strong>confidence</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – (default = 0.9)</p></li>
<li><p><strong>extraction</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – (default = ‘bing’)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn._plugin –exec-detect_image_cnn</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn._plugin</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn._plugin</span> <span class="kn">import</span> <span class="n">_suggest_random_candidate_regions</span><span class="p">,</span> <span class="n">_suggest_bing_candidate_regions</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">wbia</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s1">&#39;testdb1&#39;</span><span class="p">,</span> <span class="n">allow_newdir</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gid</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">confidence</span> <span class="o">=</span> <span class="mf">0.9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extraction</span> <span class="o">=</span> <span class="s1">&#39;bing&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">detect_image_cnn</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">gid</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">extraction</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn._plugin.extract_siam128_vecs">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn._plugin.</span></span><span class="sig-name descname"><span class="pre">extract_siam128_vecs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chip_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/_plugin.html#extract_siam128_vecs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn._plugin.extract_siam128_vecs" title="Permalink to this definition"></a></dt>
<dd><p>Duplicate testing func for vtool</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn._plugin.fix_annot_species_viewpoint_quality_cnn">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn._plugin.</span></span><span class="sig-name descname"><span class="pre">fix_annot_species_viewpoint_quality_cnn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aid_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_conf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/_plugin.html#fix_annot_species_viewpoint_quality_cnn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn._plugin.fix_annot_species_viewpoint_quality_cnn" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ibs</strong> (<em>IBEISController</em>) – ibeis controller object</p></li>
<li><p><strong>aid_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – list of annotation ids</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn._plugin.generate_chip_label_list">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn._plugin.</span></span><span class="sig-name descname"><span class="pre">generate_chip_label_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chip_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nInput</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labeler_weight_filepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/_plugin.html#generate_chip_label_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn._plugin.generate_chip_label_list" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn._plugin.generate_siam_l2_128_feats">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn._plugin.</span></span><span class="sig-name descname"><span class="pre">generate_siam_l2_128_feats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cid_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config2_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/_plugin.html#generate_siam_l2_128_feats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn._plugin.generate_siam_l2_128_feats" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ibs</strong> (<em>IBEISController</em>) – ibeis controller object</p></li>
<li><p><strong>cid_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>config2</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) – (default = None)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn._plugin –test-generate_siam_l2_128_feats
python -m wbia_cnn._plugin –test-generate_siam_l2_128_feats –db PZ_Master0</p>
</dd>
<dt>SeeAlso:</dt><dd><p>~/code/ibeis/ibeis/algo/preproc/preproc_feat.py</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn._plugin</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">wbia</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s1">&#39;testdb1&#39;</span><span class="p">,</span> <span class="n">allow_newdir</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">depc_annot</span><span class="o">.</span><span class="n">get_rowids</span><span class="p">(</span><span class="s1">&#39;chips&#39;</span><span class="p">,</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config2_</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># megahack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">FeatureConfig</span><span class="p">()</span> <span class="c1"># fixme</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config2_</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">feat_type</span><span class="o">=</span><span class="s1">&#39;hesaff+siam128&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="n">feat_cfgstr</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">feat_cfg</span><span class="o">.</span><span class="n">get_cfgstr</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;sift&#39;</span><span class="p">,</span> <span class="s1">&#39;siam128&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="n">hesaff_params</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">feat_cfg</span><span class="o">.</span><span class="n">get_hesaff_params</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">featgen</span> <span class="o">=</span> <span class="n">generate_siam_l2_128_feats</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">cid_list</span><span class="p">,</span> <span class="n">config2_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">depth_profile</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">featgen</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn._plugin.generate_species_background">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn._plugin.</span></span><span class="sig-name descname"><span class="pre">generate_species_background</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chip_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nInput</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/_plugin.html#generate_species_background"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn._plugin.generate_species_background" title="Permalink to this definition"></a></dt>
<dd><p>TODO: Use this as the primary function</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn._plugin –exec-generate_species_background –db PZ_MTEST –species=zebra_plains –show
python -m wbia_cnn._plugin –exec-generate_species_background –db GZ_Master1 –species=zebra_grevys –save cnn_detect_results_gz.png –diskshow –clipwhite
python -m wbia_cnn._plugin –exec-generate_species_background –db PZ_Master1 –species=zebra_plains –save cnn_detect_results_pz.png –diskshow –clipwhite
python -m wbia_cnn._plugin –exec-generate_species_background –db PZ_Master1 –show
python -m wbia_cnn._plugin –exec-generate_species_background –db GZ_Master1 –show
python -m wbia_cnn._plugin –exec-generate_species_background –db GIRM_Master1 –show –species=giraffe_masai</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia_cnn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn._plugin</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">wbia</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s1">&#39;testdb1&#39;</span><span class="p">,</span> <span class="n">allow_newdir</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">species</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--species&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;zebra_plains&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config2_</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nInput</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chip_iter</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_chips</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="n">config2_</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask_iter</span> <span class="o">=</span> <span class="n">generate_species_background</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">chip_iter</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="n">species</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="n">nInput</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mask_iter</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia</span> <span class="kn">import</span> <span class="n">plottool</span> <span class="k">as</span> <span class="n">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chip_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_chips</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">config2_</span><span class="o">=</span><span class="n">config2_</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stacked_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">vt</span><span class="o">.</span><span class="n">stack_images</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">mask</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">chip</span><span class="p">,</span> <span class="n">mask</span> <span class="ow">in</span>  <span class="nb">zip</span><span class="p">(</span><span class="n">chip_list</span><span class="p">,</span> <span class="n">mask_list</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iteract_obj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">interact_multi_image</span><span class="o">.</span><span class="n">MultiImageInteraction</span><span class="p">(</span><span class="n">stacked_list</span><span class="p">,</span> <span class="n">nPerPage</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iteract_obj</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#hough_cpath = ibs.get_annot_probchip_fpath(aid_list, config2_=config2_)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#iteract_obj2 = pt.interact_multi_image.MultiImageInteraction(hough_cpath, nPerPage=4)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.imshow(mask_list[0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="simple">
<dt>Ignore:</dt><dd><p>#&gt;&gt;&gt; from wbia_cnn.draw_results import *  # NOQA
#&gt;&gt;&gt; from wbia_cnn import ingest_data
#&gt;&gt;&gt; data, labels = ingest_data.testdata_patchmatch2()
#&gt;&gt;&gt; flat_metadata = {‘fs’: np.arange(len(labels))}
#&gt;&gt;&gt; result = interact_siamsese_data_patches(labels, data, flat_metadata)
#&gt;&gt;&gt; ut.show_if_requested()</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn._plugin.generate_species_background_mask">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn._plugin.</span></span><span class="sig-name descname"><span class="pre">generate_species_background_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chip_fpath_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/_plugin.html#generate_species_background_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn._plugin.generate_species_background_mask" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ibs</strong> (<em>IBEISController</em>) – ibeis controller object</p></li>
<li><p><strong>aid_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – list of annotation ids</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>species_viewpoint_list</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn._plugin –exec-generate_species_background_mask –show –db PZ_Master1
python -m wbia_cnn –tf generate_species_background_mask –show –db PZ_Master1 –aid 9970</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia_cnn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn._plugin</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">wbia</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s1">&#39;testdb1&#39;</span><span class="p">,</span> <span class="n">allow_newdir</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aid_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">((</span><span class="s1">&#39;--aids&#39;</span><span class="p">,</span> <span class="s1">&#39;--aid&#39;</span><span class="p">),</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chip_fpath_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_chip_fpath</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">species</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">TEST_SPECIES</span><span class="o">.</span><span class="n">ZEB_PLAIN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask_list</span> <span class="o">=</span> <span class="n">generate_species_background_mask</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">chip_fpath_list</span><span class="p">,</span> <span class="n">species</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mask_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia</span> <span class="kn">import</span> <span class="n">plottool</span> <span class="k">as</span> <span class="n">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iteract_obj</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">interact_multi_image</span><span class="o">.</span><span class="n">MultiImageInteraction</span><span class="p">(</span><span class="n">mask_list</span><span class="p">,</span> <span class="n">nPerPage</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.imshow(mask_list[0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p>#&gt;&gt;&gt; from wbia_cnn.draw_results import *  # NOQA
#&gt;&gt;&gt; from wbia_cnn import ingest_data
#&gt;&gt;&gt; data, labels = ingest_data.testdata_patchmatch2()
#&gt;&gt;&gt; flat_metadata = {‘fs’: np.arange(len(labels))}
#&gt;&gt;&gt; result = interact_siamsese_data_patches(labels, data, flat_metadata)
#&gt;&gt;&gt; ut.show_if_requested()</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn._plugin.generate_thumbnail_aoi2_list">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn._plugin.</span></span><span class="sig-name descname"><span class="pre">generate_thumbnail_aoi2_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thumbnail_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nInput</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aoi_two_weight_filepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/_plugin.html#generate_thumbnail_aoi2_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn._plugin.generate_thumbnail_aoi2_list" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn._plugin.generate_thumbnail_class2_list">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn._plugin.</span></span><span class="sig-name descname"><span class="pre">generate_thumbnail_class2_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thumbnail_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nInput</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier_two_weight_filepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/_plugin.html#generate_thumbnail_class2_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn._plugin.generate_thumbnail_class2_list" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn._plugin.generate_thumbnail_class_list">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn._plugin.</span></span><span class="sig-name descname"><span class="pre">generate_thumbnail_class_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thumbnail_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nInput</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier_weight_filepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/_plugin.html#generate_thumbnail_class_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn._plugin.generate_thumbnail_class_list" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn._plugin.get_neuralnet_dir">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn._plugin.</span></span><span class="sig-name descname"><span class="pre">get_neuralnet_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/_plugin.html#get_neuralnet_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn._plugin.get_neuralnet_dir" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn._plugin.get_siam_l2_model">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn._plugin.</span></span><span class="sig-name descname"><span class="pre">get_siam_l2_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/_plugin.html#get_siam_l2_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn._plugin.get_siam_l2_model" title="Permalink to this definition"></a></dt>
<dd><p>model.show_weights_image()</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn._plugin.get_verified_aid_pairs">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn._plugin.</span></span><span class="sig-name descname"><span class="pre">get_verified_aid_pairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/_plugin.html#get_verified_aid_pairs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn._plugin.get_verified_aid_pairs" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn._plugin</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">wbia</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s1">&#39;NNP_Master3&#39;</span><span class="p">,</span> <span class="n">allow_newdir</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verified_aid1_list</span><span class="p">,</span> <span class="n">verified_aid2_list</span> <span class="o">=</span> <span class="n">get_verified_aid_pairs</span><span class="p">(</span><span class="n">ibs</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn._plugin.non_max_suppression_fast">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn._plugin.</span></span><span class="sig-name descname"><span class="pre">non_max_suppression_fast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlapThresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/_plugin.html#non_max_suppression_fast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn._plugin.non_max_suppression_fast" title="Permalink to this definition"></a></dt>
<dd><p>Python version of Malisiewicz’s Matlab code:
<a class="reference external" href="https://github.com/quantombone/exemplarsvm">https://github.com/quantombone/exemplarsvm</a></p>
<p>NOTE: This is adapted from Pedro Felzenszwalb’s version (nms.m),
but an inner loop has been eliminated to significantly speed it
up in the case of a large number of boxes</p>
<p>Reference: <a class="reference external" href="https://github.com/rbgirshick/rcnn/blob/master/nms/nms.m">https://github.com/rbgirshick/rcnn/blob/master/nms/nms.m</a>
Reference: <a class="reference external" href="http://www.pyimagesearch.com/2015/02/16/faster-non-maximum-suppression-python/">http://www.pyimagesearch.com/2015/02/16/faster-non-maximum-suppression-python/</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn._plugin.test_convolutional">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn._plugin.</span></span><span class="sig-name descname"><span class="pre">test_convolutional</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/_plugin.html#test_convolutional"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn._plugin.test_convolutional" title="Permalink to this definition"></a></dt>
<dd><p>Using a network, test an entire image full convolutionally</p>
<p>This function will test an entire image full convolutionally (or a close
approximation of full convolutionally).  The CUDA framework and driver is a
limiting factor for how large an image can be given to a network for full
convolutional inference.  As a result, we implement a non-overlapping (or
little overlapping) patch extraction approximation that processes the entire
image within a single batch or very few batches.  This is an extremely
efficient process for processing an image with a CNN.</p>
<p>The patches are given a slight overlap in order to smooth the effects of
boundary conditions, which are seen on every patch.  We also mirror the
border of each patch and add an additional amount of padding to cater to the
architecture’s receptive field reduction.</p>
<p>See <code class="xref py py-func docutils literal notranslate"><span class="pre">utils.extract_patches_stride()</span></code> for patch extraction behavior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Model</em>) – the network to use to perform feedforward inference</p></li>
<li><p><strong>image</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><em>numpy.ndarray</em></a>) – the image passed in to make a coreresponding
sized dictionarf of response maps</p></li>
<li><p><strong>patch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>tuple of int</em><em>, </em><em>optional</em>) – the size of the patches
extracted across the image, passed in as a 2-tuple of (width,
height).  Defaults to (200, 200).</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>tuple of int</em><em>, </em><em>optional</em>) – the stride of the patches
extracted across the image.  Defaults to [patch_size - padding].</p></li>
<li><p><strong>padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the mirrored padding added to every patch
during testing, which can be used to offset the effects of the
receptive field reduction in the network.  Defaults to 32.</p></li>
<li><p><strong>**kwargs</strong> – arbitrary keyword arguments, passed to
<code class="xref py py-func docutils literal notranslate"><span class="pre">model.test()</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>the number of total</dt><dd><p>samples used to generate the response map and the actual response
maps themselves as a dictionary.  The dictionary uses the class
labels as the strings and the numpy array image as the values.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>samples, canvas_dict (tuple of int and dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn._plugin.validate_annot_species_viewpoint_cnn">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn._plugin.</span></span><span class="sig-name descname"><span class="pre">validate_annot_species_viewpoint_cnn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aid_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/_plugin.html#validate_annot_species_viewpoint_cnn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn._plugin.validate_annot_species_viewpoint_cnn" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ibs</strong> (<em>IBEISController</em>) – ibeis controller object</p></li>
<li><p><strong>aid_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – list of annotation ids</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – verbosity flag(default = False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(bad_species_list, bad_viewpoint_list)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-wbia_cnn._plugin_grabmodels">
<span id="wbia-cnn-plugin-grabmodels-module"></span><h2>wbia_cnn._plugin_grabmodels module<a class="headerlink" href="#module-wbia_cnn._plugin_grabmodels" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn._plugin_grabmodels.ensure_model">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn._plugin_grabmodels.</span></span><span class="sig-name descname"><span class="pre">ensure_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redownload</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/_plugin_grabmodels.html#ensure_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn._plugin_grabmodels.ensure_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-wbia_cnn.augment">
<span id="wbia-cnn-augment-module"></span><h2>wbia_cnn.augment module<a class="headerlink" href="#module-wbia_cnn.augment" title="Permalink to this headline"></a></h2>
<p>Core functions for data augmentation</p>
<p class="rubric">References</p>
<p><a class="reference external" href="https://github.com/benanne/kaggle-ndsb/blob/master/data.py">https://github.com/benanne/kaggle-ndsb/blob/master/data.py</a></p>
<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.augment.affine_perterb">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.augment.</span></span><span class="sig-name descname"><span class="pre">affine_perterb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng=&lt;module</span> <span class="pre">'numpy.random'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/numpy/random/__init__.py'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/augment.html#affine_perterb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.augment.affine_perterb" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>ndarray</em><em>[</em><em>uint8_t</em><em>, </em><em>ndim=2</em><em>]</em>) – image data</p></li>
<li><p><strong>rng</strong> (<em>module</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>img_warped</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.augment –test-affine_perterb –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.augment</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">grab_test_imgpath</span><span class="p">(</span><span class="s1">&#39;carl.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_fpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span>   <span class="c1">#.RandomState(0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_warped</span> <span class="o">=</span> <span class="n">affine_perterb</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia</span> <span class="kn">import</span> <span class="n">plottool</span> <span class="k">as</span> <span class="n">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_warped</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.augment.augment_affine">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.augment.</span></span><span class="sig-name descname"><span class="pre">augment_affine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng=&lt;module</span> <span class="pre">'numpy.random'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/numpy/random/__init__.py'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_per_label=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affperterb_ranges=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aug_prop=0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/augment.html#augment_affine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.augment.augment_affine" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.augment –test-augment_affine –show
utprof.py -m wbia_cnn.augment –test-augment_affine</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.augment</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="n">mnist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">testdata_mnist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">batch_size</span><span class="p">]</span> <span class="o">/</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yb</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">batch_size</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_per_label</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inplace</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">affperterb_ranges</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">zoom_range</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">max_tx</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">max_ty</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">max_shear</span><span class="o">=</span><span class="n">TAU</span> <span class="o">/</span> <span class="mi">32</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">max_theta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">enable_stretch</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">enable_flip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb_</span><span class="p">,</span> <span class="n">yb_</span> <span class="o">=</span> <span class="n">augment_affine</span><span class="p">(</span><span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">data_per_label</span><span class="o">=</span><span class="n">data_per_label</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">,</span> <span class="n">affperterb_ranges</span><span class="o">=</span><span class="n">affperterb_ranges</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Xb_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">Xb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia</span> <span class="kn">import</span> <span class="n">plottool</span> <span class="k">as</span> <span class="n">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">qt4ensure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_augmented_patches</span><span class="p">(</span><span class="n">Xb</span><span class="p">,</span> <span class="n">Xb_</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">yb_</span><span class="p">,</span> <span class="n">data_per_label</span><span class="o">=</span><span class="n">data_per_label</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.augment.augment_affine_siam">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.augment.</span></span><span class="sig-name descname"><span class="pre">augment_affine_siam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng=&lt;module</span> <span class="pre">'numpy.random'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/numpy/random/__init__.py'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/augment.html#augment_affine_siam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.augment.augment_affine_siam" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.augment –test-augment_affine –show –db PZ_MTEST</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.augment</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="n">mnist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">testdata_mnist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span> <span class="o">/</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yb</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb_</span><span class="p">,</span> <span class="n">yb_</span> <span class="o">=</span> <span class="n">augment_affine</span><span class="p">(</span><span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia</span> <span class="kn">import</span> <span class="n">plottool</span> <span class="k">as</span> <span class="n">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">qt4ensure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_augmented_patches</span><span class="p">(</span><span class="n">Xb</span><span class="p">,</span> <span class="n">Xb_</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">yb_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.augment</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">ingest_data</span><span class="p">,</span> <span class="n">utils</span><span class="p">,</span> <span class="n">draw_results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb_orig</span><span class="p">,</span> <span class="n">yb_orig</span><span class="p">,</span> <span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">testdata_augment</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">augment_affine</span><span class="p">(</span><span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_augmented_patches</span><span class="p">(</span><span class="n">Xb_orig</span><span class="p">,</span> <span class="n">Xb</span><span class="p">,</span> <span class="n">yb_orig</span><span class="p">,</span> <span class="n">yb</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.augment.augment_gamma">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.augment.</span></span><span class="sig-name descname"><span class="pre">augment_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng=&lt;module</span> <span class="pre">'numpy.random'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/numpy/random/__init__.py'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/augment.html#augment_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.augment.augment_gamma" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.augment –test-augment_gamma –show –db PZ_MTEST</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.augment</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">ingest_data</span><span class="p">,</span> <span class="n">utils</span><span class="p">,</span> <span class="n">draw_results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb_orig</span><span class="p">,</span> <span class="n">yb_orig</span><span class="p">,</span> <span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">testdata_augment</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">augment_gamma</span><span class="p">(</span><span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_augmented_patches</span><span class="p">(</span><span class="n">Xb_orig</span><span class="p">,</span> <span class="n">Xb</span><span class="p">,</span> <span class="n">yb_orig</span><span class="p">,</span> <span class="n">yb</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.augment.augment_shadow">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.augment.</span></span><span class="sig-name descname"><span class="pre">augment_shadow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng=&lt;module</span> <span class="pre">'numpy.random'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/numpy/random/__init__.py'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_shadowmaps=False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/augment.html#augment_shadow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.augment.augment_shadow" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.augment –test-augment_shadow –show –db PZ_MTEST</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.augment</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">ingest_data</span><span class="p">,</span> <span class="n">utils</span><span class="p">,</span> <span class="n">draw_results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb_orig</span><span class="p">,</span> <span class="n">yb_orig</span><span class="p">,</span> <span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">testdata_augment</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">shadows</span> <span class="o">=</span> <span class="n">augment_shadow</span><span class="p">(</span><span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">,</span> <span class="n">return_shadowmaps</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_augmented_patches</span><span class="p">(</span><span class="n">Xb_orig</span><span class="p">,</span> <span class="n">Xb</span><span class="p">,</span> <span class="n">yb_orig</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">shadows</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.augment.augment_siamese_patches">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.augment.</span></span><span class="sig-name descname"><span class="pre">augment_siamese_patches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng=&lt;module</span> <span class="pre">'numpy.random'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/numpy/random/__init__.py'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/augment.html#augment_siamese_patches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.augment.augment_siamese_patches" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.augment –test-augment_siamese_patches –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.augment</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">ingest_data</span><span class="p">,</span> <span class="n">utils</span><span class="p">,</span> <span class="n">draw_results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ingest_data</span><span class="o">.</span><span class="n">testdata_patchmatch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cv2_data</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">convert_theano_images_to_cv2_images</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">cv2_data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">batch_size</span><span class="p">],</span> <span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">batch_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb1</span><span class="p">,</span> <span class="n">yb1</span> <span class="o">=</span> <span class="n">augment_siamese_patches</span><span class="p">(</span><span class="n">Xb</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">yb</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modified_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">Xb1</span> <span class="o">!=</span> <span class="n">Xb</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia</span> <span class="kn">import</span> <span class="n">plottool</span> <span class="k">as</span> <span class="n">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#z = draw_results.get_sample_pairimg_from_X(Xb, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Xb</span><span class="p">[</span><span class="n">modified_indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;before&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Xb1</span><span class="p">[</span><span class="n">modified_indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;after&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Xb</span><span class="p">[</span><span class="n">modified_indexes</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Xb1</span><span class="p">[</span><span class="n">modified_indexes</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.augment.augment_siamese_patches2">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.augment.</span></span><span class="sig-name descname"><span class="pre">augment_siamese_patches2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng=&lt;module</span> <span class="pre">'numpy.random'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/numpy/random/__init__.py'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/augment.html#augment_siamese_patches2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.augment.augment_siamese_patches2" title="Permalink to this definition"></a></dt>
<dd><dl>
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.augment –test-augment_siamese_patches2 –show –db=PZ_MTEST
python -m wbia_cnn.augment –test-augment_siamese_patches2 –show –colorspace=’bgr’</p>
<p># Shows what augumentation looks like durring trainging
python -m wbia_cnn.train –test-pz_patchmatch –ds pzmtest –weights=new –arch=siaml2 –train –monitor –DEBUG_AUGMENTATION</p>
</dd>
</dl>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>zoom in only if a true positive
slightly different transforms for each image in the pair</p>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.augment</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">ingest_data</span><span class="p">,</span> <span class="n">utils</span><span class="p">,</span> <span class="n">draw_results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb_orig</span><span class="p">,</span> <span class="n">yb_orig</span><span class="p">,</span> <span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">testdata_augment</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">augment_siamese_patches2</span><span class="p">(</span><span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_augmented_patches</span><span class="p">(</span><span class="n">Xb_orig</span><span class="p">,</span> <span class="n">Xb</span><span class="p">,</span> <span class="n">yb_orig</span><span class="p">,</span> <span class="n">yb</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.augment.random_affine_args">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.augment.</span></span><span class="sig-name descname"><span class="pre">random_affine_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zoom_range=(0.9090909090909091</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_tx=1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_ty=1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_shear=0.39269908169872414</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_theta=0.19634954084936207</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_flip=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_stretch=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng=&lt;module</span> <span class="pre">'numpy.random'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/numpy/random/__init__.py'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/augment.html#random_affine_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.augment.random_affine_args" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.augment –test-random_affine_args</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.augment</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zoom_range</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.9090909090909091</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_tx</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_ty</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_shear</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enable_rotate</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enable_flip</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enable_stretch</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">affine_args</span> <span class="o">=</span> <span class="n">random_affine_args</span><span class="p">(</span><span class="n">zoom_range</span><span class="p">,</span> <span class="n">max_tx</span><span class="p">,</span> <span class="n">max_ty</span><span class="p">,</span> <span class="n">max_shear</span><span class="p">,</span> <span class="n">enable_rotate</span><span class="p">,</span> <span class="n">enable_flip</span><span class="p">,</span> <span class="n">enable_stretch</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span> <span class="o">=</span> <span class="n">affine_args</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Aff</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">affine_mat3x3</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">shear</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">repr2</span><span class="p">(</span><span class="n">Aff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">np.array([[-0.91730358, -0.88832132,  0.35906546],</span>
<span class="go">          [-0.42111527,  0.47923811, -0.61076161],</span>
<span class="go">          [ 0.        ,  0.        ,  1.        ]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.augment.random_affine_kwargs">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.augment.</span></span><span class="sig-name descname"><span class="pre">random_affine_kwargs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/augment.html#random_affine_kwargs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.augment.random_affine_kwargs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.augment.show_augmented_patches">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.augment.</span></span><span class="sig-name descname"><span class="pre">show_augmented_patches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xb_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_per_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shadows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/augment.html#show_augmented_patches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.augment.show_augmented_patches" title="Permalink to this definition"></a></dt>
<dd><p>from wbia_cnn.augment import *  # NOQA
std_ = center_std
mean_ = center_mean</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.augment.stacked_img_pairs">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.augment.</span></span><span class="sig-name descname"><span class="pre">stacked_img_pairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modified_indexes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/augment.html#stacked_img_pairs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.augment.stacked_img_pairs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.augment.test_transforms">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.augment.</span></span><span class="sig-name descname"><span class="pre">test_transforms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/augment.html#test_transforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.augment.test_transforms" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.augment –test-test_transforms –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.augment</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_transforms</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.augment.testdata_augment">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.augment.</span></span><span class="sig-name descname"><span class="pre">testdata_augment</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/augment.html#testdata_augment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.augment.testdata_augment" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-wbia_cnn.batch_processing">
<span id="wbia-cnn-batch-processing-module"></span><h2>wbia_cnn.batch_processing module<a class="headerlink" href="#module-wbia_cnn.batch_processing" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.batch_processing.augment_batch">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.batch_processing.</span></span><span class="sig-name descname"><span class="pre">augment_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_batches</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/batch_processing.html#augment_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.batch_processing.augment_batch" title="Permalink to this definition"></a></dt>
<dd><p>Make sure to augment data in 0-1 space.
This means use a mean fill values not 0.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">augment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia</span> <span class="kn">import</span> <span class="n">plottool</span> <span class="k">as</span> <span class="n">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">qt4ensure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">augment</span><span class="o">.</span><span class="n">show_augmented_patches</span><span class="p">(</span><span class="n">Xb_orig</span><span class="p">,</span> <span class="n">Xb</span><span class="p">,</span> <span class="n">yb_orig</span><span class="p">,</span> <span class="n">yb</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.batch_processing.batch_iterator">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.batch_processing.</span></span><span class="sig-name descname"><span class="pre">batch_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomize_batch_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augment_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showprog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_is_cv2_native</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'verbose</span> <span class="pre">batch</span> <span class="pre">iteration'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/batch_processing.html#batch_iterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.batch_processing.batch_iterator" title="Permalink to this definition"></a></dt>
<dd><p>Breaks up data into to batches defined by model batch size</p>
<dl>
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn –tf batch_iterator:0
python -m wbia_cnn –tf batch_iterator:1
python -m wbia_cnn –tf batch_iterator:2
python -m wbia_cnn –tf batch_iterator:1 –DEBUG_AUGMENTATION</p>
<p>python -m wbia_cnn –tf batch_iterator:1 –noaugment
# Threaded buffering seems to help a lot
python -m wbia_cnn –tf batch_iterator:1 –augment</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.batch_processing</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">models</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DummyModel</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">make_random_testdata</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">99</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cv2_format</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">ensure_data_params</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">randomize_batch_order</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result_list</span> <span class="o">=</span> <span class="p">[(</span><span class="n">Xb</span><span class="p">,</span> <span class="n">Yb</span><span class="p">)</span> <span class="k">for</span> <span class="n">Xb</span><span class="p">,</span> <span class="n">Yb</span> <span class="ow">in</span> <span class="n">batch_iterator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
<span class="gp">... </span>               <span class="n">randomize_batch_order</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">depth_profile</span><span class="p">(</span><span class="n">result_list</span><span class="p">,</span> <span class="n">compress_consecutive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[(16, 1, 4, 4), 16]] * 6 + [[(3, 1, 4, 4), 3]]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.batch_processing</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">models</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SiameseL2</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">data_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">make_random_testdata</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cv2_format</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">ensure_data_params</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result_list1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result_list2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">augment_on</span><span class="o">=</span><span class="ow">not</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s1">&#39;--noaugment&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iterkw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">randomize_batch_order</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>             <span class="n">augment_on</span><span class="o">=</span><span class="n">augment_on</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>             <span class="n">showprog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">ut</span><span class="o">.</span><span class="n">VERBOSE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sleep_time</span> <span class="o">=</span> <span class="mf">.05</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inside_time1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inside_time2</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">ut</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="s1">&#39;buffered&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">t2</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">generator</span> <span class="o">=</span>  <span class="n">batch_iterator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">iterkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">Xb</span><span class="p">,</span> <span class="n">Yb</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">buffered_generator</span><span class="p">(</span><span class="n">generator</span><span class="p">,</span> <span class="n">buffer_size</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">with</span> <span class="n">ut</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="s1">&#39;Inside&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">as</span> <span class="n">t</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">sleep_time</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="n">result_list2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Xb</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">inside_time2</span> <span class="o">+=</span> <span class="n">t</span><span class="o">.</span><span class="n">ellapsed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">ut</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="s1">&#39;unbuffered&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">t1</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">generator</span> <span class="o">=</span>  <span class="n">batch_iterator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">iterkw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">Xb</span><span class="p">,</span> <span class="n">Yb</span> <span class="ow">in</span> <span class="n">generator</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">with</span> <span class="n">ut</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="s1">&#39;Inside&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">as</span> <span class="n">t</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">sleep_time</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="n">result_list1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Xb</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">inside_time1</span> <span class="o">+=</span> <span class="n">t</span><span class="o">.</span><span class="n">ellapsed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Inside times should be the same&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;inside_time1 = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">inside_time1</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;inside_time2 = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">inside_time2</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Outside times show the overhead of data augmentation&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Overhead Unbuffered = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">ellapsed</span> <span class="o">-</span> <span class="n">inside_time1</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Overhead Buffered   = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t2</span><span class="o">.</span><span class="n">ellapsed</span> <span class="o">-</span> <span class="n">inside_time2</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Efficiency Unbuffered  = </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">inside_time1</span> <span class="o">/</span> <span class="n">t1</span><span class="o">.</span><span class="n">ellapsed</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Efficiency Buffered    = </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">inside_time2</span> <span class="o">/</span> <span class="n">t2</span><span class="o">.</span><span class="n">ellapsed</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">result_list1</span> <span class="o">==</span> <span class="n">result_list2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result_list2</span><span class="p">))</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.batch_processing</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.mnist</span> <span class="kn">import</span> <span class="n">MNISTModel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">ingest_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># should yield float32 regardlesss of original format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">exec_funckw</span><span class="p">(</span><span class="n">batch_iterator</span><span class="p">,</span> <span class="nb">globals</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">randomize_batch_order</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ---</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset1</span> <span class="o">=</span> <span class="n">ingest_data</span><span class="o">.</span><span class="n">grab_mnist_category_dataset_float</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model1</span> <span class="o">=</span> <span class="n">MNISTModel</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">data_shape</span><span class="o">=</span><span class="n">dataset1</span><span class="o">.</span><span class="n">data_shape</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">output_dims</span><span class="o">=</span><span class="n">dataset1</span><span class="o">.</span><span class="n">output_dims</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">arch_tag</span><span class="o">=</span><span class="n">dataset1</span><span class="o">.</span><span class="n">alias_key</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">training_dpath</span><span class="o">=</span><span class="n">dataset1</span><span class="o">.</span><span class="n">training_dpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">dataset1</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model1</span><span class="o">.</span><span class="n">ensure_data_params</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_iter1</span> <span class="o">=</span> <span class="n">batch_iterator</span><span class="p">(</span><span class="n">model1</span><span class="p">,</span> <span class="n">X1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">randomize_batch_order</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb1</span><span class="p">,</span> <span class="n">yb1</span> <span class="o">=</span> <span class="n">six</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="n">_iter1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ---</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset2</span> <span class="o">=</span> <span class="n">ingest_data</span><span class="o">.</span><span class="n">grab_mnist_category_dataset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model2</span> <span class="o">=</span> <span class="n">MNISTModel</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">data_shape</span><span class="o">=</span><span class="n">dataset2</span><span class="o">.</span><span class="n">data_shape</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">output_dims</span><span class="o">=</span><span class="n">dataset2</span><span class="o">.</span><span class="n">output_dims</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">arch_tag</span><span class="o">=</span><span class="n">dataset2</span><span class="o">.</span><span class="n">alias_key</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">training_dpath</span><span class="o">=</span><span class="n">dataset2</span><span class="o">.</span><span class="n">training_dpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">dataset2</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model2</span><span class="o">.</span><span class="n">ensure_data_params</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_iter2</span> <span class="o">=</span> <span class="n">batch_iterator</span><span class="p">(</span><span class="n">model2</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">randomize_batch_order</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb2</span><span class="p">,</span> <span class="n">yb2</span> <span class="o">=</span> <span class="n">six</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="n">_iter2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ---</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">model</span> <span class="o">=</span> <span class="n">X1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">model1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">yb2</span> <span class="o">==</span> <span class="n">yb2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The uint8 and float32 data should produce similar values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># For this mnist set it will be a bit more off because the</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># original uint8 scaling value was 256 not 255.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">Xb1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">Xb2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">Xb1</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">.01</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">Xb2</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">.01</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Xb1</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;</span>  <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">Xb2</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;</span>  <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;out of (-1, 1)&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Xb1</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mf">1.0</span> <span class="ow">and</span> <span class="n">Xb1</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;out of (-1, 1)&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Xb1</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;should have some negative values&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Xb2</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;should have some negative values&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Xb1</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;should have some positive values&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Xb2</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;should have some positive values&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.batch_processing.concatenate_hack">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.batch_processing.</span></span><span class="sig-name descname"><span class="pre">concatenate_hack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/batch_processing.html#concatenate_hack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.batch_processing.concatenate_hack" title="Permalink to this definition"></a></dt>
<dd><p>Hack to fix numpy bug.
concatenate fails when one item in sequence is empty</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sequence</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sequence</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[]]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.batch_processing.pad_labels">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.batch_processing.</span></span><span class="sig-name descname"><span class="pre">pad_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/batch_processing.html#pad_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.batch_processing.pad_labels" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.batch_processing.print_batch_info">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.batch_processing.</span></span><span class="sig-name descname"><span class="pre">print_batch_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_batches</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/batch_processing.html#print_batch_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.batch_processing.print_batch_info" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.batch_processing.process_batch">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.batch_processing.</span></span><span class="sig-name descname"><span class="pre">process_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theano_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showprog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/batch_processing.html#process_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.batch_processing.process_batch" title="Permalink to this definition"></a></dt>
<dd><p>Compute the loss over all training batches.
Passes data to function that splits it into batches and appropriately
preproecsses the data. Then this function sends that data to theano. Then
the results are packaged up nicely before returning.</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn –tf process_batch –verbose
python -m wbia_cnn –tf process_batch:0 –verbose
python -m wbia_cnn –tf process_batch:1 –verbose</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.batch_processing</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">models</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DummyModel</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">make_random_testdata</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theano_fn</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">build_predict_func</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;X_is_cv2_native&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;showprog&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>           <span class="s1">&#39;randomize_batch_order&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outputs_</span> <span class="o">=</span> <span class="n">process_batch</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">theano_fn</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="n">outputs_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.batch_processing</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">models</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SiameseL2</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">data_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">make_random_testdata</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theano_fn</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">build_predict_func</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;X_is_cv2_native&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;showprog&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>          <span class="s1">&#39;randomize_batch_order&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outputs_</span> <span class="o">=</span> <span class="n">process_batch</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">theano_fn</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="n">outputs_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">batch_iter</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">Xb</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yb</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">8</span><span class="p">,)</span>
</pre></div>
</div>
</dd>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">make_random_testdata</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;X_is_cv2_native&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;showprog&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>          <span class="s1">&#39;randomize_batch_order&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;time_thresh&#39;</span><span class="p">:</span> <span class="mf">.5</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>          <span class="p">}</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Testing Unbuffered&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_iter</span> <span class="o">=</span> <span class="n">batch_iterator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">lbl</span><span class="o">=</span><span class="n">theano_fn</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">ProgressIter</span><span class="p">(</span><span class="n">batch_iter</span><span class="p">,</span> <span class="n">lbl</span><span class="o">=</span><span class="s1">&#39;:EXEC FG&#39;</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="n">ut</span><span class="o">.</span><span class="n">is_prime</span><span class="p">(</span><span class="mi">346373</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Notice how the progress iters are not interlaced like</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># they are in the unbuffered version</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Testing Buffered&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_iter2</span> <span class="o">=</span> <span class="n">batch_iterator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">lbl</span><span class="o">=</span><span class="n">theano_fn</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_iter2</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">buffered_generator</span><span class="p">(</span><span class="n">batch_iter2</span><span class="p">,</span> <span class="n">buffer_size</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Iterating&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">ProgressIter</span><span class="p">(</span><span class="n">batch_iter2</span><span class="p">,</span> <span class="n">lbl</span><span class="o">=</span><span class="s1">&#39;:EXEC FG&#39;</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span><span class="n">ut</span><span class="o">.</span><span class="n">is_prime</span><span class="p">(</span><span class="mi">346373</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-wbia_cnn.custom_layers">
<span id="wbia-cnn-custom-layers-module"></span><h2>wbia_cnn.custom_layers module<a class="headerlink" href="#module-wbia_cnn.custom_layers" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.BatchNormLayer2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.custom_layers.</span></span><span class="sig-name descname"><span class="pre">BatchNormLayer2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">incoming</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#BatchNormLayer2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.BatchNormLayer2" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">lasagne.layers.normalization.BatchNormLayer</span></code></p>
<p>Adds a nonlinearity to batch norm layer to reduce number of layers</p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.BatchNormLayer2.get_output_for">
<span class="sig-name descname"><span class="pre">get_output_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#BatchNormLayer2.get_output_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.BatchNormLayer2.get_output_for" title="Permalink to this definition"></a></dt>
<dd><p>Propagates the given input through this layer (and only this layer).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<em>Theano expression</em>) – The expression to propagate through this layer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output</strong> – The output of this layer given the input to this layer.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Theano expression</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is called by the base <code class="xref py py-meth docutils literal notranslate"><span class="pre">lasagne.layers.get_output()</span></code>
to propagate data through a network.</p>
<p>This method should be overridden when implementing a new
<code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code> class. By default it raises <cite>NotImplementedError</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.CenterSurroundLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.custom_layers.</span></span><span class="sig-name descname"><span class="pre">CenterSurroundLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_layer</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#CenterSurroundLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.CenterSurroundLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">lasagne.layers.base.Layer</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.CenterSurroundLayer.get_output_for">
<span class="sig-name descname"><span class="pre">get_output_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T=&lt;module</span> <span class="pre">'theano.tensor'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/theano/tensor/__init__.py'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#CenterSurroundLayer.get_output_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.CenterSurroundLayer.get_output_for" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.custom_layers –test-CenterSurroundLayer.get_output_for:0 –show
python -m wbia_cnn.custom_layers –test-CenterSurroundLayer.get_output_for:1 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.custom_layers</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">theano</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#item_shape = (32, 32, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">item_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">41</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="p">,</span> <span class="n">inputdata_</span> <span class="o">=</span> <span class="n">testdata_centersurround</span><span class="p">(</span><span class="n">item_shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Test the actual symbolic expression</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_T</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">evaluate_symbolic_layer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_output_for</span><span class="p">,</span> <span class="n">inputdata_</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">tensor4</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">theano</span><span class="o">.</span><span class="n">tensor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_T</span> <span class="o">=</span> <span class="n">output_T</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">convert_theano_images_to_cv2_images</span><span class="p">(</span><span class="n">output_T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interact_image_list</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">num_per_page</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.custom_layers</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#item_shape = (32, 32, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">item_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">41</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="p">,</span> <span class="n">input_expr</span> <span class="o">=</span> <span class="n">testdata_centersurround</span><span class="p">(</span><span class="n">item_shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Test using just numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_np</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_output_for</span><span class="p">(</span><span class="n">input_expr</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">np</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;results agree&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">convert_theano_images_to_cv2_images</span><span class="p">(</span><span class="n">output_np</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interact_image_list</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">num_per_page</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Ignore:</dt><dd><p>from wbia_cnn import draw_net
#draw_net.draw_theano_symbolic_expression(result)
assert np.all(output_np == output_T)
np.stack = np.vstack
T = np</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.CenterSurroundLayer.get_output_shape_for">
<span class="sig-name descname"><span class="pre">get_output_shape_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#CenterSurroundLayer.get_output_shape_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.CenterSurroundLayer.get_output_shape_for" title="Permalink to this definition"></a></dt>
<dd><p>Computes the output shape of this layer, given an input shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – A tuple representing the shape of the input. The tuple should have
as many elements as there are input dimensions, and the elements
should be integers or <cite>None</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple representing the shape of the output of this layer. The
tuple has as many elements as there are output dimensions, and the
elements are all either integers or <cite>None</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method will typically be overridden when implementing a new
<code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code> class. By default it simply returns the input
shape. This means that a layer that does not modify the shape
(e.g. because it applies an elementwise operation) does not need
to override this method.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.CyclicPoolLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.custom_layers.</span></span><span class="sig-name descname"><span class="pre">CyclicPoolLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_function=&lt;function</span> <span class="pre">mean&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#CyclicPoolLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.CyclicPoolLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">lasagne.layers.base.Layer</span></code></p>
<p>Utility layer that unfolds the viewpoints dimension and pools over it.
Note that this only makes sense for dense representations, not for
feature maps (because no inverse transforms are applied to align them).</p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.CyclicPoolLayer.get_output_for">
<span class="sig-name descname"><span class="pre">get_output_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#CyclicPoolLayer.get_output_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.CyclicPoolLayer.get_output_for" title="Permalink to this definition"></a></dt>
<dd><p>Propagates the given input through this layer (and only this layer).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<em>Theano expression</em>) – The expression to propagate through this layer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output</strong> – The output of this layer given the input to this layer.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Theano expression</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is called by the base <code class="xref py py-meth docutils literal notranslate"><span class="pre">lasagne.layers.get_output()</span></code>
to propagate data through a network.</p>
<p>This method should be overridden when implementing a new
<code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code> class. By default it raises <cite>NotImplementedError</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.CyclicPoolLayer.get_output_shape_for">
<span class="sig-name descname"><span class="pre">get_output_shape_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#CyclicPoolLayer.get_output_shape_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.CyclicPoolLayer.get_output_shape_for" title="Permalink to this definition"></a></dt>
<dd><p>Computes the output shape of this layer, given an input shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – A tuple representing the shape of the input. The tuple should have
as many elements as there are input dimensions, and the elements
should be integers or <cite>None</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple representing the shape of the output of this layer. The
tuple has as many elements as there are output dimensions, and the
elements are all either integers or <cite>None</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method will typically be overridden when implementing a new
<code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code> class. By default it simply returns the input
shape. This means that a layer that does not modify the shape
(e.g. because it applies an elementwise operation) does not need
to override this method.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.FlipLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.custom_layers.</span></span><span class="sig-name descname"><span class="pre">FlipLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">incoming</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#FlipLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.FlipLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">lasagne.layers.base.Layer</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.FlipLayer.get_output_for">
<span class="sig-name descname"><span class="pre">get_output_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#FlipLayer.get_output_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.FlipLayer.get_output_for" title="Permalink to this definition"></a></dt>
<dd><p>Propagates the given input through this layer (and only this layer).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<em>Theano expression</em>) – The expression to propagate through this layer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output</strong> – The output of this layer given the input to this layer.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Theano expression</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is called by the base <code class="xref py py-meth docutils literal notranslate"><span class="pre">lasagne.layers.get_output()</span></code>
to propagate data through a network.</p>
<p>This method should be overridden when implementing a new
<code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code> class. By default it raises <cite>NotImplementedError</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.FlipLayer.get_output_shape_for">
<span class="sig-name descname"><span class="pre">get_output_shape_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#FlipLayer.get_output_shape_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.FlipLayer.get_output_shape_for" title="Permalink to this definition"></a></dt>
<dd><p>Computes the output shape of this layer, given an input shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – A tuple representing the shape of the input. The tuple should have
as many elements as there are input dimensions, and the elements
should be integers or <cite>None</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple representing the shape of the output of this layer. The
tuple has as many elements as there are output dimensions, and the
elements are all either integers or <cite>None</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method will typically be overridden when implementing a new
<code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code> class. By default it simply returns the input
shape. This means that a layer that does not modify the shape
(e.g. because it applies an elementwise operation) does not need
to override this method.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.L1DistanceLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.custom_layers.</span></span><span class="sig-name descname"><span class="pre">L1DistanceLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_layer</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#L1DistanceLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.L1DistanceLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">lasagne.layers.base.Layer</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.L1DistanceLayer.get_output_for">
<span class="sig-name descname"><span class="pre">get_output_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#L1DistanceLayer.get_output_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.L1DistanceLayer.get_output_for" title="Permalink to this definition"></a></dt>
<dd><p>Propagates the given input through this layer (and only this layer).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<em>Theano expression</em>) – The expression to propagate through this layer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output</strong> – The output of this layer given the input to this layer.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Theano expression</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is called by the base <code class="xref py py-meth docutils literal notranslate"><span class="pre">lasagne.layers.get_output()</span></code>
to propagate data through a network.</p>
<p>This method should be overridden when implementing a new
<code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code> class. By default it raises <cite>NotImplementedError</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.L1DistanceLayer.get_output_shape_for">
<span class="sig-name descname"><span class="pre">get_output_shape_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#L1DistanceLayer.get_output_shape_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.L1DistanceLayer.get_output_shape_for" title="Permalink to this definition"></a></dt>
<dd><p>Computes the output shape of this layer, given an input shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – A tuple representing the shape of the input. The tuple should have
as many elements as there are input dimensions, and the elements
should be integers or <cite>None</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple representing the shape of the output of this layer. The
tuple has as many elements as there are output dimensions, and the
elements are all either integers or <cite>None</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method will typically be overridden when implementing a new
<code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code> class. By default it simply returns the input
shape. This means that a layer that does not modify the shape
(e.g. because it applies an elementwise operation) does not need
to override this method.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.L1NormalizeLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.custom_layers.</span></span><span class="sig-name descname"><span class="pre">L1NormalizeLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_layer</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#L1NormalizeLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.L1NormalizeLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">lasagne.layers.base.Layer</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.L1NormalizeLayer.get_output_for">
<span class="sig-name descname"><span class="pre">get_output_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#L1NormalizeLayer.get_output_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.L1NormalizeLayer.get_output_for" title="Permalink to this definition"></a></dt>
<dd><p>Propagates the given input through this layer (and only this layer).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<em>Theano expression</em>) – The expression to propagate through this layer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output</strong> – The output of this layer given the input to this layer.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Theano expression</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is called by the base <code class="xref py py-meth docutils literal notranslate"><span class="pre">lasagne.layers.get_output()</span></code>
to propagate data through a network.</p>
<p>This method should be overridden when implementing a new
<code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code> class. By default it raises <cite>NotImplementedError</cite>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.L2NormalizeLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.custom_layers.</span></span><span class="sig-name descname"><span class="pre">L2NormalizeLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#L2NormalizeLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.L2NormalizeLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">lasagne.layers.base.Layer</span></code></p>
<p>Normalizes the outputs of a layer to have an L2 norm of 1.
This is useful for siamese networks who’s outputs will be comparsed using
the L2 distance.</p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.L2NormalizeLayer.get_output_for">
<span class="sig-name descname"><span class="pre">get_output_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T=&lt;module</span> <span class="pre">'theano.tensor'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/theano/tensor/__init__.py'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#L2NormalizeLayer.get_output_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.L2NormalizeLayer.get_output_for" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.custom_layers –test-L2NormalizeLayer.get_output_for</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.custom_layers</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># l2 normalization on batches of vector encodings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">testdata_input_layer</span><span class="p">(</span><span class="n">item_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,),</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inputdata_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="o">*</span><span class="n">input_layer</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">L2NormalizeLayer</span><span class="p">(</span><span class="n">input_layer</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Test numpy version</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_</span> <span class="o">=</span> <span class="n">inputdata_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_np</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_output_for</span><span class="p">(</span><span class="n">inputdata_</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">np</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">output_np</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Test theano version</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">theano</span><span class="o">.</span><span class="n">tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_expr</span> <span class="o">=</span> <span class="n">input_</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;vector_input&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_expr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_output_for</span><span class="p">(</span><span class="n">input_expr</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_T</span> <span class="o">=</span> <span class="n">output_expr</span><span class="o">.</span><span class="n">eval</span><span class="p">({</span><span class="n">input_expr</span><span class="p">:</span> <span class="n">inputdata_</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output_T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">output_T</span><span class="p">,</span> <span class="n">output_np</span><span class="p">)),</span> <span class="s1">&#39;theano and numpy diagree&#39;</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.custom_layers</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># l2 normalization on batches of image filters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">testdata_input_layer</span><span class="p">(</span><span class="n">item_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inputdata_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="o">*</span><span class="n">input_layer</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axis</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">L2NormalizeLayer</span><span class="p">(</span><span class="n">input_layer</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Test numpy version</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_</span> <span class="o">=</span> <span class="n">inputdata_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_np</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_output_for</span><span class="p">(</span><span class="n">inputdata_</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">np</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_flat_np</span> <span class="o">=</span> <span class="n">output_np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">input_layer</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">input_layer</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">output_flat_np</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Test theano version</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">theano</span><span class="o">.</span><span class="n">tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_expr</span> <span class="o">=</span> <span class="n">input_</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">tensor4</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;image_filter_input&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_expr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_output_for</span><span class="p">(</span><span class="n">input_expr</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_T</span> <span class="o">=</span> <span class="n">output_expr</span><span class="o">.</span><span class="n">eval</span><span class="p">({</span><span class="n">input_expr</span><span class="p">:</span> <span class="n">inputdata_</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output_T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">output_T</span><span class="p">,</span> <span class="n">output_np</span><span class="p">)),</span> <span class="s1">&#39;theano and numpy diagree&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#output_T = utils.evaluate_symbolic_layer(self.get_output_for, inputdata_, T.tensor4, T=theano.tensor)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.L2SquaredDistanceLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.custom_layers.</span></span><span class="sig-name descname"><span class="pre">L2SquaredDistanceLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_layer</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#L2SquaredDistanceLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.L2SquaredDistanceLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">lasagne.layers.base.Layer</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.L2SquaredDistanceLayer.get_output_for">
<span class="sig-name descname"><span class="pre">get_output_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#L2SquaredDistanceLayer.get_output_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.L2SquaredDistanceLayer.get_output_for" title="Permalink to this definition"></a></dt>
<dd><p>Propagates the given input through this layer (and only this layer).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<em>Theano expression</em>) – The expression to propagate through this layer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output</strong> – The output of this layer given the input to this layer.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Theano expression</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is called by the base <code class="xref py py-meth docutils literal notranslate"><span class="pre">lasagne.layers.get_output()</span></code>
to propagate data through a network.</p>
<p>This method should be overridden when implementing a new
<code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code> class. By default it raises <cite>NotImplementedError</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.L2SquaredDistanceLayer.get_output_shape_for">
<span class="sig-name descname"><span class="pre">get_output_shape_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#L2SquaredDistanceLayer.get_output_shape_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.L2SquaredDistanceLayer.get_output_shape_for" title="Permalink to this definition"></a></dt>
<dd><p>Computes the output shape of this layer, given an input shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – A tuple representing the shape of the input. The tuple should have
as many elements as there are input dimensions, and the elements
should be integers or <cite>None</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple representing the shape of the output of this layer. The
tuple has as many elements as there are output dimensions, and the
elements are all either integers or <cite>None</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method will typically be overridden when implementing a new
<code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code> class. By default it simply returns the input
shape. This means that a layer that does not modify the shape
(e.g. because it applies an elementwise operation) does not need
to override this method.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.LocallyConnected2DLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.custom_layers.</span></span><span class="sig-name descname"><span class="pre">LocallyConnected2DLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">incoming</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_filters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride=(1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">untie_biases=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W=&lt;lasagne.init.GlorotUniform</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b=&lt;lasagne.init.Constant</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity=&lt;function</span> <span class="pre">rectify&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convolution=&lt;function</span> <span class="pre">conv2d&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#LocallyConnected2DLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.LocallyConnected2DLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">lasagne.layers.base.Layer</span></code></p>
<p>Copy of the Conv2D layer that needs to be adapted into a locally connected layer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>incoming</strong> (<em>layers.Layer</em>) – </p></li>
<li><p><strong>num_filters</strong> – </p></li>
<li><p><strong>filter_size</strong> – </p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – (default = (1, 1))</p></li>
<li><p><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – (default = 0)</p></li>
<li><p><strong>untie_biases</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = False)</p></li>
<li><p><strong>W</strong> (<em>GlorotUniform</em>) – (default = &lt;init.GlorotUniform object at 0x7f551a3537d0&gt;)</p></li>
<li><p><strong>b</strong> (<em>Constant</em>) – (default = &lt;init.Constant object at 0x7f551a33ecd0&gt;)</p></li>
<li><p><strong>nonlinearity</strong> (<em>function</em>) – (default = &lt;function rectify at 0x7f55307989b0&gt;)</p></li>
<li><p><strong>convolution</strong> (<em>function</em>) – (default = &lt;function conv2d at 0x7f55330148c0&gt;)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.custom_layers –exec-__init__</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.custom_layers</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">incoming</span> <span class="o">=</span> <span class="n">testdata_input_layer</span><span class="p">(</span><span class="n">item_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_filters</span> <span class="o">=</span> <span class="mi">64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filter_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stride</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pad</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">untie_biases</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">W</span> <span class="o">=</span> <span class="n">init</span><span class="o">.</span><span class="n">GlorotUniform</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">init</span><span class="o">.</span><span class="n">Constant</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nonlinearity</span> <span class="o">=</span> <span class="n">nonlinearities</span><span class="o">.</span><span class="n">rectify</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">convolution</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">nnet</span><span class="o">.</span><span class="n">conv2d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">LocallyConnected2DLayer</span><span class="p">(</span><span class="n">incoming</span><span class="p">,</span> <span class="n">num_filters</span><span class="p">,</span> <span class="n">filter_size</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                               <span class="n">stride</span><span class="p">,</span> <span class="n">pad</span><span class="p">,</span> <span class="n">untie_biases</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                               <span class="n">nonlinearity</span><span class="p">,</span> <span class="n">convolution</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Ignore:</dt><dd><p>self.get_output_rc(self.input_shape)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.LocallyConnected2DLayer.get_W_shape">
<span class="sig-name descname"><span class="pre">get_W_shape</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#LocallyConnected2DLayer.get_W_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.LocallyConnected2DLayer.get_W_shape" title="Permalink to this definition"></a></dt>
<dd><p>Get the shape of the weight matrix <cite>W</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>The shape of the weight matrix.</p>
<p>(should have a different conv matrix for each output node)
(ie NO WEIGHT SHARING)</p>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tuple of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.LocallyConnected2DLayer.get_output_for">
<span class="sig-name descname"><span class="pre">get_output_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#LocallyConnected2DLayer.get_output_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.LocallyConnected2DLayer.get_output_for" title="Permalink to this definition"></a></dt>
<dd><p>Propagates the given input through this layer (and only this layer).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<em>Theano expression</em>) – The expression to propagate through this layer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output</strong> – The output of this layer given the input to this layer.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Theano expression</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is called by the base <code class="xref py py-meth docutils literal notranslate"><span class="pre">lasagne.layers.get_output()</span></code>
to propagate data through a network.</p>
<p>This method should be overridden when implementing a new
<code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code> class. By default it raises <cite>NotImplementedError</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.LocallyConnected2DLayer.get_output_rc">
<span class="sig-name descname"><span class="pre">get_output_rc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#LocallyConnected2DLayer.get_output_rc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.LocallyConnected2DLayer.get_output_rc" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.LocallyConnected2DLayer.get_output_shape_for">
<span class="sig-name descname"><span class="pre">get_output_shape_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#LocallyConnected2DLayer.get_output_shape_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.LocallyConnected2DLayer.get_output_shape_for" title="Permalink to this definition"></a></dt>
<dd><p>Computes the output shape of this layer, given an input shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – A tuple representing the shape of the input. The tuple should have
as many elements as there are input dimensions, and the elements
should be integers or <cite>None</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple representing the shape of the output of this layer. The
tuple has as many elements as there are output dimensions, and the
elements are all either integers or <cite>None</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method will typically be overridden when implementing a new
<code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code> class. By default it simply returns the input
shape. This means that a layer that does not modify the shape
(e.g. because it applies an elementwise operation) does not need
to override this method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.LocallyConnected2DLayer.rrr">
<span class="sig-name descname"><span class="pre">rrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.custom_layers.LocallyConnected2DLayer.rrr" title="Permalink to this definition"></a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.MaxPool2DLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.custom_layers.</span></span><span class="sig-name descname"><span class="pre">MaxPool2DLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">incoming</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_border</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lasagne/layers/pool.html#MaxPool2DLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.MaxPool2DLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">lasagne.layers.pool.Pool2DLayer</span></code></p>
<p>2D max-pooling layer</p>
<p>Performs 2D max-pooling over the two trailing axes of a 4D input tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>incoming</strong> (a <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code> instance or tuple) – The layer feeding into this layer, or the expected input shape.</p></li>
<li><p><strong>pool_size</strong> (<em>integer</em><em> or </em><em>iterable</em>) – The length of the pooling region in each dimension.  If an integer, it
is promoted to a square pooling region. If an iterable, it should have
two elements.</p></li>
<li><p><strong>stride</strong> (integer, iterable or <code class="docutils literal notranslate"><span class="pre">None</span></code>) – The strides between sucessive pooling regions in each dimension.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> then <code class="docutils literal notranslate"><span class="pre">stride</span> <span class="pre">=</span> <span class="pre">pool_size</span></code>.</p></li>
<li><p><strong>pad</strong> (<em>integer</em><em> or </em><em>iterable</em>) – Number of elements to be added on each side of the input
in each dimension. Each value must be less than
the corresponding stride.</p></li>
<li><p><strong>ignore_border</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, partial pooling regions will be ignored.
Must be <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">pad</span> <span class="pre">!=</span> <span class="pre">(0,</span> <span class="pre">0)</span></code>.</p></li>
<li><p><strong>**kwargs</strong> – Any additional keyword arguments are passed to the <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code>
superclass.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The value used to pad the input is chosen to be less than
the minimum of the input, so that the output of each pooling region
always corresponds to some element in the unpadded input region.</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">ignore_border=False</span></code> prevents Theano from using cuDNN for the
operation, so it will fall back to a slower implementation.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.MultiImageRollLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.custom_layers.</span></span><span class="sig-name descname"><span class="pre">MultiImageRollLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_layer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#MultiImageRollLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.MultiImageRollLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">lasagne.layers.base.Layer</span></code></p>
<p>orig CyclicConvRollLayer</p>
<p>This layer turns (n_views * batch_size, num_channels, r, c) into
(n_views * batch_size, n_views * num_channels, r, c) by rolling
and concatenating feature maps.
It also applies the correct inverse transforms to the r and c
dimensions to align the feature maps.</p>
<p class="rubric">References</p>
<p><a class="reference external" href="https://github.com/benanne/kaggle-ndsb/blob/master/dihedral.py#L224">https://github.com/benanne/kaggle-ndsb/blob/master/dihedral.py#L224</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.MultiImageRollLayer.compute_permutation_matrix">
<span class="sig-name descname"><span class="pre">compute_permutation_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#MultiImageRollLayer.compute_permutation_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.MultiImageRollLayer.compute_permutation_matrix" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.MultiImageRollLayer.get_output_for">
<span class="sig-name descname"><span class="pre">get_output_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#MultiImageRollLayer.get_output_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.MultiImageRollLayer.get_output_for" title="Permalink to this definition"></a></dt>
<dd><p>Propagates the given input through this layer (and only this layer).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<em>Theano expression</em>) – The expression to propagate through this layer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output</strong> – The output of this layer given the input to this layer.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Theano expression</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is called by the base <code class="xref py py-meth docutils literal notranslate"><span class="pre">lasagne.layers.get_output()</span></code>
to propagate data through a network.</p>
<p>This method should be overridden when implementing a new
<code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code> class. By default it raises <cite>NotImplementedError</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.MultiImageRollLayer.get_output_shape_for">
<span class="sig-name descname"><span class="pre">get_output_shape_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#MultiImageRollLayer.get_output_shape_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.MultiImageRollLayer.get_output_shape_for" title="Permalink to this definition"></a></dt>
<dd><p>Computes the output shape of this layer, given an input shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – A tuple representing the shape of the input. The tuple should have
as many elements as there are input dimensions, and the elements
should be integers or <cite>None</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple representing the shape of the output of this layer. The
tuple has as many elements as there are output dimensions, and the
elements are all either integers or <cite>None</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method will typically be overridden when implementing a new
<code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code> class. By default it simply returns the input
shape. This means that a layer that does not modify the shape
(e.g. because it applies an elementwise operation) does not need
to override this method.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.MultiImageSliceLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.custom_layers.</span></span><span class="sig-name descname"><span class="pre">MultiImageSliceLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_layer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#MultiImageSliceLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.MultiImageSliceLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">lasagne.layers.base.Layer</span></code></p>
<p>orig CyclicSliceLayer
.. rubric:: References</p>
<p><a class="reference external" href="https://github.com/benanne/kaggle-ndsb/blob/master/dihedral.py#L89">https://github.com/benanne/kaggle-ndsb/blob/master/dihedral.py#L89</a></p>
<p>This layer stacks rotations of 0, 90, 180, and 270 degrees of the input
along the batch dimension.
If the input has shape (batch_size, num_channels, r, c),
then the output will have shape (4 * batch_size, num_channels, r, c).
Note that the stacking happens on axis 0, so a reshape to
(4, batch_size, num_channels, r, c) will separate the slice axis.</p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.MultiImageSliceLayer.get_output_for">
<span class="sig-name descname"><span class="pre">get_output_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#MultiImageSliceLayer.get_output_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.MultiImageSliceLayer.get_output_for" title="Permalink to this definition"></a></dt>
<dd><p>Propagates the given input through this layer (and only this layer).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<em>Theano expression</em>) – The expression to propagate through this layer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output</strong> – The output of this layer given the input to this layer.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Theano expression</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is called by the base <code class="xref py py-meth docutils literal notranslate"><span class="pre">lasagne.layers.get_output()</span></code>
to propagate data through a network.</p>
<p>This method should be overridden when implementing a new
<code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code> class. By default it raises <cite>NotImplementedError</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.MultiImageSliceLayer.get_output_shape_for">
<span class="sig-name descname"><span class="pre">get_output_shape_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#MultiImageSliceLayer.get_output_shape_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.MultiImageSliceLayer.get_output_shape_for" title="Permalink to this definition"></a></dt>
<dd><p>Computes the output shape of this layer, given an input shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – A tuple representing the shape of the input. The tuple should have
as many elements as there are input dimensions, and the elements
should be integers or <cite>None</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple representing the shape of the output of this layer. The
tuple has as many elements as there are output dimensions, and the
elements are all either integers or <cite>None</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method will typically be overridden when implementing a new
<code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code> class. By default it simply returns the input
shape. This means that a layer that does not modify the shape
(e.g. because it applies an elementwise operation) does not need
to override this method.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.SiameseConcatLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.custom_layers.</span></span><span class="sig-name descname"><span class="pre">SiameseConcatLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_per_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#SiameseConcatLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.SiameseConcatLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">lasagne.layers.base.Layer</span></code></p>
<p>TODO checkout layers.merge.ConcatLayer</p>
<p>Takes two network representations in the batch and combines them along an axis.</p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.SiameseConcatLayer.get_output_for">
<span class="sig-name descname"><span class="pre">get_output_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T=&lt;module</span> <span class="pre">'theano.tensor'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/theano/tensor/__init__.py'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#SiameseConcatLayer.get_output_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.SiameseConcatLayer.get_output_for" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.custom_layers –test-SiameseConcatLayer.get_output_for:1 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.custom_layers</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">InputLayer</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">SiameseConcatLayer</span><span class="p">(</span><span class="n">input_layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="o">*</span><span class="n">input_shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_output_for</span><span class="p">(</span><span class="n">input_</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_output_shape_for</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">output_</span><span class="o">.</span><span class="n">shape</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">target_shape</span> <span class="o">==</span> <span class="n">result</span>
<span class="go">(64, 2048)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.custom_layers</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">utils</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">draw_net</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">theano</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">InputLayer</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs_layer</span> <span class="o">=</span> <span class="n">CenterSurroundLayer</span><span class="p">(</span><span class="n">input_layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Make sure that this can concat center surround properly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">SiameseConcatLayer</span><span class="p">(</span><span class="n">cs_layer</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">data_per_label</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">testdata_imglist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inputdata_</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">convert_cv2_images_to_theano_images</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outputdata_</span> <span class="o">=</span> <span class="n">cs_layer</span><span class="o">.</span><span class="n">get_output_for</span><span class="p">(</span><span class="n">inputdata_</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">np</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_</span> <span class="o">=</span> <span class="n">outputdata_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_output_for</span><span class="p">(</span><span class="n">input_</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">np</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">convert_theano_images_to_cv2_images</span><span class="p">(</span><span class="n">output_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interact_image_list</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">num_per_page</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.SiameseConcatLayer.get_output_shape_for">
<span class="sig-name descname"><span class="pre">get_output_shape_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#SiameseConcatLayer.get_output_shape_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.SiameseConcatLayer.get_output_shape_for" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_shape</strong> – shape being fed into this layer</p></li>
<li><p><strong>axis</strong> – overrideable for tests</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.custom_layers –test-get_output_shape_for</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.custom_layers</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">testdata_input_layer</span><span class="p">(</span><span class="n">item_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">SiameseConcatLayer</span><span class="p">(</span><span class="n">input_layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_shape</span> <span class="o">=</span> <span class="n">input_layer</span><span class="o">.</span><span class="n">shape</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_shape_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_output_shape_for</span><span class="p">(</span><span class="n">input_shape</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span> <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">output_shape_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">output_shape_list</span><span class="p">[</span><span class="mi">3</span><span class="p">:])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[(64, 6, 8, 16), (64, 3, 16, 16), (64, 3, 8, 32)]</span>
<span class="go">[(64, 6, 8, 16), (64, 3, 16, 16), (64, 3, 8, 32)]</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.custom_layers</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">testdata_input_layer</span><span class="p">(</span><span class="n">item_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1024</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">SiameseConcatLayer</span><span class="p">(</span><span class="n">input_layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_shape</span> <span class="o">=</span> <span class="n">input_layer</span><span class="o">.</span><span class="n">shape</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_shape_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_output_shape_for</span><span class="p">(</span><span class="n">input_shape</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span> <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">output_shape_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[(64, 2048), (64, 2048)]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.evaluate_layer_list">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.custom_layers.</span></span><span class="sig-name descname"><span class="pre">evaluate_layer_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network_layers_def</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#evaluate_layer_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.evaluate_layer_list" title="Permalink to this definition"></a></dt>
<dd><p>compiles a sequence of partial functions into a network</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.interact_image_list">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.custom_layers.</span></span><span class="sig-name descname"><span class="pre">interact_image_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_per_page</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#interact_image_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.interact_image_list" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.load_json_arch_def">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.custom_layers.</span></span><span class="sig-name descname"><span class="pre">load_json_arch_def</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arch_json_fpath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#load_json_arch_def"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.load_json_arch_def" title="Permalink to this definition"></a></dt>
<dd><dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">layer_list</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">get_all_layers</span><span class="p">(</span><span class="n">output_layer</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">net_strs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">layer_json_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">net_strs</span><span class="o">.</span><span class="n">make_layer_json_dict</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">layer_list</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arch_json_fpath</span> <span class="o">=</span> <span class="s1">&#39;/media/raid/work/WS_ALL/_ibsdb/_ibeis_cache/nets/injur-shark_10056_224x224x3_auqbfhle/models/arch_injur-shark_o2_d11_c688_acioqbst/saved_sessions/fit_session_2016-08-26T173854+5/fit_arch_info.json&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.make_bundles">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.custom_layers.</span></span><span class="sig-name descname"><span class="pre">make_bundles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nonlinearity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lru'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(3,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2,</span> <span class="pre">2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2,</span> <span class="pre">2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#make_bundles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.make_bundles" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.testdata_centersurround">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.custom_layers.</span></span><span class="sig-name descname"><span class="pre">testdata_centersurround</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#testdata_centersurround"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.testdata_centersurround" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.custom_layers.testdata_input_layer">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.custom_layers.</span></span><span class="sig-name descname"><span class="pre">testdata_input_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(3,</span> <span class="pre">32,</span> <span class="pre">32)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/custom_layers.html#testdata_input_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.custom_layers.testdata_input_layer" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-wbia_cnn.dataset">
<span id="wbia-cnn-dataset-module"></span><h2>wbia_cnn.dataset module<a class="headerlink" href="#module-wbia_cnn.dataset" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.dataset.</span></span><span class="sig-name descname"><span class="pre">DataSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfgstr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_dpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.pkl'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#DataSet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.DataSet" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">utool.util_dev.NiceRepr</span></code></p>
<p>helper class for managing dataset paths and general metadata</p>
<dl class="simple">
<dt>SeeAlso:</dt><dd><p>python -m wbia_cnn.ingest_data –test-get_wbia_part_siam_dataset –show</p>
</dd>
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.dataset DataSet</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.ingest_data</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">grab_mnist_category_dataset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">print_dir_structure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ----</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="n">MNISTModel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MNISTModel</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">data_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">output_dims</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">dataset_dpath</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">dataset_dpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">print_structure</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.add_split">
<span class="sig-name descname"><span class="pre">add_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idxs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#DataSet.add_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.DataSet.add_split" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.asdict">
<span class="sig-name descname"><span class="pre">asdict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#DataSet.asdict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.DataSet.asdict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.clear_cache">
<span class="sig-name descname"><span class="pre">clear_cache</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#DataSet.clear_cache"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.DataSet.clear_cache" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#wbia_cnn.dataset.DataSet.data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.data_fpath">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data_fpath</span></span><a class="headerlink" href="#wbia_cnn.dataset.DataSet.data_fpath" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.data_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data_shape</span></span><a class="headerlink" href="#wbia_cnn.dataset.DataSet.data_shape" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.dataset_dpath">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dataset_dpath</span></span><a class="headerlink" href="#wbia_cnn.dataset.DataSet.dataset_dpath" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.dataset_id">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dataset_id</span></span><a class="headerlink" href="#wbia_cnn.dataset.DataSet.dataset_id" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.ensure_dirs">
<span class="sig-name descname"><span class="pre">ensure_dirs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#DataSet.ensure_dirs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.DataSet.ensure_dirs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.ensure_symlinked">
<span class="sig-name descname"><span class="pre">ensure_symlinked</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#DataSet.ensure_symlinked"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.DataSet.ensure_symlinked" title="Permalink to this definition"></a></dt>
<dd><p>Creates a symlink to the training path in the training junction</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.full_dpath">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">full_dpath</span></span><a class="headerlink" href="#wbia_cnn.dataset.DataSet.full_dpath" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.get_split_fmtstr">
<span class="sig-name descname"><span class="pre">get_split_fmtstr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#DataSet.get_split_fmtstr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.DataSet.get_split_fmtstr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.getprop">
<span class="sig-name descname"><span class="pre">getprop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#DataSet.getprop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.DataSet.getprop" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.has_split">
<span class="sig-name descname"><span class="pre">has_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#DataSet.has_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.DataSet.has_split" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.hashid">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hashid</span></span><a class="headerlink" href="#wbia_cnn.dataset.DataSet.hashid" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.hasprop">
<span class="sig-name descname"><span class="pre">hasprop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#DataSet.hasprop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.DataSet.hasprop" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.info_fpath">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">info_fpath</span></span><a class="headerlink" href="#wbia_cnn.dataset.DataSet.info_fpath" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.interact">
<span class="sig-name descname"><span class="pre">interact</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'full'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#DataSet.interact"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.DataSet.interact" title="Permalink to this definition"></a></dt>
<dd><p>python -m wbia_cnn –tf netrun –db mnist –ensuredata –show –datatype=category
python -m wbia_cnn –tf netrun –db PZ_MTEST –acfg ctrl –ensuredata –show</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.labels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">labels</span></span><a class="headerlink" href="#wbia_cnn.dataset.DataSet.labels" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.labels_fpath">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">labels_fpath</span></span><a class="headerlink" href="#wbia_cnn.dataset.DataSet.labels_fpath" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#DataSet.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.DataSet.load" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.load_splitsets">
<span class="sig-name descname"><span class="pre">load_splitsets</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#DataSet.load_splitsets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.DataSet.load_splitsets" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.metadata">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metadata</span></span><a class="headerlink" href="#wbia_cnn.dataset.DataSet.metadata" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.metadata_fpath">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metadata_fpath</span></span><a class="headerlink" href="#wbia_cnn.dataset.DataSet.metadata_fpath" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.new_training_set">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">new_training_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#DataSet.new_training_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.DataSet.new_training_set" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.print_dataset_info">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">print_dataset_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#DataSet.print_dataset_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.DataSet.print_dataset_info" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.print_dir_structure">
<span class="sig-name descname"><span class="pre">print_dir_structure</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#DataSet.print_dir_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.DataSet.print_dir_structure" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.print_dir_tree">
<span class="sig-name descname"><span class="pre">print_dir_tree</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#DataSet.print_dir_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.DataSet.print_dir_tree" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.print_subset_info">
<span class="sig-name descname"><span class="pre">print_subset_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'full'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#DataSet.print_subset_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.DataSet.print_subset_info" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.rrr">
<span class="sig-name descname"><span class="pre">rrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.dataset.DataSet.rrr" title="Permalink to this definition"></a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_per_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#DataSet.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.DataSet.save" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.setprop">
<span class="sig-name descname"><span class="pre">setprop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#DataSet.setprop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.DataSet.setprop" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.split_dpath">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">split_dpath</span></span><a class="headerlink" href="#wbia_cnn.dataset.DataSet.split_dpath" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.subset">
<span class="sig-name descname"><span class="pre">subset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#DataSet.subset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.DataSet.subset" title="Permalink to this definition"></a></dt>
<dd><p>loads a test/train/valid/full data subset</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.subset_data">
<span class="sig-name descname"><span class="pre">subset_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'full'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#DataSet.subset_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.DataSet.subset_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.subset_labels">
<span class="sig-name descname"><span class="pre">subset_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'full'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#DataSet.subset_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.DataSet.subset_labels" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.subset_metadata">
<span class="sig-name descname"><span class="pre">subset_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'full'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#DataSet.subset_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.DataSet.subset_metadata" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.unique_labels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">unique_labels</span></span><a class="headerlink" href="#wbia_cnn.dataset.DataSet.unique_labels" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.vd">
<span class="sig-name descname"><span class="pre">vd</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.dataset.DataSet.vd" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.dataset.DataSet.view_directory">
<span class="sig-name descname"><span class="pre">view_directory</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#DataSet.view_directory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.DataSet.view_directory" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.dataset.expand_data_indicies">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.dataset.</span></span><span class="sig-name descname"><span class="pre">expand_data_indicies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_per_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#expand_data_indicies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.expand_data_indicies" title="Permalink to this definition"></a></dt>
<dd><p>when data_per_label &gt; 1, gives the corresponding data indicies for the data
indicies</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.dataset.get_alias_dict_fpath">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.dataset.</span></span><span class="sig-name descname"><span class="pre">get_alias_dict_fpath</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#get_alias_dict_fpath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.get_alias_dict_fpath" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.dataset.get_juction_dpath">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.dataset.</span></span><span class="sig-name descname"><span class="pre">get_juction_dpath</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#get_juction_dpath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.get_juction_dpath" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>junction_dpath</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn –tf get_juction_dpath –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.dataset</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">junction_dpath</span> <span class="o">=</span> <span class="n">get_juction_dpath</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;junction_dpath = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">junction_dpath</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">vd</span><span class="p">(</span><span class="n">junction_dpath</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.dataset.stratified_kfold_label_split">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.dataset.</span></span><span class="sig-name descname"><span class="pre">stratified_kfold_label_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_folds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#stratified_kfold_label_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.stratified_kfold_label_split" title="Permalink to this definition"></a></dt>
<dd><p>Also enforces that labels are not broken into separate groups.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>ndarray</em>) – labels</p></li>
<li><p><strong>labels</strong> – </p></li>
<li><p><strong>y_idx</strong> (<em>array</em>) – indexes associated with y if it was already presampled</p></li>
<li><p><strong>rng</strong> (<em>RandomState</em>) – random number generator(default = None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>index_sets</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><p>?</p>
</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.dataset stratified_label_shuffle_split –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.dataset</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span>      <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fractions</span> <span class="o">=</span> <span class="p">[</span><span class="mf">.7</span><span class="p">,</span> <span class="mf">.3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_sets</span> <span class="o">=</span> <span class="n">stratified_label_shuffle_split</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">fractions</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.dataset.stratified_label_shuffle_split">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.dataset.</span></span><span class="sig-name descname"><span class="pre">stratified_label_shuffle_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fractions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#stratified_label_shuffle_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.stratified_label_shuffle_split" title="Permalink to this definition"></a></dt>
<dd><p>modified from sklearn to make n splits instaed of 2.
Also enforces that labels are not broken into separate groups.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>ndarray</em>) – labels</p></li>
<li><p><strong>labels</strong> – </p></li>
<li><p><strong>fractions</strong> – </p></li>
<li><p><strong>rng</strong> (<em>RandomState</em>) – random number generator(default = None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>index_sets</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><p>?</p>
</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.dataset stratified_label_shuffle_split –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.dataset</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span>      <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fractions</span> <span class="o">=</span> <span class="p">[</span><span class="mf">.7</span><span class="p">,</span> <span class="mf">.3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index_sets</span> <span class="o">=</span> <span class="n">stratified_label_shuffle_split</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">fractions</span><span class="p">,</span> <span class="n">rng</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.dataset.stratified_shuffle_split">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.dataset.</span></span><span class="sig-name descname"><span class="pre">stratified_shuffle_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fractions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/dataset.html#stratified_shuffle_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.dataset.stratified_shuffle_split" title="Permalink to this definition"></a></dt>
<dd><p>modified from sklearn to make n splits instaed of 2</p>
</dd></dl>

</section>
<section id="module-wbia_cnn.draw_net">
<span id="wbia-cnn-draw-net-module"></span><h2>wbia_cnn.draw_net module<a class="headerlink" href="#module-wbia_cnn.draw_net" title="Permalink to this headline"></a></h2>
<p>Functions to create network diagrams from a list of Layers.</p>
<p class="rubric">References</p>
<p># Adapted from
<a class="reference external" href="https://github.com/ebenolson/Lasagne/blob/master/examples/draw_net.py">https://github.com/ebenolson/Lasagne/blob/master/examples/draw_net.py</a></p>
<p># TODO:
<a class="reference external" href="https://github.com/dnouri/nolearn/blob/master/nolearn/lasagne/visualize.py">https://github.com/dnouri/nolearn/blob/master/nolearn/lasagne/visualize.py</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.draw_net.Dream">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.draw_net.</span></span><span class="sig-name descname"><span class="pre">Dream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gauss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_net.html#Dream"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_net.Dream" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p><a class="reference external" href="https://groups.google.com/forum/#!topic/lasagne-users/UxZpNthZfq0">https://groups.google.com/forum/#!topic/lasagne-users/UxZpNthZfq0</a>
<a class="reference external" href="http://arxiv.org/pdf/1312.6034.pdf">http://arxiv.org/pdf/1312.6034.pdf</a>
<a class="reference external" href="http://igva2012.wikispaces.asu.edu/file/view/Erhan+2009+Visualizing+higher+layer+features+of+a+deep+network.pdf">http://igva2012.wikispaces.asu.edu/file/view/Erhan+2009+Visualizing+higher+layer+features+of+a+deep+network.pdf</a></p>
<p>#TODO
<a class="reference external" href="https://arxiv.org/pdf/1605.09304v3.pdf">https://arxiv.org/pdf/1605.09304v3.pdf</a></p>
<p>Class model visualization. Sort of like a deep-dream</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.draw_net Dream –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assumes mnist is trained</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.draw_net</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="n">mnist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">testdata_mnist</span><span class="p">(</span><span class="n">dropout</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">load_model_state</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_labels</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia</span> <span class="kn">import</span> <span class="n">plottool</span> <span class="k">as</span> <span class="n">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.qt4ensure()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dream</span> <span class="o">=</span> <span class="n">Dream</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">niters</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">dream</span><span class="o">.</span><span class="n">make_class_images</span><span class="p">(</span><span class="n">target_labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.draw_net.Dream.generate_class_images">
<span class="sig-name descname"><span class="pre">generate_class_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_labels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_net.html#Dream.generate_class_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_net.Dream.generate_class_images" title="Permalink to this definition"></a></dt>
<dd><dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia</span> <span class="kn">import</span> <span class="n">plottool</span> <span class="k">as</span> <span class="n">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fnum</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="s1">&#39;gauss&#39;</span><span class="p">,</span> <span class="n">niters</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">update_rate</span><span class="o">=</span><span class="mf">.05</span><span class="p">,</span> <span class="n">weight_decay</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">output_dims</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dream</span> <span class="o">=</span> <span class="n">draw_net</span><span class="o">.</span><span class="n">Dream</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target_labels</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">images</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dream</span><span class="o">.</span><span class="n">generate_class_images</span><span class="p">(</span><span class="n">target_labels</span><span class="p">))</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vid</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">make_video</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="s1">&#39;dynimg.pimj&#39;</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">is_color</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;PIM1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vid</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">make_video2</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="s1">&#39;dynimg&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ims</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">imgs</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ims</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">im</span><span class="p">])</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.animation</span> <span class="k">as</span> <span class="nn">animation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ani</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">ArtistAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ims</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                <span class="n">repeat_delay</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ani</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;dynamic_images.mp4&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">startfile</span><span class="p">(</span><span class="s1">&#39;dynamic_images.mp4&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.draw_net.Dream.make_class_images">
<span class="sig-name descname"><span class="pre">make_class_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_labels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_net.html#Dream.make_class_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_net.Dream.make_class_images" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.draw_net.Dream.saliency">
<span class="sig-name descname"><span class="pre">saliency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_net.html#Dream.saliency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_net.Dream.saliency" title="Permalink to this definition"></a></dt>
<dd><p>num = 10
Xb = model.prepare_data(X_test[0:num])
yb = y_test[0:num]</p>
<p>dpath = ‘’
dataset = None</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.draw_net.draw_neural_net">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.draw_net.</span></span><span class="sig-name descname"><span class="pre">draw_neural_net</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bottom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_sizes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_net.html#draw_neural_net"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_net.draw_neural_net" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p># Taken from
<a class="reference external" href="https://gist.github.com/craffel/2d727968c3aaebd10359">https://gist.github.com/craffel/2d727968c3aaebd10359</a></p>
<p>Draw a neural network cartoon using matplotilb.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">draw_neural_net</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="mf">.1</span><span class="p">,</span> <span class="mf">.9</span><span class="p">,</span> <span class="mf">.1</span><span class="p">,</span> <span class="mf">.9</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><dl class="simple">
<dt>ax<span class="classifier">matplotlib.axes.AxesSubplot</span></dt><dd><p>The axes on which to plot the cartoon (get e.g. by plt.gca())</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>left<span class="classifier">float</span></dt><dd><p>The center of the leftmost node(s) will be placed here</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>right<span class="classifier">float</span></dt><dd><p>The center of the rightmost node(s) will be placed here</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>bottom<span class="classifier">float</span></dt><dd><p>The center of the bottommost node(s) will be placed here</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>top<span class="classifier">float</span></dt><dd><p>The center of the topmost node(s) will be placed here</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>layer_sizes<span class="classifier">list of int</span></dt><dd><p>List of layer sizes, including input and output dimensionality</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.draw_net.imwrite_theano_symbolic_graph">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.draw_net.</span></span><span class="sig-name descname"><span class="pre">imwrite_theano_symbolic_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thean_expr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_net.html#imwrite_theano_symbolic_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_net.imwrite_theano_symbolic_graph" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.draw_net.make_conv_weight_image">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.draw_net.</span></span><span class="sig-name descname"><span class="pre">make_conv_weight_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">144</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_net.html#make_conv_weight_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_net.make_conv_weight_image" title="Permalink to this definition"></a></dt>
<dd><p>just makes the image ndarray of the weights</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.draw_net.occlusion_heatmap">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.draw_net.</span></span><span class="sig-name descname"><span class="pre">occlusion_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">square_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_net.html#occlusion_heatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_net.occlusion_heatmap" title="Permalink to this definition"></a></dt>
<dd><p>An occlusion test that checks an image for its critical parts.
In this function, a square part of the image is occluded (i.e. set
to 0) and then the net is tested for its propensity to predict the
correct label. One should expect that this propensity shrinks of
critical parts of the image are occluded. If not, this indicates
overfitting.</p>
<p>Depending on the depth of the net and the size of the image, this
function may take awhile to finish, since one prediction for each
pixel of the image is made.
Currently, all color channels are occluded at the same time. Also,
this does not really work if images are randomly distorted by the
batch iterator.</p>
<p>See paper: Zeiler, Fergus 2013</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>net</strong> – NeuralNet instance</p></li>
<li><p><strong>test.</strong> (<em>The neural net to</em>) – </p></li>
<li><p><strong>x</strong> – np.array</p></li>
<li><p><strong>data</strong> (<em>The input</em>) – </p></li>
<li><p><strong>shape</strong> (<em>should be of</em>) – </p></li>
<li><p><strong>data.</strong> (<em>sense with image</em>) – </p></li>
<li><p><strong>target</strong> – int</p></li>
<li><p><strong>several</strong> (<em>The true value of the image. If the net makes</em>) – </p></li>
<li><p><strong>predictions</strong> – </p></li>
<li><p><strong>classes</strong> (<em>say 10</em>) – </p></li>
<li><p><strong>look</strong> (<em>this indicates which one to</em>) – </p></li>
<li><p><strong>at.</strong> – </p></li>
<li><p><strong>square_length</strong> – int (default=7)</p></li>
<li><p><strong>image.</strong> (<em>The length of the side of the square that occludes the</em>) – </p></li>
<li><p><strong>number.</strong> (<em>Must be an odd</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Results:</dt><dd><p>heat_array : np.array (with same size as image)
An 2D np.array that at each point (i, j) contains the predicted
probability of the correct class if the image is occluded by a
square with center (i, j).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.draw_net.output_confusion_matrix">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.draw_net.</span></span><span class="sig-name descname"><span class="pre">output_confusion_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_net.html#output_confusion_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_net.output_confusion_matrix" title="Permalink to this definition"></a></dt>
<dd><p>currently hacky implementation, fix it later</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.draw_net.plot_occlusion">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.draw_net.</span></span><span class="sig-name descname"><span class="pre">plot_occlusion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">square_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(9,</span> <span class="pre">None)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_net.html#plot_occlusion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_net.plot_occlusion" title="Permalink to this definition"></a></dt>
<dd><p>Plot which parts of an image are particularly import for the
net to classify the image correctly.</p>
<p>See paper: Zeiler, Fergus 2013</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>net</strong> – NeuralNet instance</p></li>
<li><p><strong>test.</strong> (<em>The neural net to</em>) – </p></li>
<li><p><strong>Xb</strong> (<em>at. If more than one sample is passed to</em>) – numpy.array</p></li>
<li><p><strong>data</strong> (<em>The input</em>) – </p></li>
<li><p><strong>shape</strong> (<em>should be of</em>) – </p></li>
<li><p><strong>data.</strong> (<em>sense with image</em>) – </p></li>
<li><p><strong>target</strong> – list or numpy.array of ints</p></li>
<li><p><strong>several</strong> (<em>The true values of the image. If the net makes</em>) – </p></li>
<li><p><strong>predictions</strong> – </p></li>
<li><p><strong>classes</strong> (<em>say 10</em>) – </p></li>
<li><p><strong>look</strong> (<em>this indicates which one to</em>) – </p></li>
<li><p><strong>Xb</strong> – </p></li>
<li><p><strong>needs</strong> (<em>each of them</em>) – </p></li>
<li><p><strong>target.</strong> (<em>its own</em>) – </p></li>
<li><p><strong>square_length</strong> – int (default=7)</p></li>
<li><p><strong>image.</strong> (<em>The length of the side of the square that occludes the</em>) – </p></li>
<li><p><strong>number.</strong> (<em>Must be an odd</em>) – </p></li>
<li><p><strong>figsize</strong> – tuple (int, int)</p></li>
<li><p><strong>figure.</strong> (<em>Size of the</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.draw_net.plot_saliency">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.draw_net.</span></span><span class="sig-name descname"><span class="pre">plot_saliency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(9,</span> <span class="pre">None)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_net.html#plot_saliency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_net.plot_saliency" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.draw_net.pydot_to_image">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.draw_net.</span></span><span class="sig-name descname"><span class="pre">pydot_to_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pydot_graph</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_net.html#pydot_to_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_net.pydot_to_image" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4596962/display-graph-without-saving-using-pydot">http://stackoverflow.com/questions/4596962/display-graph-without-saving-using-pydot</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.draw_net.save_confusion_matrix">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.draw_net.</span></span><span class="sig-name descname"><span class="pre">save_confusion_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_net.html#save_confusion_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_net.save_confusion_matrix" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.draw_net.show_arch_nx_graph">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.draw_net.</span></span><span class="sig-name descname"><span class="pre">show_arch_nx_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fullinfo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_net.html#show_arch_nx_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_net.show_arch_nx_graph" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.draw_net show_arch_nx_graph:0 –show
python -m wbia_cnn.draw_net show_arch_nx_graph:1 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.draw_net</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">models</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">mnist</span><span class="o">.</span><span class="n">MNISTModel</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">output_dims</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                <span class="n">data_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">layers</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_all_layers</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_arch_nx_graph</span><span class="p">(</span><span class="n">layers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia</span> <span class="kn">import</span> <span class="n">plottool</span> <span class="k">as</span> <span class="n">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.draw_net</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">models</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SiameseCenterSurroundModel</span><span class="p">(</span><span class="n">autoinit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">layers</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_all_layers</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_arch_nx_graph</span><span class="p">(</span><span class="n">layers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia</span> <span class="kn">import</span> <span class="n">plottool</span> <span class="k">as</span> <span class="n">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.draw_net.show_confusion_matrix">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.draw_net.</span></span><span class="sig-name descname"><span class="pre">show_confusion_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">correct_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_net.html#show_confusion_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_net.show_confusion_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Given the correct and predict labels, show the confusion matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>correct_y</strong> (<em>list of int</em>) – the list of correct labels</p></li>
<li><p><strong>predict_y</strong> (<em>list of int</em>) – the list of predict assigned labels</p></li>
<li><p><strong>category_list</strong> (<em>list of str</em>) – the category list of all categories</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Displays:</dt><dd><p>matplotlib: graph of the confusion matrix</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p>TODO FIXME and simplify</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.draw_net.show_convolutional_weights">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.draw_net.</span></span><span class="sig-name descname"><span class="pre">show_convolutional_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">144</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pnum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_net.html#show_convolutional_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_net.show_convolutional_weights" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_weights</strong> – </p></li>
<li><p><strong>use_color</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – </p></li>
<li><p><strong>limit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl>
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.draw_net –test-show_convolutional_weights –show
python -m wbia_cnn.draw_net –test-show_convolutional_weights –show –index=1</p>
<p># Need to fit mnist first
python -m wbia_cnn _ModelFitting.fit:1 –vd</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assumes mnist is trained</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.draw_net</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">ingest_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="n">MNISTModel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">ingest_data</span><span class="o">.</span><span class="n">grab_mnist_category_dataset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MNISTModel</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">data_shape</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">data_shape</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">name</span><span class="o">=</span><span class="s1">&#39;bnorm&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">output_dims</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">unique_labels</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">batch_norm</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">dataset_dpath</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">dataset_dpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">load_model_state</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nn_layers</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_all_layers</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weighted_layers</span> <span class="o">=</span> <span class="p">[</span><span class="n">layer</span> <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">nn_layers</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">all_weights</span> <span class="o">=</span> <span class="n">weighted_layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">W</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;all_weights.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">all_weights</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_color</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">limit</span> <span class="o">=</span> <span class="mi">64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">show_convolutional_weights</span><span class="p">(</span><span class="n">all_weights</span><span class="p">,</span> <span class="n">use_color</span><span class="p">,</span> <span class="n">limit</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia</span> <span class="kn">import</span> <span class="n">plottool</span> <span class="k">as</span> <span class="n">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">qt4ensure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">show_convolutional_weights</span><span class="p">(</span><span class="n">all_weights</span><span class="p">,</span> <span class="n">use_color</span><span class="p">,</span> <span class="n">limit</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.draw_net</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">models</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">lasagne</span> <span class="kn">import</span> <span class="n">layers</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SiameseCenterSurroundModel</span><span class="p">(</span><span class="n">autoinit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_output_layer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nn_layers</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">get_all_layers</span><span class="p">(</span><span class="n">output_layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weighted_layers</span> <span class="o">=</span> <span class="p">[</span><span class="n">layer</span> <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">nn_layers</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--index&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">all_weights</span> <span class="o">=</span> <span class="n">weighted_layers</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">W</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;all_weights.shape = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">all_weights</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">use_color</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">limit</span> <span class="o">=</span> <span class="mi">64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">show_convolutional_weights</span><span class="p">(</span><span class="n">all_weights</span><span class="p">,</span> <span class="n">use_color</span><span class="p">,</span> <span class="n">limit</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.draw_net.show_saliency_heatmap">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.draw_net.</span></span><span class="sig-name descname"><span class="pre">show_saliency_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_net.html#show_saliency_heatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_net.show_saliency_heatmap" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://github.com/dnouri/nolearn/blob/master/nolearn/lasagne/visualize.py">https://github.com/dnouri/nolearn/blob/master/nolearn/lasagne/visualize.py</a></p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assumes mnist is trained</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.draw_net</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">ingest_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="n">MNISTModel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">ingest_data</span><span class="o">.</span><span class="n">grab_mnist_category_dataset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MNISTModel</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">data_shape</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">data_shape</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">name</span><span class="o">=</span><span class="s1">&#39;bnorm&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">output_dims</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">unique_labels</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">batch_norm</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">dataset_dpath</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">dataset_dpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">load_model_state</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia</span> <span class="kn">import</span> <span class="n">plottool</span> <span class="k">as</span> <span class="n">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">qt4ensure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_saliency_heatmap</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-wbia_cnn.draw_results">
<span id="wbia-cnn-draw-results-module"></span><h2>wbia_cnn.draw_results module<a class="headerlink" href="#module-wbia_cnn.draw_results" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.draw_results.get_patch_chunk">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.draw_results.</span></span><span class="sig-name descname"><span class="pre">get_patch_chunk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_lists</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indicies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">border_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">draw_meta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontScale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_results.html#get_patch_chunk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_results.get_patch_chunk" title="Permalink to this definition"></a></dt>
<dd><p>indicies = chunked_indicies[0]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_lists</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – list of lists. The first dimension is the data_per_label dim.</p></li>
<li><p><strong>warped_patch1_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>warped_patch2_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>label_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>flat_metadata</strong> – </p></li>
<li><p><strong>indicies</strong> – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.draw_results –test-get_patch_chunk –show
python -m wbia_cnn.draw_results –test-get_patch_chunk</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.draw_results</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">ingest_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">,</span> <span class="n">label_list</span> <span class="o">=</span> <span class="n">ingest_data</span><span class="o">.</span><span class="n">testdata_patchmatch2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flat_metadata</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fs&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">label_list</span><span class="p">))}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_lists</span> <span class="o">=</span>  <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">ut</span><span class="o">.</span><span class="n">ichunks</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indicies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="p">,</span> <span class="n">offset_list</span><span class="p">,</span> <span class="n">sf_list</span><span class="p">,</span> <span class="n">stacked_orig_sizes</span> <span class="o">=</span> <span class="n">get_patch_chunk</span><span class="p">(</span><span class="n">data_lists</span><span class="p">,</span> <span class="n">label_list</span><span class="p">,</span> <span class="n">flat_metadata</span><span class="p">,</span> <span class="n">indicies</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia</span> <span class="kn">import</span> <span class="n">plottool</span> <span class="k">as</span> <span class="n">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="go">(1920, 384, 3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.draw_results.get_patch_multichunks">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.draw_results.</span></span><span class="sig-name descname"><span class="pre">get_patch_multichunks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_lists</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiindicies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_results.html#get_patch_multichunks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_results.get_patch_multichunks" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.draw_results –test-get_patch_multichunks –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.draw_results</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">ingest_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">,</span> <span class="n">label_list</span> <span class="o">=</span> <span class="n">ingest_data</span><span class="o">.</span><span class="n">testdata_patchmatch2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flat_metadata</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">warped_patch1_list</span><span class="p">,</span> <span class="n">warped_patch2_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">ut</span><span class="o">.</span><span class="n">ichunks</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_lists</span> <span class="o">=</span> <span class="p">(</span><span class="n">warped_patch1_list</span><span class="p">,</span> <span class="n">warped_patch2_list</span><span class="p">,</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">multiindicies</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stacked_img</span><span class="p">,</span> <span class="n">stacked_offsets</span><span class="p">,</span> <span class="n">stacked_sfs</span> <span class="o">=</span> <span class="n">get_patch_multichunks</span><span class="p">(</span><span class="n">data_lists</span><span class="p">,</span> <span class="n">label_list</span><span class="p">,</span> <span class="n">flat_metadata</span><span class="p">,</span> <span class="n">multiindicies</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia</span> <span class="kn">import</span> <span class="n">plottool</span> <span class="k">as</span> <span class="n">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">stacked_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.draw_results.get_patch_sample_img">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.draw_results.</span></span><span class="sig-name descname"><span class="pre">get_patch_sample_img</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">warped_patch1_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warped_patch2_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunck_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(6,</span> <span class="pre">10)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_results.html#get_patch_sample_img"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_results.get_patch_sample_img" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.draw_results.get_sample_pairimg_from_X">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.draw_results.</span></span><span class="sig-name descname"><span class="pre">get_sample_pairimg_from_X</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_results.html#get_sample_pairimg_from_X"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_results.get_sample_pairimg_from_X" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.draw_results.interact_dataset">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.draw_results.</span></span><span class="sig-name descname"><span class="pre">interact_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_per_label</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_results.html#interact_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_results.interact_dataset" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> – </p></li>
<li><p><strong>data</strong> – </p></li>
<li><p><strong>flat_metadata</strong> – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.draw_results –test-interact_dataset –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.draw_results</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">ingest_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ingest_data</span><span class="o">.</span><span class="n">testdata_patchmatch2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flat_metadata</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fs&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">interact_siamsese_data_patches</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">flat_metadata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.draw_results.interact_patches">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.draw_results.</span></span><span class="sig-name descname"><span class="pre">interact_patches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_lists</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sortby</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figtitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunck_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ibs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hack_one_per_aid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qreq_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_results.html#interact_patches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_results.interact_patches" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p></li>
<li><p><strong>data_lists</strong> (<em>tuple of lists</em>) – fixme bad name</p></li>
<li><p><strong>flat_metadata</strong> – </p></li>
<li><p><strong>sortby</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>figtitle</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>chunck_sizes</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.draw_results –exec-interact_patches –show</p>
</dd>
<dt>SeeAlso:</dt><dd><p>python -m wbia_cnn.ingest_wbia –exec-extract_annotpair_training_chips –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.draw_results</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">ingest_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ingest_data</span><span class="o">.</span><span class="n">testdata_patchmatch2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flat_metadata</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fs&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">interact_siamsese_data_patches</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">flat_metadata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.draw_results.interact_siamsese_data_patches">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.draw_results.</span></span><span class="sig-name descname"><span class="pre">interact_siamsese_data_patches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_metadata</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_results.html#interact_siamsese_data_patches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_results.interact_siamsese_data_patches" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> – </p></li>
<li><p><strong>data</strong> – </p></li>
<li><p><strong>flat_metadata</strong> – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.draw_results –test-interact_siamsese_data_patches –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.draw_results</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">ingest_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ingest_data</span><span class="o">.</span><span class="n">testdata_patchmatch2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flat_metadata</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fs&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">interact_siamsese_data_patches</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">flat_metadata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.draw_results.make_InteractClasses">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.draw_results.</span></span><span class="sig-name descname"><span class="pre">make_InteractClasses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_results.html#make_InteractClasses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_results.make_InteractClasses" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.draw_results.make_InteractSiamPatches">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.draw_results.</span></span><span class="sig-name descname"><span class="pre">make_InteractSiamPatches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_results.html#make_InteractSiamPatches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_results.make_InteractSiamPatches" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.draw_results.visualize_score_separability">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.draw_results.</span></span><span class="sig-name descname"><span class="pre">visualize_score_separability</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warped_patch1_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warped_patch2_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_metadata</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/draw_results.html#visualize_score_separability"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.draw_results.visualize_score_separability" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-wbia_cnn.experiments">
<span id="wbia-cnn-experiments-module"></span><h2>wbia_cnn.experiments module<a class="headerlink" href="#module-wbia_cnn.experiments" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.experiments.show_hard_cases">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.experiments.</span></span><span class="sig-name descname"><span class="pre">show_hard_cases</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/experiments.html#show_hard_cases"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.experiments.show_hard_cases" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.experiments.sift_dataset_separability">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.experiments.</span></span><span class="sig-name descname"><span class="pre">sift_dataset_separability</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/experiments.html#sift_dataset_separability"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.experiments.sift_dataset_separability" title="Permalink to this definition"></a></dt>
<dd><p>VERY HACKED RIGHT NOW. ONLY LIBERTY. BLINDLY CACHES</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> – </p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.experiments –exec-sift_dataset_separability –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># SCRIPT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.experiments</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">ingest_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">ingest_data</span><span class="o">.</span><span class="n">grab_liberty_siam_dataset</span><span class="p">(</span><span class="mi">250000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sift_dataset_separability</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.experiments.test_siamese_performance">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.experiments.</span></span><span class="sig-name descname"><span class="pre">test_siamese_performance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/experiments.html#test_siamese_performance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.experiments.test_siamese_performance" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>utprof.py -m wbia_cnn –tf pz_patchmatch –db liberty –test –weights=liberty:current –arch=siaml2_128 –test
python -m wbia_cnn –tf netrun –db liberty –arch=siaml2_128 –test  –ensure
python -m wbia_cnn –tf netrun –db liberty –arch=siaml2_128 –test  –ensure –weights=new
python -m wbia_cnn –tf netrun –db liberty –arch=siaml2_128 –train –weights=new
python -m wbia_cnn –tf netrun –db pzmtest –weights=liberty:current –arch=siaml2_128 –test  # NOQA
python -m wbia_cnn –tf netrun –db pzmtest –weights=liberty:current –arch=siaml2_128</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.experiments.test_siamese_thresholds">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.experiments.</span></span><span class="sig-name descname"><span class="pre">test_siamese_thresholds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/experiments.html#test_siamese_thresholds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.experiments.test_siamese_thresholds" title="Permalink to this definition"></a></dt>
<dd><p>Test function to see how good of a threshold we can learn</p>
<p>network_output = prob_list</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.experiments.test_sift_patchmatch_scores">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.experiments.</span></span><span class="sig-name descname"><span class="pre">test_sift_patchmatch_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/experiments.html#test_sift_patchmatch_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.experiments.test_sift_patchmatch_scores" title="Permalink to this definition"></a></dt>
<dd><p>data = X_test
labels = y_test</p>
</dd></dl>

</section>
<section id="module-wbia_cnn.harness">
<span id="wbia-cnn-harness-module"></span><h2>wbia_cnn.harness module<a class="headerlink" href="#module-wbia_cnn.harness" title="Permalink to this headline"></a></h2>
<dl class="simple">
<dt>DEPRICATED:</dt><dd><p>code is now in abstract_model under fitting</p>
</dd>
</dl>
<p>constructs the Theano optimization and trains a learning model,
optionally by initializing the network with pre-trained weights.</p>
<p><a class="reference external" href="http://cs231n.github.io/neural-networks-3/#distr">http://cs231n.github.io/neural-networks-3/#distr</a></p>
<dl class="simple">
<dt>Pretrained Models:</dt><dd><p><a class="reference external" href="https://github.com/fchollet/deep-learning-models">https://github.com/fchollet/deep-learning-models</a></p>
</dd>
</dl>
</section>
<section id="module-wbia_cnn.ingest_data">
<span id="wbia-cnn-ingest-data-module"></span><h2>wbia_cnn.ingest_data module<a class="headerlink" href="#module-wbia_cnn.ingest_data" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_data.get_extern_training_dpath">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_data.</span></span><span class="sig-name descname"><span class="pre">get_extern_training_dpath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alias_key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_data.html#get_extern_training_dpath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_data.get_extern_training_dpath" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_data.get_numpy_dataset">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_data.</span></span><span class="sig-name descname"><span class="pre">get_numpy_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_dpath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_data.html#get_numpy_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_data.get_numpy_dataset" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_data.get_numpy_dataset2">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_data.</span></span><span class="sig-name descname"><span class="pre">get_numpy_dataset2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_dpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_data.html#get_numpy_dataset2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_data.get_numpy_dataset2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_data.get_wbia_part_siam_dataset">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_data.</span></span><span class="sig-name descname"><span class="pre">get_wbia_part_siam_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_data.html#get_wbia_part_siam_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_data.get_wbia_part_siam_dataset" title="Permalink to this definition"></a></dt>
<dd><p>PARTS based network data</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.ingest_data –test-get_wbia_part_siam_dataset –show
python -m wbia_cnn.ingest_data –test-get_wbia_part_siam_dataset –show –db PZ_Master1 –acfg_name timectrl
python -m wbia_cnn.ingest_data –test-get_wbia_part_siam_dataset –show –db PZ_MTEST –acfg_name unctrl –dryrun</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.ingest_data</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">draw_results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># ut.argparse_dict({&#39;max_examples&#39;: None, &#39;num_top&#39;: 3})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">get_wbia_part_siam_dataset</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">ibs</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">getprop</span><span class="p">(</span><span class="s1">&#39;ibs&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_data.get_wbia_patch_siam_dataset">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_data.</span></span><span class="sig-name descname"><span class="pre">get_wbia_patch_siam_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_data.html#get_wbia_patch_siam_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_data.get_wbia_patch_siam_dataset" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.ingest_data –test-get_wbia_patch_siam_dataset –show
python -m wbia_cnn.ingest_data –test-get_wbia_patch_siam_dataset –show –db PZ_Master1 –acfg_name default
python -m wbia_cnn.ingest_data –test-get_wbia_patch_siam_dataset –show –db PZ_Master1 –acfg_name timectrl
python -m wbia_cnn.ingest_data –test-get_wbia_patch_siam_dataset –show –db PZ_MTEST –acfg_name unctrl –dryrun</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.ingest_data</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">draw_results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># ut.argparse_dict({&#39;max_examples&#39;: None, &#39;num_top&#39;: 3})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">get_wbia_patch_siam_dataset</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">interact</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_data.grab_dataset">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_data.</span></span><span class="sig-name descname"><span class="pre">grab_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds_tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datatype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'siam-patch'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_data.html#grab_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_data.grab_dataset" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_data.grab_liberty_siam_dataset">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_data.</span></span><span class="sig-name descname"><span class="pre">grab_liberty_siam_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pairs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">250000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_data.html#grab_liberty_siam_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_data.grab_liberty_siam_dataset" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">References</p>
<p><a class="reference external" href="http://icvl.ee.ic.ac.uk/vbalnt/liberty.zip">http://icvl.ee.ic.ac.uk/vbalnt/liberty.zip</a>
<a class="reference external" href="https://github.com/osdf/datasets/blob/master/patchdata/dataset.py">https://github.com/osdf/datasets/blob/master/patchdata/dataset.py</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.ingest_data –test-grab_liberty_siam_dataset –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.ingest_data</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pairs</span> <span class="o">=</span> <span class="mi">500</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">grab_liberty_siam_dataset</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">draw_results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#ibsplugin.rrr()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flat_metadata</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span><span class="s1">&#39;full&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">warped_patch1_list</span> <span class="o">=</span> <span class="n">data</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">warped_patch2_list</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">interact</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_data.grab_mnist_category_dataset">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_data.</span></span><span class="sig-name descname"><span class="pre">grab_mnist_category_dataset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_data.html#grab_mnist_category_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_data.grab_mnist_category_dataset" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn grab_mnist_category_dataset
python -m wbia_cnn grab_mnist_category_dataset_float
python -m wbia_cnn grab_mnist_category_dataset –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.ingest_data</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">grab_mnist_category_dataset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">print_subset_info</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">print_dir_tree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inter</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">interact</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_data.grab_mnist_category_dataset_float">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_data.</span></span><span class="sig-name descname"><span class="pre">grab_mnist_category_dataset_float</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_data.html#grab_mnist_category_dataset_float"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_data.grab_mnist_category_dataset_float" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn grab_mnist_category_dataset_float
python -m wbia_cnn grab_mnist_category_dataset_float –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.ingest_data</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">grab_mnist_category_dataset_float</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">print_subset_info</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">print_dir_tree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inter</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">interact</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_data.grab_mnist_siam_dataset">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_data.</span></span><span class="sig-name descname"><span class="pre">grab_mnist_siam_dataset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_data.html#grab_mnist_siam_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_data.grab_mnist_siam_dataset" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.ingest_data –test-grab_mnist_siam_dataset –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.ingest_data</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">grab_mnist_siam_dataset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">draw_results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#ibsplugin.rrr()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flat_metadata</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span><span class="s1">&#39;full&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">interact</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_data.grab_siam_dataset">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_data.</span></span><span class="sig-name descname"><span class="pre">grab_siam_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds_tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_data.html#grab_siam_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_data.grab_siam_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Will build the dataset using the command line if it doesn’t exist</p>
<dl>
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.ingest_data –test-grab_siam_dataset –db mnist –show
python -m wbia_cnn.ingest_data –test-grab_siam_dataset –db liberty –show
python -m wbia_cnn.ingest_data –test-grab_siam_dataset –db PZ_MTEST –show</p>
<p>python -m wbia_cnn.ingest_data –test-grab_siam_dataset –db PZ_MTEST –show –nohud –nometa
python -m wbia_cnn.ingest_data –test-grab_siam_dataset –db liberty –show –nohud –nometa</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.ingest_data</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds_tag</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">grab_siam_dataset</span><span class="p">(</span><span class="n">ds_tag</span><span class="o">=</span><span class="n">ds_tag</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">draw_results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">ibs</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">getprop</span><span class="p">(</span><span class="s1">&#39;ibs&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">chunck_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_data.merge_datasets">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_data.</span></span><span class="sig-name descname"><span class="pre">merge_datasets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_data.html#merge_datasets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_data.merge_datasets" title="Permalink to this definition"></a></dt>
<dd><p>Merges a list of dataset objects into a single combined dataset.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_data.testdata_dataset">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_data.</span></span><span class="sig-name descname"><span class="pre">testdata_dataset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_data.html#testdata_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_data.testdata_dataset" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_data.testdata_patchmatch">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_data.</span></span><span class="sig-name descname"><span class="pre">testdata_patchmatch</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_data.html#testdata_patchmatch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_data.testdata_patchmatch" title="Permalink to this definition"></a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.ingest_data</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_data.testdata_patchmatch2">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_data.</span></span><span class="sig-name descname"><span class="pre">testdata_patchmatch2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_data.html#testdata_patchmatch2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_data.testdata_patchmatch2" title="Permalink to this definition"></a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.ingest_data</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_data.view_training_directories">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_data.</span></span><span class="sig-name descname"><span class="pre">view_training_directories</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_data.html#view_training_directories"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_data.view_training_directories" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.ingest_data –test-view_training_directories</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.ingest_data</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">view_training_directories</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-wbia_cnn.ingest_helpers">
<span id="wbia-cnn-ingest-helpers-module"></span><h2>wbia_cnn.ingest_helpers module<a class="headerlink" href="#module-wbia_cnn.ingest_helpers" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_helpers.convert_category_to_siam_data">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_helpers.</span></span><span class="sig-name descname"><span class="pre">convert_category_to_siam_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">category_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category_labels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_helpers.html#convert_category_to_siam_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_helpers.convert_category_to_siam_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_helpers.extract_liberty_style_patches">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_helpers.</span></span><span class="sig-name descname"><span class="pre">extract_liberty_style_patches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pairs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_helpers.html#extract_liberty_style_patches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_helpers.extract_liberty_style_patches" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.ingest_data –test-grab_cached_liberty_data –show</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_helpers.grab_mnist1">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_helpers.</span></span><span class="sig-name descname"><span class="pre">grab_mnist1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_helpers.html#grab_mnist1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_helpers.grab_mnist1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_helpers.grab_mnist2">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_helpers.</span></span><span class="sig-name descname"><span class="pre">grab_mnist2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_helpers.html#grab_mnist2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_helpers.grab_mnist2" title="Permalink to this definition"></a></dt>
<dd><p>Follows lasagne example</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_helpers.load_mnist_images">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_helpers.</span></span><span class="sig-name descname"><span class="pre">load_mnist_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gz_fpath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_helpers.html#load_mnist_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_helpers.load_mnist_images" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_helpers.load_mnist_labels">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_helpers.</span></span><span class="sig-name descname"><span class="pre">load_mnist_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gz_fpath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_helpers.html#load_mnist_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_helpers.load_mnist_labels" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_helpers.open_mnist_files">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_helpers.</span></span><span class="sig-name descname"><span class="pre">open_mnist_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_fpath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_helpers.html#open_mnist_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_helpers.open_mnist_files" title="Permalink to this definition"></a></dt>
<dd><p>For mnist1</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://g.sweyla.com/blog/2012/mnist-numpy/">http://g.sweyla.com/blog/2012/mnist-numpy/</a></p>
</dd></dl>

</section>
<section id="module-wbia_cnn.ingest_wbia">
<span id="wbia-cnn-ingest-wbia-module"></span><h2>wbia_cnn.ingest_wbia module<a class="headerlink" href="#module-wbia_cnn.ingest_wbia" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.PartMatchDataConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_wbia.</span></span><span class="sig-name descname"><span class="pre">PartMatchDataConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#PartMatchDataConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.PartMatchDataConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">wbia.dtool.base.Config</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.PartMatchDataConfig.get_data_shape">
<span class="sig-name descname"><span class="pre">get_data_shape</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#PartMatchDataConfig.get_data_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.PartMatchDataConfig.get_data_shape" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.PatchMetricDataConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_wbia.</span></span><span class="sig-name descname"><span class="pre">PatchMetricDataConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#PatchMetricDataConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.PatchMetricDataConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">wbia.dtool.base.Config</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.PatchMetricDataConfig.get_data_shape">
<span class="sig-name descname"><span class="pre">get_data_shape</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#PatchMetricDataConfig.get_data_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.PatchMetricDataConfig.get_data_shape" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.cached_part_match_training_data_fpaths">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_wbia.</span></span><span class="sig-name descname"><span class="pre">cached_part_match_training_data_fpaths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aid_pairs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_metadata</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#cached_part_match_training_data_fpaths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.cached_part_match_training_data_fpaths" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><dl class="simple">
<dt>python -m wbia_cnn –tf netrun –db PZ_MTEST </dt><dd><p>–acfg ctrl:pername=None,excluderef=False –ensuredata –show –datatype=siam-part –nocache-train –nocache-cnn</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.cached_patchmetric_training_data_fpaths">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_wbia.</span></span><span class="sig-name descname"><span class="pre">cached_patchmetric_training_data_fpaths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aid1_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aid2_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts1_m_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2_m_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata_lists</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#cached_patchmetric_training_data_fpaths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.cached_patchmetric_training_data_fpaths" title="Permalink to this definition"></a></dt>
<dd><p>todo use size in cfgstrings
kwargs is used for PatchMetricDataConfig</p>
<p>from wbia_cnn.ingest_wbia import *</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.estimate_data_bytes">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_wbia.</span></span><span class="sig-name descname"><span class="pre">estimate_data_bytes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#estimate_data_bytes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.estimate_data_bytes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.extract_annotpair_training_chips">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_wbia.</span></span><span class="sig-name descname"><span class="pre">extract_annotpair_training_chips</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aid_pairs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#extract_annotpair_training_chips"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.extract_annotpair_training_chips" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.ingest_wbia extract_annotpair_training_chips –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.ingest_wbia</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="kc">False</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ibs</span> <span class="o">=</span> <span class="n">wbia</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s1">&#39;PZ_Master1&#39;</span><span class="p">,</span> <span class="n">allow_newdir</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">acfg_name</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">((</span><span class="s1">&#39;--aidcfg&#39;</span><span class="p">,</span> <span class="s1">&#39;--acfg&#39;</span><span class="p">,</span> <span class="s1">&#39;-a&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>                                <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                <span class="n">default</span><span class="o">=</span><span class="s1">&#39;ctrl:pername=None,excluderef=False,contributor_contains=FlankHack&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">else</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ibs</span> <span class="o">=</span> <span class="n">wbia</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s1">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">allow_newdir</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">acfg_name</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">((</span><span class="s1">&#39;--aidcfg&#39;</span><span class="p">,</span> <span class="s1">&#39;--acfg&#39;</span><span class="p">,</span> <span class="s1">&#39;-a&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>                                 <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                 <span class="n">default</span><span class="o">=</span><span class="s1">&#39;ctrl:pername=None,excluderef=False,index=0:20:2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#ibs = wbia.opendb(defaultdb=&#39;PZ_FlankHack&#39;, allow_newdir=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aid_pairs</span><span class="p">,</span> <span class="n">label_list</span><span class="p">,</span> <span class="n">flat_metadata</span> <span class="o">=</span> <span class="n">get_aidpairs_partmatch</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">acfg_name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">aid_pairs</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">aid_pairs</span><span class="p">)</span> <span class="o">//</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--x&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#aid_pairs = aid_pairs[s]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#label_list = label_list[s]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#flat_metadata = dict([(key, val[s]) for key, val in flat_metadata.items()])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rchip1_list</span><span class="p">,</span> <span class="n">rchip2_list</span> <span class="o">=</span> <span class="n">extract_annotpair_training_chips</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_pairs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">draw_results</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interact</span> <span class="o">=</span> <span class="n">draw_results</span><span class="o">.</span><span class="n">interact_patches</span><span class="p">(</span><span class="n">label_list</span><span class="p">,</span> <span class="p">(</span><span class="n">rchip1_list</span><span class="p">,</span> <span class="n">rchip2_list</span><span class="p">),</span> <span class="n">flat_metadata</span><span class="p">,</span> <span class="n">chunck_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">ibs</span><span class="o">=</span><span class="n">ibs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.extract_orientation_chips">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_wbia.</span></span><span class="sig-name descname"><span class="pre">extract_orientation_chips</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gid_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#extract_orientation_chips"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.extract_orientation_chips" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.flatten_patch_data">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_wbia.</span></span><span class="sig-name descname"><span class="pre">flatten_patch_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aid1_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aid2_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts1_m_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2_m_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata_lists</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#flatten_patch_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.flatten_patch_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.get_aidpair_patchmatch_training_data">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_wbia.</span></span><span class="sig-name descname"><span class="pre">get_aidpair_patchmatch_training_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aid1_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aid2_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts1_m_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2_m_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata_lists</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorspace</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#get_aidpair_patchmatch_training_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.get_aidpair_patchmatch_training_data" title="Permalink to this definition"></a></dt>
<dd><p>FIXME: errors on get_aidpairs_and_matches(ibs, 1)</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.ingest_wbia –test-get_aidpair_patchmatch_training_data –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.ingest_wbia</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">wbia</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s1">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">allow_newdir</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">get_aidpairs_and_matches</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">aid1_list</span><span class="p">,</span> <span class="n">aid2_list</span><span class="p">,</span> <span class="n">kpts1_m_list</span><span class="p">,</span> <span class="n">kpts2_m_list</span><span class="p">,</span> <span class="n">fm_list</span><span class="p">,</span> <span class="n">metadata_lists</span><span class="p">)</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pmcfg</span> <span class="o">=</span> <span class="n">PatchMetricDataConfig</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch_size</span> <span class="o">=</span> <span class="n">pmcfg</span><span class="p">[</span><span class="s1">&#39;patch_size&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">colorspace</span> <span class="o">=</span> <span class="n">pmcfg</span><span class="p">[</span><span class="s1">&#39;colorspace&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">get_aidpair_patchmatch_training_data</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid1_list</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">aid2_list</span><span class="p">,</span> <span class="n">kpts1_m_list</span><span class="p">,</span> <span class="n">kpts2_m_list</span><span class="p">,</span> <span class="n">fm_list</span><span class="p">,</span> <span class="n">metadata_lists</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">patch_size</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aid1_list_</span><span class="p">,</span> <span class="n">aid2_list_</span><span class="p">,</span> <span class="n">warped_patch1_list</span><span class="p">,</span> <span class="n">warped_patch2_list</span><span class="p">,</span> <span class="n">flat_metadata</span> <span class="o">=</span> <span class="n">tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label_list</span> <span class="o">=</span> <span class="n">get_aidpair_training_labels</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid1_list_</span><span class="p">,</span> <span class="n">aid2_list_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">draw_results</span><span class="o">.</span><span class="n">interact_patches</span><span class="p">(</span><span class="n">label_list</span><span class="p">,</span> <span class="p">(</span><span class="n">warped_patch1_list</span><span class="p">,</span> <span class="n">warped_patch2_list</span><span class="p">),</span> <span class="n">flat_metadata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.get_aidpair_training_labels">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_wbia.</span></span><span class="sig-name descname"><span class="pre">get_aidpair_training_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aid1_list_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aid2_list_</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#get_aidpair_training_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.get_aidpair_training_labels" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>true in positions of matching, and false in positions of not matching</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.ingest_wbia</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">wbia</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s1">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">allow_newdir</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">get_aidpairs_and_matches</span><span class="p">(</span><span class="n">ibs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">aid1_list</span><span class="p">,</span> <span class="n">aid2_list</span><span class="p">)</span> <span class="o">=</span> <span class="n">tup</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aid1_list</span> <span class="o">=</span> <span class="n">aid1_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">aid1_list</span><span class="p">))]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aid2_list</span> <span class="o">=</span> <span class="n">aid2_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">min</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">aid2_list</span><span class="p">))]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="n">get_aidpair_training_labels</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid1_list</span><span class="p">,</span> <span class="n">aid2_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;labels = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">labels = np.array([1, 0, 0, ..., 0, 1, 0], dtype=np.int32)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.get_aidpairs_and_matches">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_wbia.</span></span><span class="sig-name descname"><span class="pre">get_aidpairs_and_matches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_examples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">controlled</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_featweight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acfg_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#get_aidpairs_and_matches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.get_aidpairs_and_matches" title="Permalink to this definition"></a></dt>
<dd><p>Gets data for training a patch match network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ibs</strong> (<em>IBEISController</em>) – ibeis controller object</p></li>
<li><p><strong>max_examples</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>num_top</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – (default = 3)</p></li>
<li><p><strong>controlled</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>patchmatch_tup = (aid1_list, aid2_list, kpts1_m_list,
kpts2_m_list, fm_list, metadata_lists)
aid pairs and matching keypoint pairs as well as the original index
of the feature matches</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl>
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.ingest_wbia get_aidpairs_and_matches –show
python -m wbia_cnn.ingest_wbia –test-get_aidpairs_and_matches –db PZ_Master0
python -m wbia_cnn.ingest_wbia –test-get_aidpairs_and_matches –db PZ_Master1 –acfg default –show
python -m wbia_cnn.ingest_wbia –test-get_aidpairs_and_matches –db PZ_MTEST –acfg ctrl:qindex=0:10 –show
python -m wbia_cnn.ingest_wbia –test-get_aidpairs_and_matches –db NNP_Master3</p>
<p>python -m wbia_cnn.ingest_wbia –test-get_aidpairs_and_matches –db PZ_MTEST –acfg default:is_known=True,qmin_pername=2,view=primary,species=primary,minqual=ok –show</p>
<p>python -m wbia_cnn.ingest_wbia –test-get_aidpairs_and_matches –db PZ_Master1 –acfg default:is_known=True,qmin_pername=2,view=primary,species=primary,minqual=ok –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.ingest_wbia</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">wbia</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s1">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">allow_newdir</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">acfg_name</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">((</span><span class="s1">&#39;--aidcfg&#39;</span><span class="p">,</span> <span class="s1">&#39;--acfg&#39;</span><span class="p">,</span> <span class="s1">&#39;-a&#39;</span><span class="p">,</span> <span class="s1">&#39;--acfg-name&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>                            <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                            <span class="n">default</span><span class="o">=</span><span class="s1">&#39;ctrl:qindex=0:10&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_examples</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_top</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">controlled</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">min_featweight</span> <span class="o">=</span> <span class="mf">.99</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patchmatch_tup</span> <span class="o">=</span> <span class="n">get_aidpairs_and_matches</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ibs</span><span class="p">,</span> <span class="n">max_examples</span><span class="o">=</span><span class="n">max_examples</span><span class="p">,</span> <span class="n">num_top</span><span class="o">=</span><span class="n">num_top</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">controlled</span><span class="o">=</span><span class="n">controlled</span><span class="p">,</span> <span class="n">min_featweight</span><span class="o">=</span><span class="n">min_featweight</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">acfg_name</span><span class="o">=</span><span class="n">acfg_name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">aid1_list</span><span class="p">,</span> <span class="n">aid2_list</span><span class="p">,</span> <span class="n">kpts1_m_list</span><span class="p">,</span> <span class="n">kpts2_m_list</span><span class="p">,</span> <span class="n">fm_list</span><span class="p">,</span> <span class="n">metadata_lists</span><span class="p">)</span> <span class="o">=</span> <span class="n">patchmatch_tup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Visualizing&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Visualize feature scores</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tup</span> <span class="o">=</span> <span class="n">flatten_patch_data</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ibs</span><span class="p">,</span> <span class="n">aid1_list</span><span class="p">,</span> <span class="n">aid2_list</span><span class="p">,</span> <span class="n">kpts1_m_list</span><span class="p">,</span> <span class="n">kpts2_m_list</span><span class="p">,</span> <span class="n">fm_list</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">metadata_lists</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span><span class="p">,</span> <span class="n">flat_metadata</span> <span class="o">=</span> <span class="n">tup</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fs</span> <span class="o">=</span> <span class="n">flat_metadata</span><span class="p">[</span><span class="s1">&#39;fs&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">ScoreNormalizer</span><span class="p">(</span><span class="n">adjust</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">bin_width</span><span class="o">=</span><span class="mf">.001</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Visualize parent matches</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_iter</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">aid1_list</span><span class="p">,</span> <span class="n">aid2_list</span><span class="p">,</span> <span class="n">kpts1_m_list</span><span class="p">,</span> <span class="n">kpts2_m_list</span><span class="p">,</span> <span class="n">fm_list</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_iter</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">InteractiveIter</span><span class="p">(</span><span class="n">_iter</span><span class="p">,</span> <span class="n">display_item</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia</span> <span class="kn">import</span> <span class="n">plottool</span> <span class="k">as</span> <span class="n">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia.viz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">aid1</span><span class="p">,</span> <span class="n">aid2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span> <span class="ow">in</span> <span class="n">_iter</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;aid2 = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">aid2</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;aid1 = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">aid1</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;len(fm) = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">wbia</span><span class="o">.</span><span class="n">viz</span><span class="o">.</span><span class="n">viz_matches</span><span class="o">.</span><span class="n">show_matches2</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid1</span><span class="p">,</span> <span class="n">aid2</span><span class="p">,</span> <span class="n">fm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kpts1</span><span class="o">=</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="o">=</span><span class="n">kpts2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pt</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.get_aidpairs_partmatch">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_wbia.</span></span><span class="sig-name descname"><span class="pre">get_aidpairs_partmatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acfg_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#get_aidpairs_partmatch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.get_aidpairs_partmatch" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.ingest_wbia –exec-get_aidpairs_partmatch</p>
</dd>
<dt>SeeAlso:</dt><dd><p>extract_annotpair_training_chips</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.ingest_wbia</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">wbia</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s1">&#39;PZ_Master1&#39;</span><span class="p">,</span> <span class="n">allow_newdir</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#ibs = wbia.opendb(defaultdb=&#39;PZ_MTEST&#39;, allow_newdir=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#ibs = wbia.opendb(defaultdb=&#39;PZ_FlankHack&#39;, allow_newdir=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">acfg_name</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">((</span><span class="s1">&#39;--aidcfg&#39;</span><span class="p">,</span> <span class="s1">&#39;--acfg&#39;</span><span class="p">,</span> <span class="s1">&#39;-a&#39;</span><span class="p">),</span>
<span class="gp">... </span>                            <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">default</span><span class="o">=</span><span class="s1">&#39;ctrl:pername=None,excluderef=False,contributor_contains=FlankHack&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aid_pairs</span><span class="p">,</span> <span class="n">label_list</span><span class="p">,</span> <span class="n">flat_metadata</span> <span class="o">=</span> <span class="n">get_aidpairs_partmatch</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">acfg_name</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.get_aoi2_training_data">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_wbia.</span></span><span class="sig-name descname"><span class="pre">get_aoi2_training_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">192</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_species_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_gid_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">purge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#get_aoi2_training_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.get_aoi2_training_data" title="Permalink to this definition"></a></dt>
<dd><p>Get data for bg</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.get_aoi_training_data">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_wbia.</span></span><span class="sig-name descname"><span class="pre">get_aoi_training_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_species_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">purge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#get_aoi_training_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.get_aoi_training_data" title="Permalink to this definition"></a></dt>
<dd><p>Get data for bg</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.get_background_training_patches2">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_wbia.</span></span><span class="sig-name descname"><span class="pre">get_background_training_patches2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">48</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annot_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patches_per_annotation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_gid_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visualize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visualize_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inside_boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">purge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supercharge_negative_multiplier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">undercharge_negative_multiplier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#get_background_training_patches2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.get_background_training_patches2" title="Permalink to this definition"></a></dt>
<dd><p>Get data for bg</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.get_cnn_classifier2_training_images">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_wbia.</span></span><span class="sig-name descname"><span class="pre">get_cnn_classifier2_training_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_gid_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">192</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">purge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#get_cnn_classifier2_training_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.get_cnn_classifier2_training_images" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.get_cnn_classifier_binary_training_images">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_wbia.</span></span><span class="sig-name descname"><span class="pre">get_cnn_classifier_binary_training_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">192</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">purge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_rate_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_rate_neg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#get_cnn_classifier_binary_training_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.get_cnn_classifier_binary_training_images" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.get_cnn_classifier_cameratrap_binary_training_images">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_wbia.</span></span><span class="sig-name descname"><span class="pre">get_cnn_classifier_cameratrap_binary_training_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positive_imageset_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_imageset_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">192</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">purge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_rate_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_rate_neg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#get_cnn_classifier_cameratrap_binary_training_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.get_cnn_classifier_cameratrap_binary_training_images" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.get_cnn_detector_training_images">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_wbia.</span></span><span class="sig-name descname"><span class="pre">get_cnn_detector_training_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#get_cnn_detector_training_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.get_cnn_detector_training_images" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.get_cnn_labeler_training_images">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_wbia.</span></span><span class="sig-name descname"><span class="pre">get_cnn_labeler_training_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_examples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">viewpoint_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">purge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#get_cnn_labeler_training_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.get_cnn_labeler_training_images" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.get_cnn_qualifier_training_images">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_wbia.</span></span><span class="sig-name descname"><span class="pre">get_cnn_qualifier_training_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">purge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#get_cnn_qualifier_training_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.get_cnn_qualifier_training_images" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.get_orientation_training_images">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_wbia.</span></span><span class="sig-name descname"><span class="pre">get_orientation_training_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#get_orientation_training_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.get_orientation_training_images" title="Permalink to this definition"></a></dt>
<dd><p>Gets data for training a patch match network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ibs</strong> (<em>IBEISController</em>) – ibeis controller object</p></li>
<li><p><strong>max_examples</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – (default = None)</p></li>
<li><p><strong>num_top</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – (default = 3)</p></li>
<li><p><strong>controlled</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – (default = True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>patchmatch_tup = (aid1_list, aid2_list, kpts1_m_list,
kpts2_m_list, fm_list, metadata_lists)
aid pairs and matching keypoint pairs as well as the original index
of the feature matches</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.ingest_wbia –test-get_orientation_training_images –dbdir /Datasets/BACKGROUND/PZ_Master1</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.ingest_wbia</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">wbia</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s1">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">allow_newdir</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_orientation_training_images</span><span class="p">(</span><span class="n">ibs</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.get_patchmetric_training_data_and_labels">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_wbia.</span></span><span class="sig-name descname"><span class="pre">get_patchmetric_training_data_and_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aid1_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aid2_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts1_m_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts2_m_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fm_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata_lists</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorspace</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#get_patchmetric_training_data_and_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.get_patchmetric_training_data_and_labels" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Notes</p>
<p># FIXME: THERE ARE INCORRECT CORRESPONDENCES LABELED AS CORRECT THAT
# NEED MANUAL CORRECTION EITHER THROUGH EXPLICIT LABLEING OR
# SEGMENTATION MASKS</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.ingest_wbia –test-get_patchmetric_training_data_and_labels –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.ingest_wbia</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ibs</span> <span class="o">=</span> <span class="n">wbia</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="n">defaultdb</span><span class="o">=</span><span class="s1">&#39;PZ_MTEST&#39;</span><span class="p">,</span> <span class="n">allow_newdir</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">aid1_list</span><span class="p">,</span> <span class="n">aid2_list</span><span class="p">,</span> <span class="n">kpts1_m_list</span><span class="p">,</span> <span class="n">kpts2_m_list</span><span class="p">,</span> <span class="n">fm_list</span><span class="p">,</span> <span class="n">metadata_lists</span><span class="p">)</span> <span class="o">=</span> <span class="n">get_aidpairs_and_matches</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pmcfg</span> <span class="o">=</span> <span class="n">PatchMetricDataConfig</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patch_size</span> <span class="o">=</span> <span class="n">pmcfg</span><span class="p">[</span><span class="s1">&#39;patch_size&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">colorspace</span> <span class="o">=</span> <span class="n">pmcfg</span><span class="p">[</span><span class="s1">&#39;colorspace&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">flat_metadata</span> <span class="o">=</span> <span class="n">get_patchmetric_training_data_and_labels</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">aid1_list</span><span class="p">,</span> <span class="n">aid2_list</span><span class="p">,</span> <span class="n">kpts1_m_list</span><span class="p">,</span> <span class="n">kpts2_m_list</span><span class="p">,</span> <span class="n">fm_list</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">metadata_lists</span><span class="p">,</span> <span class="n">patch_size</span><span class="p">,</span> <span class="n">colorspace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">draw_results</span><span class="o">.</span><span class="n">interact_siamsese_data_patches</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.mark_inconsistent_viewpoints">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_wbia.</span></span><span class="sig-name descname"><span class="pre">mark_inconsistent_viewpoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aid1_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aid2_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#mark_inconsistent_viewpoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.mark_inconsistent_viewpoints" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.ingest_wbia.remove_unknown_training_pairs">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.ingest_wbia.</span></span><span class="sig-name descname"><span class="pre">remove_unknown_training_pairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ibs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aid1_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aid2_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/ingest_wbia.html#remove_unknown_training_pairs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.ingest_wbia.remove_unknown_training_pairs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-wbia_cnn.lasagne_ext">
<span id="wbia-cnn-lasagne-ext-module"></span><h2>wbia_cnn.lasagne_ext module<a class="headerlink" href="#module-wbia_cnn.lasagne_ext" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.lasagne_ext.freeze_params">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.lasagne_ext.</span></span><span class="sig-name descname"><span class="pre">freeze_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/lasagne_ext.html#freeze_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.lasagne_ext.freeze_params" title="Permalink to this definition"></a></dt>
<dd><p>makes a layer untrainable</p>
<p class="rubric">References</p>
<p><a class="reference external" href="https://github.com/Lasagne/Lasagne/pull/261">https://github.com/Lasagne/Lasagne/pull/261</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.lasagne_ext.l1">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.lasagne_ext.</span></span><span class="sig-name descname"><span class="pre">l1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_biases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/lasagne_ext.html#l1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.lasagne_ext.l1" title="Permalink to this definition"></a></dt>
<dd><p>custom should move to regulariztion.lasagne.l1</p>
<p>NOT WORKING</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.lasagne_ext.siamese_loss">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.lasagne_ext.</span></span><span class="sig-name descname"><span class="pre">siamese_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y_padded</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_per_label=2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T=&lt;module</span> <span class="pre">'theano.tensor'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/theano/tensor/__init__.py'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/lasagne_ext.html#siamese_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.lasagne_ext.siamese_loss" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G</strong> – network output</p></li>
<li><p><strong>Y_padded</strong> – : target groundtruth labels (padded at the end with dummy values)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://www.cs.nyu.edu/~sumit/research/assets/cvpr05.pdf">https://www.cs.nyu.edu/~sumit/research/assets/cvpr05.pdf</a>
<a class="reference external" href="https://github.com/Lasagne/Lasagne/issues/168">https://github.com/Lasagne/Lasagne/issues/168</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.lasagne_ext –test-siamese_loss
# Train Network
python -m wbia_cnn.train –test-pz_patchmatch –vtd –max-examples=16 –batch_size=128 –learning_rate .0000001</p>
</dd>
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.lasagne_ext –test-siamese_loss</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.lasagne_ext</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># numpy testing but in reality these are theano functions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span><span class="p">,</span> <span class="n">Y_padded</span> <span class="o">=</span> <span class="n">testdata_contrastive_loss</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">abs_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg_loss</span> <span class="o">=</span> <span class="n">siamese_loss</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">Y_padded</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.lasagne_ext.testdata_contrastive_loss">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.lasagne_ext.</span></span><span class="sig-name descname"><span class="pre">testdata_contrastive_loss</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/lasagne_ext.html#testdata_contrastive_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.lasagne_ext.testdata_contrastive_loss" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-wbia_cnn.net_strs">
<span id="wbia-cnn-net-strs-module"></span><h2>wbia_cnn.net_strs module<a class="headerlink" href="#module-wbia_cnn.net_strs" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.net_strs.count_bytes">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.net_strs.</span></span><span class="sig-name descname"><span class="pre">count_bytes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_layer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/net_strs.html#count_bytes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.net_strs.count_bytes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.net_strs.get_layer_info">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.net_strs.</span></span><span class="sig-name descname"><span class="pre">get_layer_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/net_strs.html#get_layer_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.net_strs.get_layer_info" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>layer</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>layer_info</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><p>?</p>
</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.net_strs get_layer_info –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.net_strs</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">models</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">mnist</span><span class="o">.</span><span class="n">MNISTModel</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">data_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">output_dims</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nn_layers</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_all_layers</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">nn_layers</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">layer_info</span> <span class="o">=</span> <span class="n">get_layer_info</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">repr3</span><span class="p">(</span><span class="n">layer_info</span><span class="p">,</span> <span class="n">nl</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.net_strs.get_layer_info_str">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.net_strs.</span></span><span class="sig-name descname"><span class="pre">get_layer_info_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/net_strs.html#get_layer_info_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.net_strs.get_layer_info_str" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>output_layer</strong> (<em>lasagne.layers.Layer</em>) – </p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.net_strs –test-get_layer_info_str:0
python -m wbia_cnn.net_strs –test-get_layer_info_str:1</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.net_strs</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">models</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DummyModel</span><span class="p">(</span><span class="n">data_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">autoinit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">output_layer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">get_layer_info_str</span><span class="p">(</span><span class="n">output_layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">Network Structure:</span>
<span class="go"> index  Layer    Outputs    Bytes OutShape         Params</span>
<span class="go"> 0      Input      1,728   55,296 (8, 3, 24, 24)   []</span>
<span class="go"> 1      Conv2D     7,744  249,600 (8, 16, 22, 22)  [W(16,3,3,3, {t,r}), b(16, {t})]</span>
<span class="go"> 2      Conv2D     7,056  229,952 (8, 16, 21, 21)  [W(16,16,2,2, {t,r}), b(16, {t})]</span>
<span class="go"> 3      Dense          8  226,080 (8, 8)           [W(7056,8, {t,r}), b(8, {t})]</span>
<span class="go"> 4      Dense          5      340 (8, 5)           [W(8,5, {t,r}), b(5, {t})]</span>
<span class="go">...this model has 57,989 learnable parameters</span>
<span class="go">...this model will use 761,268 bytes = 743.43 KB</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.net_strs</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">models</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">mnist</span><span class="o">.</span><span class="n">MNISTModel</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">output_dims</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                <span class="n">data_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">output_layer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">get_layer_info_str</span><span class="p">(</span><span class="n">output_layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.net_strs.make_layer_json_dict">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.net_strs.</span></span><span class="sig-name descname"><span class="pre">make_layer_json_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_to_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/net_strs.html#make_layer_json_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.net_strs.make_layer_json_dict" title="Permalink to this definition"></a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.net_strs</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.net_strs.make_layer_str">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.net_strs.</span></span><span class="sig-name descname"><span class="pre">make_layer_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/net_strs.html#make_layer_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.net_strs.make_layer_str" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>layer</strong> (<em>lasagne.Layer</em>) – a network layer</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.net_strs.make_layers_json">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.net_strs.</span></span><span class="sig-name descname"><span class="pre">make_layers_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/net_strs.html#make_layers_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.net_strs.make_layers_json" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.net_strs.param_basename">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.net_strs.</span></span><span class="sig-name descname"><span class="pre">param_basename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/net_strs.html#param_basename"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.net_strs.param_basename" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.net_strs.paramstr">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.net_strs.</span></span><span class="sig-name descname"><span class="pre">paramstr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/net_strs.html#paramstr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.net_strs.paramstr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.net_strs.print_layer_info">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.net_strs.</span></span><span class="sig-name descname"><span class="pre">print_layer_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_layer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/net_strs.html#print_layer_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.net_strs.print_layer_info" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.net_strs.print_pretrained_weights">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.net_strs.</span></span><span class="sig-name descname"><span class="pre">print_pretrained_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pretrained_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/net_strs.html#print_pretrained_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.net_strs.print_pretrained_weights" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pretrained_weights</strong> (<em>list of ndarrays</em>) – represents layer weights</p></li>
<li><p><strong>lbl</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – label</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.net_strs.shapestr">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.net_strs.</span></span><span class="sig-name descname"><span class="pre">shapestr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/net_strs.html#shapestr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.net_strs.shapestr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.net_strs.surround">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.net_strs.</span></span><span class="sig-name descname"><span class="pre">surround</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">str_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'{}'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/net_strs.html#surround"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.net_strs.surround" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.net_strs.tagstr">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.net_strs.</span></span><span class="sig-name descname"><span class="pre">tagstr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tags</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/net_strs.html#tagstr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.net_strs.tagstr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-wbia_cnn.netrun">
<span id="wbia-cnn-netrun-module"></span><h2>wbia_cnn.netrun module<a class="headerlink" href="#module-wbia_cnn.netrun" title="Permalink to this headline"></a></h2>
<dl>
<dt>FIXME:</dt><dd><p>sometimes you have to chown -R user:user ~/.theano or run with sudo the
first time after roboot, otherwise you get errors</p>
</dd>
<dt>CommandLineHelp:</dt><dd><p>python -m wbia_cnn –tf netrun &lt;networkmodel&gt;</p>
<p>–dataset, –ds = &lt;dstag&gt;:&lt;subtag&gt;
dstag is the main dataset name (eg PZ_MTEST), subtag are parameters to
modify (max_examples=3)</p>
<p>–weights, -w = |new|&lt;checkpoint_tag&gt;|&lt;dstag&gt;:&lt;checkpoint_tag&gt; (default: &lt;checkpoint_tag&gt;)
new will initialize clean weights.
a checkpoint tag will try to to match a saved model state in the history.
can load weights from an external dataset.
&lt;checkpoint_tag&gt; defaults to current</p>
<p>–arch, -a = &lt;archtag&gt;
model architecture tag (eg siaml2_128, siam2stream, viewpoint)</p>
<p>–device = &lt;processor&gt;
sets theano device flag to a processor like gpu0, gpu1, or cpu0</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.netrun.merge_ds_tags">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.netrun.</span></span><span class="sig-name descname"><span class="pre">merge_ds_tags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds_alias_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/netrun.html#merge_ds_tags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.netrun.merge_ds_tags" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn –tf merge_ds_tags –alias-list gz-gray girm pzmtest nnp</p>
</dd>
</dl>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/18492273/combining-hdf5-files">http://stackoverflow.com/questions/18492273/combining-hdf5-files</a></p>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.netrun</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds_alias_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--alias-list&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">merge_ds_tags</span><span class="p">(</span><span class="n">ds_alias_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.netrun.netrun">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.netrun.</span></span><span class="sig-name descname"><span class="pre">netrun</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/netrun.html#netrun"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.netrun.netrun" title="Permalink to this definition"></a></dt>
<dd><dl>
<dt>CommandLine:</dt><dd><p># — UTILITY
python -m wbia_cnn –tf get_juction_dpath –show</p>
<p># — DATASET BUILDING —
# Build Dataset Aliases
python -m wbia_cnn –tf netrun –db PZ_MTEST –acfg ctrl –ensuredata –show
python -m wbia_cnn –tf netrun –db PZ_Master1 –acfg timectrl –ensuredata
python -m wbia_cnn –tf netrun –db PZ_Master1 –acfg timectrl:pername=None –ensuredata
python -m wbia_cnn –tf netrun –db PZ_Master1 –acfg timectrl:pername=None –ensuredata
python -m wbia_cnn –tf netrun –db mnist –ensuredata –show
python -m wbia_cnn –tf netrun –db mnist –ensuredata –show –datatype=category
python -m wbia_cnn –tf netrun –db mnist –ensuredata –show –datatype=siam-patch</p>
<p>python -m wbia_cnn –tf netrun –db PZ_Master1 –acfg ctrl:pername=None,excluderef=False,contributor_contains=FlankHack –ensuredata –show –datatype=siam-part</p>
<p># Parts based datasets
python -m wbia_cnn –tf netrun –db PZ_MTEST –acfg ctrl –datatype=siam-part –ensuredata –show</p>
<p># Patch based dataset (big one)
python -m wbia_cnn –tf netrun –db PZ_Master1 –acfg default:is_known=True,qmin_pername=2,view=primary,species=primary,minqual=ok –ensuredata –show –vtd
python -m wbia_cnn –tf netrun –ds pzm4 –weights=new –arch=siaml2_128 –train –monitor
python -m wbia_cnn –tf netrun –ds pzm4 –arch=siaml2_128 –test
python -m wbia_cnn –tf netrun –ds pzm4 –arch=siaml2_128 –veryverbose –no-flask</p>
<p># — TRAINING —
python -m wbia_cnn –tf netrun –db PZ_Master1 –acfg default:is_known=True,qmin_pername=2,view=primary,species=primary,minqual=ok –weights=new –arch=siaml2_128 –train –monitor</p>
<p>python -m wbia_cnn –tf netrun –ds timectrl_pzmaster1 –acfg ctrl:pername=None,excluderef=False,contributor_contains=FlankHack –train –weights=new –arch=siaml2_128  –monitor  # NOQA
python -m wbia_cnn –tf netrun –ds timectrl_pzmaster1 –acfg ctrl:pername=None,excluderef=False –train –weights=new –arch=siaml2_128  –monitor  # NOQA
python -m wbia_cnn –tf netrun –ds pzmtest –weights=new –arch=siaml2_128 –train –monitor –DEBUG_AUGMENTATION
python -m wbia_cnn –tf netrun –ds pzmtest –weights=new –arch=siaml2_128 –train –monitor</p>
<p>python -m wbia_cnn –tf netrun –ds flankhack –weights=new –arch=siaml2_partmatch –train –monitor –learning_rate=.00001
python -m wbia_cnn –tf netrun –ds flankhack –weights=new –arch=siam_deepfaceish –train –monitor –learning_rate=.00001</p>
<p># Different ways to train mnist
python -m wbia_cnn –tf netrun –db mnist –weights=new –arch=mnist_siaml2 –train –monitor –datatype=siam-patch
python -m wbia_cnn –tf netrun –db mnist –weights=new –arch=mnist-category –train –monitor –datatype=category</p>
<p># — INITIALIZED-TRAINING —
python -m wbia_cnn –tf netrun –ds pzmtest –arch=siaml2_128 –weights=gz-gray:current –train –monitor</p>
<p># — TESTING —
python -m wbia_cnn –tf netrun –db liberty –weights=liberty:current –arch=siaml2_128 –test
python -m wbia_cnn –tf netrun –db PZ_Master0 –weights=combo:current –arch=siaml2_128 –testall</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.netrun</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">netrun</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.netrun.parse_args">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.netrun.</span></span><span class="sig-name descname"><span class="pre">parse_args</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/netrun.html#parse_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.netrun.parse_args" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-wbia_cnn.process">
<span id="wbia-cnn-process-module"></span><h2>wbia_cnn.process module<a class="headerlink" href="#module-wbia_cnn.process" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.process.numpy_processed_directory">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.process.</span></span><span class="sig-name descname"><span class="pre">numpy_processed_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">project_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numpy_ids_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ids.npy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numpy_x_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'X.npy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numpy_y_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'y.npy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'labels.csv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/process.html#numpy_processed_directory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.process.numpy_processed_directory" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.process.numpy_processed_directory2">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.process.</span></span><span class="sig-name descname"><span class="pre">numpy_processed_directory2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extracted_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numpy_ids_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ids.npy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numpy_x_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'X.npy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numpy_y_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'y.npy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'labels.csv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/process.html#numpy_processed_directory2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.process.numpy_processed_directory2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.process.numpy_processed_directory3">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.process.</span></span><span class="sig-name descname"><span class="pre">numpy_processed_directory3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extracted_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numpy_ids_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ids.npy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numpy_x_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'X.npy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numpy_y_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'y.npy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'labels.csv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categories_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'categories.csv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/process.html#numpy_processed_directory3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.process.numpy_processed_directory3" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.process.numpy_processed_directory4">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.process.</span></span><span class="sig-name descname"><span class="pre">numpy_processed_directory4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extracted_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numpy_ids_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ids.npy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numpy_x_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'X.npy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numpy_y_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'y.npy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'labels.csv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/process.html#numpy_processed_directory4"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.process.numpy_processed_directory4" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.process.numpy_processed_directory5">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.process.</span></span><span class="sig-name descname"><span class="pre">numpy_processed_directory5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extracted_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numpy_ids_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ids.npy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numpy_x_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'X.npy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numpy_y_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'y.npy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'labels.csv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/process.html#numpy_processed_directory5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.process.numpy_processed_directory5" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.process.process_image_directory">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.process.</span></span><span class="sig-name descname"><span class="pre">process_image_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">project_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/process.html#process_image_directory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.process.process_image_directory" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.process.view_numpy_data">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.process.</span></span><span class="sig-name descname"><span class="pre">view_numpy_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">project_namel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numpy_x_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'X.npy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numpy_y_file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'y.npy'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/process.html#view_numpy_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.process.view_numpy_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-wbia_cnn.sandbox">
<span id="wbia-cnn-sandbox-module"></span><h2>wbia_cnn.sandbox module<a class="headerlink" href="#module-wbia_cnn.sandbox" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.sandbox.check_external_training_paths">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.sandbox.</span></span><span class="sig-name descname"><span class="pre">check_external_training_paths</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/sandbox.html#check_external_training_paths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.sandbox.check_external_training_paths" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Notes</p>
<p><a class="reference external" href="http://cs231n.github.io/neural-networks-3/#distr">http://cs231n.github.io/neural-networks-3/#distr</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.sandbox.convert_old_weights">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.sandbox.</span></span><span class="sig-name descname"><span class="pre">convert_old_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/sandbox.html#convert_old_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.sandbox.convert_old_weights" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.sandbox.grab_model_from_dozer">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.sandbox.</span></span><span class="sig-name descname"><span class="pre">grab_model_from_dozer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/sandbox.html#grab_model_from_dozer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.sandbox.grab_model_from_dozer" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.sandbox.load_tmp_model">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.sandbox.</span></span><span class="sig-name descname"><span class="pre">load_tmp_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/sandbox.html#load_tmp_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.sandbox.load_tmp_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.sandbox.theano_gradient_funtimes">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.sandbox.</span></span><span class="sig-name descname"><span class="pre">theano_gradient_funtimes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/sandbox.html#theano_gradient_funtimes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.sandbox.theano_gradient_funtimes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-wbia_cnn.test">
<span id="wbia-cnn-test-module"></span><h2>wbia_cnn.test module<a class="headerlink" href="#module-wbia_cnn.test" title="Permalink to this headline"></a></h2>
<p>tests a test set of data using a specified, pre0trained model and weights</p>
<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.test.test">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.test.</span></span><span class="sig-name descname"><span class="pre">test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_dpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_fpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/test.html#test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.test.test" title="Permalink to this definition"></a></dt>
<dd><p>Driver function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_fpath</strong> – </p></li>
<li><p><strong>labels_fpath</strong> – </p></li>
<li><p><strong>model</strong> – </p></li>
<li><p><strong>weights_fpath</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-wbia_cnn.theano_ext">
<span id="wbia-cnn-theano-ext-module"></span><h2>wbia_cnn.theano_ext module<a class="headerlink" href="#module-wbia_cnn.theano_ext" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.theano_ext.eval_symbol">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.theano_ext.</span></span><span class="sig-name descname"><span class="pre">eval_symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs_to_value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/theano_ext.html#eval_symbol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.theano_ext.eval_symbol" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.theano_ext.get_symbol_inputs">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.theano_ext.</span></span><span class="sig-name descname"><span class="pre">get_symbol_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/theano_ext.html#get_symbol_inputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.theano_ext.get_symbol_inputs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-wbia_cnn.utils">
<span id="wbia-cnn-utils-module"></span><h2>wbia_cnn.utils module<a class="headerlink" href="#module-wbia_cnn.utils" title="Permalink to this headline"></a></h2>
<p>TODO: depricate this file eventually when geral model and dataset structure is
fully setup</p>
<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.utils.add_channels">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.utils.</span></span><span class="sig-name descname"><span class="pre">add_channels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/utils.html#add_channels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.utils.add_channels" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.utils.checkfreq">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.utils.</span></span><span class="sig-name descname"><span class="pre">checkfreq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqlike_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/utils.html#checkfreq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.utils.checkfreq" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.utils.convert_cv2_images_to_theano_images">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.utils.</span></span><span class="sig-name descname"><span class="pre">convert_cv2_images_to_theano_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/utils.html#convert_cv2_images_to_theano_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.utils.convert_cv2_images_to_theano_images" title="Permalink to this definition"></a></dt>
<dd><p>Converts b01c to bc01</p>
<p>Converts a list of cv2-style images into a single numpy array of nonflat
theano-style images.</p>
<p>h=height, w=width, b=batchid, c=channel</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>img_list</strong> (<em>list of ndarrays</em>) – a list of numpy arrays with shape [h, w, c]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>in the shape [b, (c x h x w)]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>data</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.utils –test-convert_cv2_images_to_theano_images</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.utils</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vtool</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">channels</span> <span class="o">=</span> <span class="n">testdata_imglist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">convert_cv2_images_to_theano_images</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">img_list</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#result = str(np.transpose(subset, (1, 2, 0)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">subset</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[[[  0   3]  [ 96  99]] [[  1   4]  [ 97 100]] [[  2   5]  [ 98 101]]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.utils.convert_theano_images_to_cv2_images">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.utils.</span></span><span class="sig-name descname"><span class="pre">convert_theano_images_to_cv2_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/utils.html#convert_theano_images_to_cv2_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.utils.convert_theano_images_to_cv2_images" title="Permalink to this definition"></a></dt>
<dd><p>Converts bc01 to b01c</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>ndarray</em>) – in the shape [b, (c x h x w)]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list of numpy arrays with shape [h, w, c]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>img_list (list of ndarrays)</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.utils –test-convert_data_to_imglist</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.utils</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">channels</span> <span class="o">=</span> <span class="n">testdata_imglist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">convert_cv2_images_to_theano_images</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">img_list</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_list2</span> <span class="o">=</span> <span class="n">convert_theano_images_to_cv2_images</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">img_list</span> <span class="o">==</span> <span class="n">img_list2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.utils.data_label_shuffle">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.utils.</span></span><span class="sig-name descname"><span class="pre">data_label_shuffle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_per_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/utils.html#data_label_shuffle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.utils.data_label_shuffle" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.utils –test-data_label_shuffle</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.utils</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">data_per_label</span> <span class="o">=</span> <span class="n">testdata_xy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_per_label</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">data_label_shuffle</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">data_per_label</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.utils.evaluate_symbolic_layer">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.utils.</span></span><span class="sig-name descname"><span class="pre">evaluate_symbolic_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">get_output_for</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputdata_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/utils.html#evaluate_symbolic_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.utils.evaluate_symbolic_layer" title="Permalink to this definition"></a></dt>
<dd><p>helper for testing lasagne layers</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.utils.expand_data_indicies">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.utils.</span></span><span class="sig-name descname"><span class="pre">expand_data_indicies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_per_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/utils.html#expand_data_indicies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.utils.expand_data_indicies" title="Permalink to this definition"></a></dt>
<dd><p>when data_per_label &gt; 1, gives the corresponding data indicies for the data
indicies</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.utils.extract_patches_stride">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.utils.</span></span><span class="sig-name descname"><span class="pre">extract_patches_stride</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/utils.html#extract_patches_stride"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.utils.extract_patches_stride" title="Permalink to this definition"></a></dt>
<dd><p>Using the input image, take a strided sampling of patches from the image</p>
<p>The patches are extracted (cropped copies) using the patch_size and stride.
If the patch size and stride do not evenly cover the source image in width
or height, the fractional border is strided explicitly, meaning that the
final row or column will fit precicely against the image border.  As a
result, the final row and column will most likely have more overlap with the
penultimate row and column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><em>numpy.ndarray</em></a>) – the image that the patches will be extracted from</p></li>
<li><p><strong>patch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>tuple of int</em>) – the size of the patches to be extracted</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>tuple of int</em>) – the stride to be used when extracting the
patches.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of image patches extracted and a list of the coordinates
from the original image space where each patch was extracted.  The
coordinates are in the form of a 4-tuple, (top left x, top left y,
bottom right x, bottom right y).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>patch_list, coord_list (list of numpy.ndarray, list of tuple of int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.utils.float32">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.utils.</span></span><span class="sig-name descname"><span class="pre">float32</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/utils.html#float32"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.utils.float32" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.utils.get_current_time">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.utils.</span></span><span class="sig-name descname"><span class="pre">get_current_time</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/utils.html#get_current_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.utils.get_current_time" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.utils.get_printcolinfo">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.utils.</span></span><span class="sig-name descname"><span class="pre">get_printcolinfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requested_headers_</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/utils.html#get_printcolinfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.utils.get_printcolinfo" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.utils</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">requested_headers</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">printcol_info</span> <span class="o">=</span> <span class="n">get_printcolinfo</span><span class="p">(</span><span class="n">requested_headers</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.utils.load">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.utils.</span></span><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_fpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/utils.html#load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.utils.load" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.utils.make_random_indicies">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.utils.</span></span><span class="sig-name descname"><span class="pre">make_random_indicies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/utils.html#make_random_indicies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.utils.make_random_indicies" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – </p></li>
<li><p><strong>seed</strong> (<em>hashable</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>random_indicies</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.utils –test-make_random_indicies</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.utils</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random_indicies</span> <span class="o">=</span> <span class="n">make_random_indicies</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">random_indicies</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[8 1 5 0 7 2 9 4 3 6]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.utils.multinomial_nll">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.utils.</span></span><span class="sig-name descname"><span class="pre">multinomial_nll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/utils.html#multinomial_nll"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.utils.multinomial_nll" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.utils.print_epoch_info">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.utils.</span></span><span class="sig-name descname"><span class="pre">print_epoch_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">printcol_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch_info</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/utils.html#print_epoch_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.utils.print_epoch_info" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.utils.print_header_columns">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.utils.</span></span><span class="sig-name descname"><span class="pre">print_header_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">printcol_info</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/utils.html#print_header_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.utils.print_header_columns" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.utils.random_xy_sample">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.utils.</span></span><span class="sig-name descname"><span class="pre">random_xy_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_per_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/utils.html#random_xy_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.utils.random_xy_sample" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.utils.save_model">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.utils.</span></span><span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwargs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/utils.html#save_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.utils.save_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.utils.save_pretrained_weights_slice">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.utils.</span></span><span class="sig-name descname"><span class="pre">save_pretrained_weights_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pretrained_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">slice(None,</span> <span class="pre">None,</span> <span class="pre">None)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/utils.html#save_pretrained_weights_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.utils.save_pretrained_weights_slice" title="Permalink to this definition"></a></dt>
<dd><p>Used to save a slice of pretrained weights. The doctest will publish a new set of weights</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.utils –test-save_pretrained_weights_slice –net=’vggnet_full’ –slice=’slice(0,6)’
python -m wbia_cnn.utils –test-save_pretrained_weights_slice –net=’vggnet_full’ –slice=’slice(0,30)’
python -m wbia_cnn.utils –test-save_pretrained_weights_slice –net=’caffenet_full’ –slice=’slice(0,6)’
python -m wbia_cnn.utils –test-save_pretrained_weights_slice –net=’caffenet_full’ –slice=’slice(0,?)’</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Build a new subset of an existing model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn._plugin_grabmodels</span> <span class="kn">import</span> <span class="n">ensure_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get base model weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modelname</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--net&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;vggnet_full&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights_path</span> <span class="o">=</span> <span class="n">ensure_model</span><span class="p">(</span><span class="n">modelname</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pretrained_weights</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">load_cPkl</span><span class="p">(</span><span class="n">weights_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get the slice you want</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">slice_str</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--slice&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;slice(0, 6)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">slice_</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">slice_str</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="nb">locals</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sliced_weights_path</span> <span class="o">=</span> <span class="n">save_pretrained_weights_slice</span><span class="p">(</span><span class="n">pretrained_weights</span><span class="p">,</span> <span class="n">weights_path</span><span class="p">,</span> <span class="n">slice_</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># PUT YOUR PUBLISH PATH HERE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">publish_fpath</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">truepath</span><span class="p">(</span><span class="s1">&#39;~/Dropbox/IBEIS&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">sliced_weights_path</span><span class="p">,</span> <span class="n">publish_fpath</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.utils.shock_network">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.utils.</span></span><span class="sig-name descname"><span class="pre">shock_network</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voltage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/utils.html#shock_network"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.utils.shock_network" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.utils.show_image_from_data">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.utils.</span></span><span class="sig-name descname"><span class="pre">show_image_from_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/utils.html#show_image_from_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.utils.show_image_from_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.utils.slice_data_labels">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.utils.</span></span><span class="sig-name descname"><span class="pre">slice_data_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_per_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wraparound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/utils.html#slice_data_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.utils.slice_data_labels" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.utils –test-slice_data_labels</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.utils</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">67</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">67</span><span class="p">)</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_index</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_per_label</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wraparound</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">slice_data_labels</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">batch_index</span><span class="p">,</span> <span class="n">data_per_label</span><span class="p">,</span> <span class="n">wraparound</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Xb</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(32, 3, 5, 4)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.utils.testdata_imglist">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.utils.</span></span><span class="sig-name descname"><span class="pre">testdata_imglist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(32,</span> <span class="pre">32,</span> <span class="pre">3)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/utils.html#testdata_imglist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.utils.testdata_imglist" title="Permalink to this definition"></a></dt>
<dd><p>Returns 4 colored 32x32 test images, one is structured increasing numbers,
an images with lines of a cartoon face, and two complex images of people.</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.utils –test-testdata_imglist –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.utils</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">channels</span><span class="p">)</span> <span class="o">=</span> <span class="n">testdata_imglist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia</span> <span class="kn">import</span> <span class="n">plottool</span> <span class="k">as</span> <span class="n">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_list</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_list</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">pnum</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.utils.testdata_xy">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.utils.</span></span><span class="sig-name descname"><span class="pre">testdata_xy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_per_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/utils.html#testdata_xy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.utils.testdata_xy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.utils.train_test_split">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.utils.</span></span><span class="sig-name descname"><span class="pre">train_test_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_per_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/utils.html#train_test_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.utils.train_test_split" title="Permalink to this definition"></a></dt>
<dd><p>used to split datasets into two parts.
Preserves class distributions using Stratified K-Fold sampling</p>
<p>DEPRICATE : prefer the one implemented in dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>y</strong> (<em>ndarray</em>) – </p></li>
<li><p><strong>eval_size</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(X_train, y_train, X_valid, y_valid)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.utils –test-train_test_split</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.utils</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">data_per_label</span> <span class="o">=</span> <span class="n">testdata_xy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eval_size</span> <span class="o">=</span> <span class="mf">.2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">)</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">eval_size</span><span class="p">,</span> <span class="n">data_per_label</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># verify results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-wbia_cnn">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-wbia_cnn" title="Permalink to this headline"></a></h2>
<dl class="py data">
<dt class="sig sig-object py" id="wbia_cnn.IMPORT_TUPLES">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.</span></span><span class="sig-name descname"><span class="pre">IMPORT_TUPLES</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[('ibsplugin',</span> <span class="pre">None),</span> <span class="pre">('models',</span> <span class="pre">None),</span> <span class="pre">('process',</span> <span class="pre">None),</span> <span class="pre">('netrun',</span> <span class="pre">None),</span> <span class="pre">('utils',</span> <span class="pre">None)]</span></em><a class="headerlink" href="#wbia_cnn.IMPORT_TUPLES" title="Permalink to this definition"></a></dt>
<dd><p>Regen Command:
cd /home/joncrall/code/wbia_cnn/wbia_cnn
makeinit.py -x _grave old_test old_models old_main</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.reassign_submodule_attributes">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.</span></span><span class="sig-name descname"><span class="pre">reassign_submodule_attributes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn.html#reassign_submodule_attributes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.reassign_submodule_attributes" title="Permalink to this definition"></a></dt>
<dd><p>why reloading all the modules doesnt do this I don’t know</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.reload_subs">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.</span></span><span class="sig-name descname"><span class="pre">reload_subs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn.html#reload_subs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.reload_subs" title="Permalink to this definition"></a></dt>
<dd><p>Reloads wbia_cnn and submodules</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.rrrr">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.</span></span><span class="sig-name descname"><span class="pre">rrrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.rrrr" title="Permalink to this definition"></a></dt>
<dd><p>Reloads wbia_cnn and submodules</p>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to wbia_cnn’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="wbia_cnn.models.html" class="btn btn-neutral float-right" title="wbia_cnn.models package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Wild Me.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>