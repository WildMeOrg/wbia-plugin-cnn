
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>wbia_cnn.models package &#8212; wbia-cnn 3.3.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="wbia_cnn package" href="wbia_cnn.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="wbia-cnn-models-package">
<h1>wbia_cnn.models package<a class="headerlink" href="#wbia-cnn-models-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-wbia_cnn.models._model_legacy">
<span id="wbia-cnn-models-model-legacy-module"></span><h2>wbia_cnn.models._model_legacy module<a class="headerlink" href="#module-wbia_cnn.models._model_legacy" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="wbia_cnn.models._model_legacy._ModelLegacy">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models._model_legacy.</code><code class="sig-name descname">_ModelLegacy</code><a class="reference internal" href="_modules/wbia_cnn/models/_model_legacy.html#_ModelLegacy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models._model_legacy._ModelLegacy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>contains old functions for backwards compatibility
that may be eventually be depricated</p>
<dl class="py method">
<dt id="wbia_cnn.models._model_legacy._ModelLegacy._fix_center_mean_std">
<code class="sig-name descname">_fix_center_mean_std</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/_model_legacy.html#_ModelLegacy._fix_center_mean_std"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models._model_legacy._ModelLegacy._fix_center_mean_std" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models._model_legacy._ModelLegacy.load_old_weights_kw">
<code class="sig-name descname">load_old_weights_kw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">old_weights_fpath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/_model_legacy.html#_ModelLegacy.load_old_weights_kw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models._model_legacy._ModelLegacy.load_old_weights_kw" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models._model_legacy._ModelLegacy.load_old_weights_kw2">
<code class="sig-name descname">load_old_weights_kw2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">old_weights_fpath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/_model_legacy.html#_ModelLegacy.load_old_weights_kw2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models._model_legacy._ModelLegacy.load_old_weights_kw2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models._model_legacy._ModelLegacy.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models._model_legacy._ModelLegacy.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-wbia_cnn.models.abstract_models">
<span id="wbia-cnn-models-abstract-models-module"></span><h2>wbia_cnn.models.abstract_models module<a class="headerlink" href="#module-wbia_cnn.models.abstract_models" title="Permalink to this headline">¶</a></h2>
<p>Directory structure of training</p>
<p>The network directory is the root of the structure and is typically in
_ibeis_cache/nets for ibeis databases. Otherwise it it custom defined (like in
.cache/wbia_cnn/training for mnist tests)</p>
<p># era=(group of epochs)</p>
<div class="section" id="netdir-training-dpath">
<h3><a href="#id1"><span class="problematic" id="id2">|</span></a>– netdir &lt;training_dpath&gt;<a class="headerlink" href="#netdir-training-dpath" title="Permalink to this headline">¶</a></h3>
<p>Datasets contain ingested data packed into a single file for quick loading.
Data can be presplit into testing /  learning / validation sets.  Metadata is
always a dictionary where keys specify columns and each item corresponds a row
of data. Non-corresponding metadata is currently not supported, but should
probably be located in a manifest.json file.</p>
<p># TODO: what is the same data has tasks that use different labels?
# need to incorporate that structure.</p>
<dl class="simple">
<dt>The model directory must keep track of several things:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>The network architecture (which may depend on the dataset being used)</dt><dd><ul>
<li><p>input / output shape</p></li>
<li><p>network layers</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>The state of learning</dt><dd><ul>
<li><p>epoch/era number</p></li>
<li><p>learning rate</p></li>
<li><p>regularization rate</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>diagnostic information</dt><dd><ul>
<li><p>graphs of loss / error rates</p></li>
<li><p>images of convolutional weights</p></li>
<li><p>other visualizations</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<p>The trained model keeps track of the trained weights and is now independant of
the dataset. Finalized weights should be copied to and loaded from here.</p>
<div class="line-block">
<div class="line">|   |   <a href="#id3"><span class="problematic" id="id4">|</span></a>– full</div>
<div class="line">|   |   |   <a href="#id5"><span class="problematic" id="id6">|</span></a>– {dataset_id}_data.pkl</div>
<div class="line">|   |   |   <a href="#id7"><span class="problematic" id="id8">|</span></a>– {dataset_id}_labels.pkl</div>
<div class="line">|   |   |   <a href="#id9"><span class="problematic" id="id10">|</span></a>– {dataset_id}_labels_{task1}.pkl?</div>
<div class="line">|   |   |   <a href="#id11"><span class="problematic" id="id12">|</span></a>– {dataset_id}_labels_{task2}.pkl?</div>
<div class="line">|   |   |   <a href="#id13"><span class="problematic" id="id14">|</span></a>– {dataset_id}_metadata.pkl</div>
<div class="line">|   |   <a href="#id15"><span class="problematic" id="id16">|</span></a>– splits</div>
<div class="line">|   |   |   <a href="#id17"><span class="problematic" id="id18">|</span></a>– {split_id}_{num} *</div>
<div class="line">|   |   |   |   <a href="#id19"><span class="problematic" id="id20">|</span></a>– {dataset_id}_{split_id}_data.pkl</div>
<div class="line">|   |   |   |   <a href="#id21"><span class="problematic" id="id22">|</span></a>– {dataset_id}_{split_id}_labels.pkl</div>
<div class="line">|   |   |   |   <a href="#id23"><span class="problematic" id="id24">|</span></a>– {dataset_id}_{split_id}_metadata.pkl</div>
<div class="line">|   |   <a href="#id25"><span class="problematic" id="id26">|</span></a>– models</div>
<div class="line">|   |   |   <a href="#id27"><span class="problematic" id="id28">|</span></a>– arch_{archid} *</div>
<div class="line">|   |   |   |   <a href="#id29"><span class="problematic" id="id30">|</span></a>– best_results</div>
<div class="line">|   |   |   |   |   <a href="#id31"><span class="problematic" id="id32">|</span></a>– model_state.pkl</div>
<div class="line">|   |   |   |   <a href="#id33"><span class="problematic" id="id34">|</span></a>– checkpoints</div>
<div class="line">|   |   |   |   |   <a href="#id35"><span class="problematic" id="id36">|</span></a>– {history_id} *</div>
<div class="line">|   |   |   |   |   |    <a href="#id37"><span class="problematic" id="id38">|</span></a>– model_history.pkl</div>
<div class="line">|   |   |   |   |   |    <a href="#id39"><span class="problematic" id="id40">|</span></a>– model_state.pkl</div>
<div class="line">|   |   |   |   <a href="#id41"><span class="problematic" id="id42">|</span></a>– progress</div>
<div class="line">|   |   |   |   |   <a href="#id43"><span class="problematic" id="id44">|</span></a>– &lt;latest&gt;</div>
<div class="line">|   |   |   |   <a href="#id45"><span class="problematic" id="id46">|</span></a>– diagnostics</div>
<div class="line">|   |   |   |   |   <a href="#id47"><span class="problematic" id="id48">|</span></a>– {history_id} *</div>
<div class="line">|   |   |   |   |   |   <a href="#id49"><span class="problematic" id="id50">|</span></a>– &lt;files&gt;</div>
<div class="line">|   <a href="#id51"><span class="problematic" id="id52">|</span></a>– trained_models</div>
<div class="line">|   |   <a href="#id53"><span class="problematic" id="id54">|</span></a>– arch_{archid} *</div>
</div>
<hr class="docutils" />
<dl class="py class">
<dt id="wbia_cnn.models.abstract_models.AbstractCategoricalModel">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.abstract_models.</code><code class="sig-name descname">AbstractCategoricalModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#AbstractCategoricalModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.BaseModel" title="wbia_cnn.models.abstract_models.BaseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.BaseModel</span></code></a></p>
<p>base model for catagory classifiers</p>
<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.AbstractCategoricalModel.custom_labeled_outputs">
<code class="sig-name descname">custom_labeled_outputs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">network_output</span></em>, <em class="sig-param"><span class="n">y_batch</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#AbstractCategoricalModel.custom_labeled_outputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel.custom_labeled_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>override in inherited subclass to enable custom symbolic expressions
based on the network output and the labels</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.AbstractCategoricalModel.custom_unlabeled_outputs">
<code class="sig-name descname">custom_unlabeled_outputs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">network_output</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#AbstractCategoricalModel.custom_unlabeled_outputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel.custom_unlabeled_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>override in inherited subclass to enable custom symbolic expressions
based on the network output alone</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.AbstractCategoricalModel.init_encoder">
<code class="sig-name descname">init_encoder</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">labels</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#AbstractCategoricalModel.init_encoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel.init_encoder" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.AbstractCategoricalModel.loss_function">
<code class="sig-name descname">loss_function</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">network_output</span></em>, <em class="sig-param"><span class="n">truth</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#AbstractCategoricalModel.loss_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel.loss_function" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.AbstractCategoricalModel.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="wbia_cnn.models.abstract_models.AbstractVectorModel">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.abstract_models.</code><code class="sig-name descname">AbstractVectorModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#AbstractVectorModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractVectorModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.BaseModel" title="wbia_cnn.models.abstract_models.BaseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.BaseModel</span></code></a></p>
<p>base model for catagory classifiers</p>
<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.AbstractVectorModel.custom_labeled_outputs">
<code class="sig-name descname">custom_labeled_outputs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">network_output</span></em>, <em class="sig-param"><span class="n">y_batch</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#AbstractVectorModel.custom_labeled_outputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractVectorModel.custom_labeled_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>override in inherited subclass to enable custom symbolic expressions
based on the network output and the labels</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.AbstractVectorModel.custom_unlabeled_outputs">
<code class="sig-name descname">custom_unlabeled_outputs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">network_output</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#AbstractVectorModel.custom_unlabeled_outputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractVectorModel.custom_unlabeled_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>override in inherited subclass to enable custom symbolic expressions
based on the network output alone</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.AbstractVectorModel.init_output_dims">
<code class="sig-name descname">init_output_dims</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">labels</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#AbstractVectorModel.init_output_dims"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractVectorModel.init_output_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.AbstractVectorModel.loss_function">
<code class="sig-name descname">loss_function</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">network_output</span></em>, <em class="sig-param"><span class="n">truth</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#AbstractVectorModel.loss_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractVectorModel.loss_function" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.AbstractVectorModel.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractVectorModel.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="wbia_cnn.models.abstract_models.AbstractVectorVectorModel">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.abstract_models.</code><code class="sig-name descname">AbstractVectorVectorModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#AbstractVectorVectorModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractVectorVectorModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.AbstractVectorModel" title="wbia_cnn.models.abstract_models.AbstractVectorModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.AbstractVectorModel</span></code></a></p>
<p>base model for catagory classifiers</p>
<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.AbstractVectorVectorModel.custom_labeled_outputs">
<code class="sig-name descname">custom_labeled_outputs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">network_output</span></em>, <em class="sig-param"><span class="n">y_batch</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#AbstractVectorVectorModel.custom_labeled_outputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractVectorVectorModel.custom_labeled_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>override in inherited subclass to enable custom symbolic expressions
based on the network output and the labels</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.AbstractVectorVectorModel.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractVectorVectorModel.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="wbia_cnn.models.abstract_models.BaseModel">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.abstract_models.</code><code class="sig-name descname">BaseModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#BaseModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.BaseModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models._model_legacy._ModelLegacy" title="wbia_cnn.models._model_legacy._ModelLegacy"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models._model_legacy._ModelLegacy</span></code></a>, <a class="reference internal" href="#wbia_cnn.models.abstract_models._ModelVisualization" title="wbia_cnn.models.abstract_models._ModelVisualization"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models._ModelVisualization</span></code></a>, <a class="reference internal" href="#wbia_cnn.models.abstract_models._ModelIO" title="wbia_cnn.models.abstract_models._ModelIO"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models._ModelIO</span></code></a>, <a class="reference internal" href="#wbia_cnn.models.abstract_models._ModelStrings" title="wbia_cnn.models.abstract_models._ModelStrings"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models._ModelStrings</span></code></a>, <a class="reference internal" href="#wbia_cnn.models.abstract_models._ModelIDs" title="wbia_cnn.models.abstract_models._ModelIDs"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models._ModelIDs</span></code></a>, <a class="reference internal" href="#wbia_cnn.models.abstract_models._ModelBackend" title="wbia_cnn.models.abstract_models._ModelBackend"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models._ModelBackend</span></code></a>, <a class="reference internal" href="#wbia_cnn.models.abstract_models._ModelFitter" title="wbia_cnn.models.abstract_models._ModelFitter"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models._ModelFitter</span></code></a>, <a class="reference internal" href="#wbia_cnn.models.abstract_models._ModelPredicter" title="wbia_cnn.models.abstract_models._ModelPredicter"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models._ModelPredicter</span></code></a>, <a class="reference internal" href="#wbia_cnn.models.abstract_models._ModelBatch" title="wbia_cnn.models.abstract_models._ModelBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models._ModelBatch</span></code></a>, <a class="reference internal" href="#wbia_cnn.models.abstract_models._ModelUtility" title="wbia_cnn.models.abstract_models._ModelUtility"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models._ModelUtility</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">utool.util_dev.NiceRepr</span></code></p>
<p>Abstract model providing functionality for all other models to derive from</p>
<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.BaseModel._init_shape_vars">
<code class="sig-name descname">_init_shape_vars</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#BaseModel._init_shape_vars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.BaseModel._init_shape_vars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.BaseModel.augment">
<code class="sig-name descname">augment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Xb</span></em>, <em class="sig-param"><span class="n">yb</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#BaseModel.augment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.BaseModel.augment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.BaseModel.init_arch">
<code class="sig-name descname">init_arch</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#BaseModel.init_arch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.BaseModel.init_arch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.BaseModel.init_from_json">
<code class="sig-name descname">init_from_json</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fpath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#BaseModel.init_from_json"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.BaseModel.init_from_json" title="Permalink to this definition">¶</a></dt>
<dd><p>fpath = ut.truepath(‘~/Desktop/manually_saved/arch_injur-shark-resnet_o2_d27_c2942_jzuddodd/model_state_arch_jzuddodd.pkl’)</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.BaseModel.input_batchsize">
<em class="property">property </em><code class="sig-name descname">input_batchsize</code><a class="headerlink" href="#wbia_cnn.models.abstract_models.BaseModel.input_batchsize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.BaseModel.input_channels">
<em class="property">property </em><code class="sig-name descname">input_channels</code><a class="headerlink" href="#wbia_cnn.models.abstract_models.BaseModel.input_channels" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.BaseModel.input_height">
<em class="property">property </em><code class="sig-name descname">input_height</code><a class="headerlink" href="#wbia_cnn.models.abstract_models.BaseModel.input_height" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.BaseModel.input_width">
<em class="property">property </em><code class="sig-name descname">input_width</code><a class="headerlink" href="#wbia_cnn.models.abstract_models.BaseModel.input_width" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.BaseModel.loss_function">
<code class="sig-name descname">loss_function</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">network_output</span></em>, <em class="sig-param"><span class="n">truth</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#BaseModel.loss_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.BaseModel.loss_function" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.BaseModel.reinit_weights">
<code class="sig-name descname">reinit_weights</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">W</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#BaseModel.reinit_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.BaseModel.reinit_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>initailizes weights after the architecture has been defined.</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.BaseModel.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.abstract_models.BaseModel.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="wbia_cnn.models.abstract_models.History">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.abstract_models.</code><code class="sig-name descname">History</code><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#History"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.History" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">utool.util_dev.NiceRepr</span></code></p>
<p>Manages bookkeeping for training history</p>
<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.History._new_era">
<code class="sig-name descname">_new_era</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">X_learn</span></em>, <em class="sig-param"><span class="n">y_learn</span></em>, <em class="sig-param"><span class="n">X_valid</span></em>, <em class="sig-param"><span class="n">y_valid</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#History._new_era"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.History._new_era" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to denote a change in hyperparameters during training.</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.History._record_epoch">
<code class="sig-name descname">_record_epoch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">epoch_info</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#History._record_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.History._record_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Records an epoch in an era.</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.History.current_era_size">
<em class="property">property </em><code class="sig-name descname">current_era_size</code><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.current_era_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.History.from_oldstyle">
<em class="property">classmethod </em><code class="sig-name descname">from_oldstyle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">era_history</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#History.from_oldstyle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.from_oldstyle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.History.get_history_hashid">
<code class="sig-name descname">get_history_hashid</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#History.get_history_hashid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.get_history_hashid" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a hashid that uniquely identifies the architecture and the
training procedure this model has gone through to produce the current
architecture weights.</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.History.get_history_nice">
<code class="sig-name descname">get_history_nice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#History.get_history_nice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.get_history_nice" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.History.grouped_epochs">
<code class="sig-name descname">grouped_epochs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#History.grouped_epochs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.grouped_epochs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.History.grouped_epochsT">
<code class="sig-name descname">grouped_epochsT</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#History.grouped_epochsT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.grouped_epochsT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.History.hist_id">
<em class="property">property </em><code class="sig-name descname">hist_id</code><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.hist_id" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.abstract_models –test-History.hist_id:0</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.abstract_models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">testdata_model_with_history</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">history</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">hist_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">epoch0002_era012_qewrbbgy</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.History.record_epoch">
<code class="sig-name descname">record_epoch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">epoch_info</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#History.record_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.record_epoch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.History.rewind_to">
<code class="sig-name descname">rewind_to</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">epoch_num</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#History.rewind_to"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.rewind_to" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.History.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.History.to_json">
<code class="sig-name descname">to_json</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#History.to_json"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.to_json" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.History.total_epochs">
<em class="property">property </em><code class="sig-name descname">total_epochs</code><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.total_epochs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.History.total_eras">
<em class="property">property </em><code class="sig-name descname">total_eras</code><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.total_eras" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="wbia_cnn.models.abstract_models.LearnState">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.abstract_models.</code><code class="sig-name descname">LearnState</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">learning_rate</span></em>, <em class="sig-param"><span class="n">momentum</span></em>, <em class="sig-param"><span class="n">weight_decay</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#LearnState"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.LearnState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">utool.util_dict.DictLike</span></code></p>
<p>Keeps track of parameters that can be changed during theano execution</p>
<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.LearnState.getitem">
<code class="sig-name descname">getitem</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">key</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#LearnState.getitem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.LearnState.getitem" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.LearnState.init">
<code class="sig-name descname">init</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#LearnState.init"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.LearnState.init" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.LearnState.keys">
<code class="sig-name descname">keys</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#LearnState.keys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.LearnState.keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.LearnState.learning_rate">
<em class="property">property </em><code class="sig-name descname">learning_rate</code><a class="headerlink" href="#wbia_cnn.models.abstract_models.LearnState.learning_rate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.LearnState.momentum">
<em class="property">property </em><code class="sig-name descname">momentum</code><a class="headerlink" href="#wbia_cnn.models.abstract_models.LearnState.momentum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.LearnState.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.abstract_models.LearnState.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.LearnState.setitem">
<code class="sig-name descname">setitem</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">key</span></em>, <em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#LearnState.setitem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.LearnState.setitem" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.LearnState.shared">
<em class="property">property </em><code class="sig-name descname">shared</code><a class="headerlink" href="#wbia_cnn.models.abstract_models.LearnState.shared" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models.LearnState.weight_decay">
<em class="property">property </em><code class="sig-name descname">weight_decay</code><a class="headerlink" href="#wbia_cnn.models.abstract_models.LearnState.weight_decay" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="wbia_cnn.models.abstract_models._BatchUtility">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.abstract_models.</code><code class="sig-name descname">_BatchUtility</code><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_BatchUtility"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._BatchUtility" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._BatchUtility._pad_labels">
<code class="sig-name descname">_pad_labels</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">yb</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_BatchUtility._pad_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._BatchUtility._pad_labels" title="Permalink to this definition">¶</a></dt>
<dd><p># TODO: FIX data_per_label_input ISSUES
# most models will do the padding implicitly
# in the layer architecture</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._BatchUtility._stack_outputs">
<code class="sig-name descname">_stack_outputs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theano_fn</span></em>, <em class="sig-param"><span class="n">output_list</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_BatchUtility._stack_outputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._BatchUtility._stack_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Combines outputs across batches and returns them in a dictionary keyed
by the theano variable output name.</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._BatchUtility._unwrap_outputs">
<code class="sig-name descname">_unwrap_outputs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">outputs</span></em>, <em class="sig-param"><span class="n">X</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_BatchUtility._unwrap_outputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._BatchUtility._unwrap_outputs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._BatchUtility.expand_data_indicies">
<em class="property">classmethod </em><code class="sig-name descname">expand_data_indicies</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">label_idx</span></em>, <em class="sig-param"><span class="n">data_per_label</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_BatchUtility.expand_data_indicies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._BatchUtility.expand_data_indicies" title="Permalink to this definition">¶</a></dt>
<dd><p>when data_per_label &gt; 1, gives the corresponding data indicies for the
data indicies</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._BatchUtility.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.abstract_models._BatchUtility.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._BatchUtility.shuffle_input">
<em class="property">classmethod </em><code class="sig-name descname">shuffle_input</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">w</span></em>, <em class="sig-param"><span class="n">data_per_label</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">rng</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_BatchUtility.shuffle_input"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._BatchUtility.shuffle_input" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._BatchUtility.slice_batch">
<em class="property">classmethod </em><code class="sig-name descname">slice_batch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">w</span></em>, <em class="sig-param"><span class="n">batch_size</span></em>, <em class="sig-param"><span class="n">batch_index</span></em>, <em class="sig-param"><span class="n">data_per_label</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">wraparound</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_BatchUtility.slice_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._BatchUtility.slice_batch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="wbia_cnn.models.abstract_models._ModelBackend">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.abstract_models.</code><code class="sig-name descname">_ModelBackend</code><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelBackend"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelBackend" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Functions that build and compile theano exepressions</p>
<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelBackend._get_labeled_outputs">
<code class="sig-name descname">_get_labeled_outputs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelBackend._get_labeled_outputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelBackend._get_labeled_outputs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelBackend._get_network_output">
<code class="sig-name descname">_get_network_output</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelBackend._get_network_output"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelBackend._get_network_output" title="Permalink to this definition">¶</a></dt>
<dd><p>gets the activations of the output neurons</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelBackend._get_unlabeled_outputs">
<code class="sig-name descname">_get_unlabeled_outputs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelBackend._get_unlabeled_outputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelBackend._get_unlabeled_outputs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelBackend._init_compile_vars">
<code class="sig-name descname">_init_compile_vars</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelBackend._init_compile_vars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelBackend._init_compile_vars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelBackend._make_monitor_outputs">
<code class="sig-name descname">_make_monitor_outputs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">parameters</span></em>, <em class="sig-param"><span class="n">updates</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelBackend._make_monitor_outputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelBackend._make_monitor_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds parameters to monitor the magnitude of updates durning learning</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelBackend._make_updates">
<code class="sig-name descname">_make_updates</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">parameters</span></em>, <em class="sig-param"><span class="n">backprop_loss_</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelBackend._make_updates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelBackend._make_updates" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelBackend._testdata_batch">
<code class="sig-name descname">_testdata_batch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataset</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">16</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelBackend._testdata_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelBackend._testdata_batch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelBackend._theano_fn_inputs">
<em class="property">property </em><code class="sig-name descname">_theano_fn_inputs</code><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelBackend._theano_fn_inputs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelBackend._theano_loss_exprs">
<em class="property">property </em><code class="sig-name descname">_theano_loss_exprs</code><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelBackend._theano_loss_exprs" title="Permalink to this definition">¶</a></dt>
<dd><p>Requires that a custom loss function is defined in the inherited class</p>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.abstract_models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="n">mnist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">theano</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">testdata_mnist</span><span class="p">(</span><span class="n">dropout</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">_init_compile_vars</span><span class="p">({})</span>  <span class="c1"># reset state</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">_theano_loss_exprs</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss_item</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">_theano_loss_exprs</span><span class="p">[</span><span class="s1">&#39;loss_item&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_in</span> <span class="o">=</span> <span class="n">theano</span><span class="o">.</span><span class="n">In</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">_theano_fn_inputs</span><span class="p">[</span><span class="s1">&#39;X_batch&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_in</span> <span class="o">=</span> <span class="n">theano</span><span class="o">.</span><span class="n">In</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">_theano_fn_inputs</span><span class="p">[</span><span class="s1">&#39;y_batch&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w_in</span> <span class="o">=</span> <span class="n">theano</span><span class="o">.</span><span class="n">In</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">_theano_fn_inputs</span><span class="p">[</span><span class="s1">&#39;w_batch&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Eval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input1</span> <span class="o">=</span> <span class="p">{</span><span class="n">X_in</span><span class="p">:</span> <span class="n">Xb</span><span class="p">,</span> <span class="n">y_in</span><span class="p">:</span> <span class="n">yb</span><span class="p">,</span> <span class="n">w_in</span><span class="p">:</span> <span class="n">wb</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input2</span> <span class="o">=</span> <span class="p">{</span><span class="n">X_in</span><span class="p">:</span> <span class="n">Xb</span><span class="p">,</span> <span class="n">y_in</span><span class="p">:</span> <span class="n">yb</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">input1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_loss_item</span> <span class="o">=</span> <span class="n">loss_item</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">input2</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelBackend.build">
<code class="sig-name descname">build</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelBackend.build"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelBackend.build" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelBackend.build_backprop_func">
<code class="sig-name descname">build_backprop_func</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelBackend.build_backprop_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelBackend.build_backprop_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes loss and updates model parameters.
Returns diagnostic information.</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelBackend.build_forward_func">
<code class="sig-name descname">build_forward_func</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelBackend.build_forward_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelBackend.build_forward_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes loss, but does not learn.
Returns diagnostic information.</p>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.abstract_models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="n">mnist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">theano</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">testdata_mnist</span><span class="p">(</span><span class="n">dropout</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">learn_state</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">wb</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">_testdata_batch</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">_theano_exprs</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss_item</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">_theano_loss_exprs</span><span class="p">[</span><span class="s1">&#39;loss_item&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_in</span> <span class="o">=</span> <span class="n">theano</span><span class="o">.</span><span class="n">In</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">_theano_fn_inputs</span><span class="p">[</span><span class="s1">&#39;X_batch&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_in</span> <span class="o">=</span> <span class="n">theano</span><span class="o">.</span><span class="n">In</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">_theano_fn_inputs</span><span class="p">[</span><span class="s1">&#39;y_batch&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w_in</span> <span class="o">=</span> <span class="n">theano</span><span class="o">.</span><span class="n">In</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">_theano_fn_inputs</span><span class="p">[</span><span class="s1">&#39;w_batch&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss_batch</span> <span class="o">=</span> <span class="n">loss_item</span><span class="o">.</span><span class="n">eval</span><span class="p">({</span><span class="n">X_in</span><span class="p">:</span> <span class="n">Xb</span><span class="p">,</span> <span class="n">y_in</span><span class="p">:</span> <span class="n">yb</span><span class="p">})</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelBackend.build_predict_func">
<code class="sig-name descname">build_predict_func</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelBackend.build_predict_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelBackend.build_predict_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes predictions given unlabeled data</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelBackend.custom_labeled_outputs">
<code class="sig-name descname">custom_labeled_outputs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">network_output</span></em>, <em class="sig-param"><span class="n">y_batch</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelBackend.custom_labeled_outputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelBackend.custom_labeled_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>override in inherited subclass to enable custom symbolic expressions
based on the network output and the labels</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelBackend.custom_unlabeled_outputs">
<code class="sig-name descname">custom_unlabeled_outputs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">network_output</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelBackend.custom_unlabeled_outputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelBackend.custom_unlabeled_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>override in inherited subclass to enable custom symbolic expressions
based on the network output alone</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="wbia_cnn.models.abstract_models._ModelBatch">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.abstract_models.</code><code class="sig-name descname">_ModelBatch</code><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelBatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelBatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models._BatchUtility" title="wbia_cnn.models.abstract_models._BatchUtility"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models._BatchUtility</span></code></a></p>
<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelBatch._init_batch_vars">
<code class="sig-name descname">_init_batch_vars</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelBatch._init_batch_vars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelBatch._init_batch_vars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelBatch._prepare_batch">
<code class="sig-name descname">_prepare_batch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Xb_</span></em>, <em class="sig-param"><span class="n">yb_</span></em>, <em class="sig-param"><span class="n">wb_</span></em>, <em class="sig-param"><span class="n">is_int</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">is_cv2</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">augment_on</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">whiten_on</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelBatch._prepare_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelBatch._prepare_batch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelBatch.batch_iterator">
<code class="sig-name descname">batch_iterator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">w</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">shuffle</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">augment_on</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelBatch.batch_iterator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelBatch.batch_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.abstract_models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">models</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DummyModel</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">make_random_testdata</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">37</span><span class="p">,</span> <span class="n">cv2_format</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">ensure_data_params</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result_list</span> <span class="o">=</span> <span class="p">[(</span><span class="n">Xb</span><span class="p">,</span> <span class="n">Yb</span><span class="p">)</span> <span class="k">for</span> <span class="n">Xb</span><span class="p">,</span> <span class="n">Yb</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">batch_iterator</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">result_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">Xb</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">depth_profile</span><span class="p">(</span><span class="n">result_list</span><span class="p">,</span> <span class="n">compress_consecutive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">(7, [(16, 1, 4, 4), 16])</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.abstract_models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">models</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DummyModel</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">make_random_testdata</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">37</span><span class="p">,</span> <span class="n">cv2_format</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">asint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">X_is_cv2_native</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">ensure_data_params</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result_list</span> <span class="o">=</span> <span class="p">[(</span><span class="n">Xb</span><span class="p">,</span> <span class="n">Yb</span><span class="p">)</span> <span class="k">for</span> <span class="n">Xb</span><span class="p">,</span> <span class="n">Yb</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">batch_iterator</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">result_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="n">Xb</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">depth</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelBatch.prepare_data">
<code class="sig-name descname">prepare_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">w</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelBatch.prepare_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelBatch.prepare_data" title="Permalink to this definition">¶</a></dt>
<dd><p>convenience function for external use</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelBatch.process_batch">
<code class="sig-name descname">process_batch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theano_fn</span></em>, <em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">w</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">buffered</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">unwrap</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">shuffle</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">augment_on</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelBatch.process_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelBatch.process_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute a theano function on batches of X and y</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelBatch.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelBatch.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="wbia_cnn.models.abstract_models._ModelFitter">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.abstract_models.</code><code class="sig-name descname">_ModelFitter</code><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelFitter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelFitter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn _ModelFitter.fit:0</p>
</dd>
</dl>
<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelFitter._default_input_weights">
<code class="sig-name descname">_default_input_weights</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">w</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelFitter._default_input_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelFitter._default_input_weights" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelFitter._dump_best_monitor">
<code class="sig-name descname">_dump_best_monitor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelFitter._dump_best_monitor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelFitter._dump_best_monitor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelFitter._dump_case_monitor">
<code class="sig-name descname">_dump_case_monitor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X_learn</span></em>, <em class="sig-param"><span class="n">y_learn</span></em>, <em class="sig-param"><span class="n">X_valid</span></em>, <em class="sig-param"><span class="n">y_valid</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelFitter._dump_case_monitor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelFitter._dump_case_monitor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelFitter._dump_epoch_monitor">
<code class="sig-name descname">_dump_epoch_monitor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelFitter._dump_epoch_monitor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelFitter._dump_epoch_monitor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelFitter._dump_weight_monitor">
<code class="sig-name descname">_dump_weight_monitor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelFitter._dump_weight_monitor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelFitter._dump_weight_monitor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelFitter._ensure_learnval_split">
<code class="sig-name descname">_ensure_learnval_split</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X_train</span></em>, <em class="sig-param"><span class="n">y_train</span></em>, <em class="sig-param"><span class="n">X_valid</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y_valid</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">valid_idx</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelFitter._ensure_learnval_split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelFitter._ensure_learnval_split" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelFitter._epoch_clean">
<code class="sig-name descname">_epoch_clean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theano_forward</span></em>, <em class="sig-param"><span class="n">X_general</span></em>, <em class="sig-param"><span class="n">y_general</span></em>, <em class="sig-param"><span class="n">w_general</span></em>, <em class="sig-param"><span class="n">conf_thresh</span><span class="o">=</span><span class="default_value">0.95</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelFitter._epoch_clean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelFitter._epoch_clean" title="Permalink to this definition">¶</a></dt>
<dd><p>Forwards propogate – Run set through the forwards pass and clean</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelFitter._epoch_learn">
<code class="sig-name descname">_epoch_learn</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theano_backprop</span></em>, <em class="sig-param"><span class="n">X_learn</span></em>, <em class="sig-param"><span class="n">y_learn</span></em>, <em class="sig-param"><span class="n">w_learn</span></em>, <em class="sig-param"><span class="n">epoch</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelFitter._epoch_learn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelFitter._epoch_learn" title="Permalink to this definition">¶</a></dt>
<dd><p>Backwards propogate – Run learning set through the backwards pass</p>
<dl>
<dt>Ignore:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.abstract_models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="n">mnist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">theano</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">testdata_mnist</span><span class="p">(</span><span class="n">dropout</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">monitor_config</span><span class="p">[</span><span class="s1">&#39;monitor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">monitor_config</span><span class="p">[</span><span class="s1">&#39;showprog&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">_behavior</span><span class="p">[</span><span class="s1">&#39;buffered&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">learn_state</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_learn</span><span class="p">,</span> <span class="n">y_learn</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">ensure_data_params</span><span class="p">(</span><span class="n">X_learn</span><span class="p">,</span> <span class="n">y_learn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">class_to_weight</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">data_params</span><span class="p">[</span><span class="s1">&#39;class_to_weight&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">class_to_weight</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">y_learn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w_learn</span> <span class="o">=</span> <span class="n">class_to_weight</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">y_learn</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">_new_fit_session</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theano_backprop</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">build_backprop_func</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelFitter._epoch_validate">
<code class="sig-name descname">_epoch_validate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theano_forward</span></em>, <em class="sig-param"><span class="n">X_valid</span></em>, <em class="sig-param"><span class="n">y_valid</span></em>, <em class="sig-param"><span class="n">w_valid</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelFitter._epoch_validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelFitter._epoch_validate" title="Permalink to this definition">¶</a></dt>
<dd><p>Forwards propagate – Run validation set through the forwards pass</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelFitter._epoch_validate_learn">
<code class="sig-name descname">_epoch_validate_learn</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theano_forward</span></em>, <em class="sig-param"><span class="n">X_learn</span></em>, <em class="sig-param"><span class="n">y_learn</span></em>, <em class="sig-param"><span class="n">w_learn</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelFitter._epoch_validate_learn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelFitter._epoch_validate_learn" title="Permalink to this definition">¶</a></dt>
<dd><p>Forwards propagate – Run validation set through the forwards pass</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelFitter._init_fit_vars">
<code class="sig-name descname">_init_fit_vars</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelFitter._init_fit_vars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelFitter._init_fit_vars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelFitter._new_fit_session">
<code class="sig-name descname">_new_fit_session</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelFitter._new_fit_session"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelFitter._new_fit_session" title="Permalink to this definition">¶</a></dt>
<dd><p>Starts a model training session</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelFitter._overwrite_latest_image">
<code class="sig-name descname">_overwrite_latest_image</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fpath</span></em>, <em class="sig-param"><span class="n">new_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelFitter._overwrite_latest_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelFitter._overwrite_latest_image" title="Permalink to this definition">¶</a></dt>
<dd><p>copies the new image to a path to be overwritten so new updates are
shown</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelFitter._rename_old_sessions">
<code class="sig-name descname">_rename_old_sessions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelFitter._rename_old_sessions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelFitter._rename_old_sessions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelFitter.dump_cases">
<code class="sig-name descname">dump_cases</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">subset_id</span><span class="o">=</span><span class="default_value">'unknown'</span></em>, <em class="sig-param"><span class="n">dpath</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelFitter.dump_cases"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelFitter.dump_cases" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>For each class find:</dt><dd><ul class="simple">
<li><p>the most-hard  failures</p></li>
<li><p>the mid-level failures</p></li>
<li><p>the critical cases (least-hard failures / most-hard successes)</p></li>
<li><p>the mid-level successes</p></li>
<li><p>the least-hard successs</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelFitter.ensure_data_params">
<code class="sig-name descname">ensure_data_params</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X_learn</span></em>, <em class="sig-param"><span class="n">y_learn</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelFitter.ensure_data_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelFitter.ensure_data_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelFitter.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X_train</span></em>, <em class="sig-param"><span class="n">y_train</span></em>, <em class="sig-param"><span class="n">X_valid</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y_valid</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">valid_idx</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">X_test</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y_test</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelFitter.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelFitter.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains the network with backprop.</p>
<dl>
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn _ModelFitter.fit –name=bnorm –vd –monitor
python -m wbia_cnn _ModelFitter.fit –name=dropout
python -m wbia_cnn _ModelFitter.fit –name=incep</p>
</dd>
<dt>Example1:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="n">mnist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">testdata_mnist</span><span class="p">(</span><span class="n">defaultname</span><span class="o">=</span><span class="s1">&#39;bnorm&#39;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">print_layer_info</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">print_model_info_str</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelFitter.get_report_json">
<code class="sig-name descname">get_report_json</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelFitter.get_report_json"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelFitter.get_report_json" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelFitter.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelFitter.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="wbia_cnn.models.abstract_models._ModelIDs">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.abstract_models.</code><code class="sig-name descname">_ModelIDs</code><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelIDs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIDs" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIDs._init_id_vars">
<code class="sig-name descname">_init_id_vars</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelIDs._init_id_vars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIDs._init_id_vars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIDs.arch_id">
<em class="property">property </em><code class="sig-name descname">arch_id</code><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIDs.arch_id" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.abstract_models _ModelIDs.arch_id:0</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.abstract_models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.mnist</span> <span class="kn">import</span> <span class="n">MNISTModel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MNISTModel</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">data_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">output_dims</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;bnorm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">arch_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIDs.get_arch_hashid">
<code class="sig-name descname">get_arch_hashid</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelIDs.get_arch_hashid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIDs.get_arch_hashid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a hash identifying the architecture of the determenistic net.
This does not involve any dropout or noise layers, nor does the
initialization of the weights matter.</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIDs.get_arch_nice">
<code class="sig-name descname">get_arch_nice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelIDs.get_arch_nice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIDs.get_arch_nice" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a string that shows the number of input units, output units,
hidden units, parameters, and model depth.</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.abstract_models get_arch_nice –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.abstract_models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.mnist</span> <span class="kn">import</span> <span class="n">MNISTModel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MNISTModel</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">data_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">output_dims</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">get_arch_nice</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">o10_d4_c107</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIDs.hash_id">
<em class="property">property </em><code class="sig-name descname">hash_id</code><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIDs.hash_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIDs.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIDs.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="wbia_cnn.models.abstract_models._ModelIO">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.abstract_models.</code><code class="sig-name descname">_ModelIO</code><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelIO"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIO" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIO._get_model_dpath">
<code class="sig-name descname">_get_model_dpath</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dpath</span></em>, <em class="sig-param"><span class="n">checkpoint_tag</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelIO._get_model_dpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIO._get_model_dpath" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIO._get_model_file_fpath">
<code class="sig-name descname">_get_model_file_fpath</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">default_fname</span></em>, <em class="sig-param"><span class="n">fpath</span></em>, <em class="sig-param"><span class="n">dpath</span></em>, <em class="sig-param"><span class="n">fname</span></em>, <em class="sig-param"><span class="n">checkpoint_tag</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelIO._get_model_file_fpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIO._get_model_file_fpath" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIO._init_io_vars">
<code class="sig-name descname">_init_io_vars</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelIO._init_io_vars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIO._init_io_vars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIO.arch_dpath">
<em class="property">property </em><code class="sig-name descname">arch_dpath</code><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIO.arch_dpath" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIO.checkpoint_dpath">
<em class="property">property </em><code class="sig-name descname">checkpoint_dpath</code><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIO.checkpoint_dpath" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIO.checkpoint_save_model_info">
<code class="sig-name descname">checkpoint_save_model_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelIO.checkpoint_save_model_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIO.checkpoint_save_model_info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIO.checkpoint_save_model_state">
<code class="sig-name descname">checkpoint_save_model_state</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelIO.checkpoint_save_model_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIO.checkpoint_save_model_state" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIO.get_model_info_fpath">
<code class="sig-name descname">get_model_info_fpath</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fpath</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dpath</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fname</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">checkpoint_tag</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelIO.get_model_info_fpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIO.get_model_info_fpath" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIO.get_model_state_fpath">
<code class="sig-name descname">get_model_state_fpath</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fpath</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dpath</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fname</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">checkpoint_tag</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelIO.get_model_state_fpath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIO.get_model_state_fpath" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIO.has_saved_state">
<code class="sig-name descname">has_saved_state</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">checkpoint_tag</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelIO.has_saved_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIO.has_saved_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if there are any saved model states matching the checkpoing tag.</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIO.list_saved_checkpoints">
<code class="sig-name descname">list_saved_checkpoints</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelIO.list_saved_checkpoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIO.list_saved_checkpoints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIO.load_extern_weights">
<code class="sig-name descname">load_extern_weights</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelIO.load_extern_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIO.load_extern_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>load weights from another model</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIO.load_model_state">
<code class="sig-name descname">load_model_state</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelIO.load_model_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIO.load_model_state" title="Permalink to this definition">¶</a></dt>
<dd><p>kwargs = {}
TODO: resolve load_model_state and load_extern_weights into a single</p>
<blockquote>
<div><p>function that is less magic in what it does and more
straightforward</p>
</div></blockquote>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assumes mnist is trained</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.abstract_models</span> <span class="kn">import</span>  <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="n">mnist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">testdata_mnist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">load_model_state</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIO.print_structure">
<code class="sig-name descname">print_structure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelIO.print_structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIO.print_structure" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.abstract_models print_structure –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.ingest_data</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">grab_mnist_category_dataset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">print_dir_structure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ----</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.mnist</span> <span class="kn">import</span> <span class="n">MNISTModel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MNISTModel</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">data_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">output_dims</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">dataset_dpath</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">dataset_dpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">print_structure</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIO.resolve_fuzzy_checkpoint_pattern">
<code class="sig-name descname">resolve_fuzzy_checkpoint_pattern</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">checkpoint_pattern</span></em>, <em class="sig-param"><span class="n">extern_dpath</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelIO.resolve_fuzzy_checkpoint_pattern"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIO.resolve_fuzzy_checkpoint_pattern" title="Permalink to this definition">¶</a></dt>
<dd><p>tries to find a matching checkpoint so you dont have to type a full
hash</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIO.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIO.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIO.save_model_info">
<code class="sig-name descname">save_model_info</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelIO.save_model_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIO.save_model_info" title="Permalink to this definition">¶</a></dt>
<dd><p>save model information (history and results but no weights)</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIO.save_model_state">
<code class="sig-name descname">save_model_state</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelIO.save_model_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIO.save_model_state" title="Permalink to this definition">¶</a></dt>
<dd><p>saves current model state</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIO.saved_session_dpath">
<em class="property">property </em><code class="sig-name descname">saved_session_dpath</code><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIO.saved_session_dpath" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIO.trained_arch_dpath">
<em class="property">property </em><code class="sig-name descname">trained_arch_dpath</code><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIO.trained_arch_dpath" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelIO.trained_model_dpath">
<em class="property">property </em><code class="sig-name descname">trained_model_dpath</code><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelIO.trained_model_dpath" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="wbia_cnn.models.abstract_models._ModelPredicter">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.abstract_models.</code><code class="sig-name descname">_ModelPredicter</code><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelPredicter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelPredicter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelPredicter._predict">
<code class="sig-name descname">_predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X_test</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelPredicter._predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelPredicter._predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all prediction outputs of the network in a dictionary.</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelPredicter.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X_test</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelPredicter.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelPredicter.predict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelPredicter.predict_proba">
<code class="sig-name descname">predict_proba</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X_test</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelPredicter.predict_proba"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelPredicter.predict_proba" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelPredicter.predict_proba_Xb">
<code class="sig-name descname">predict_proba_Xb</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Xb</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelPredicter.predict_proba_Xb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelPredicter.predict_proba_Xb" title="Permalink to this definition">¶</a></dt>
<dd><p>Accepts prepared inputs</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="wbia_cnn.models.abstract_models._ModelStrings">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.abstract_models.</code><code class="sig-name descname">_ModelStrings</code><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelStrings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelStrings" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelStrings.get_arch_str">
<code class="sig-name descname">get_arch_str</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sep</span><span class="o">=</span><span class="default_value">'_'</span></em>, <em class="sig-param"><span class="n">with_noise</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelStrings.get_arch_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelStrings.get_arch_str" title="Permalink to this definition">¶</a></dt>
<dd><p>with_noise is a boolean that specifies if layers that doesnt
affect the flow of information in the determenistic setting are to be
included. IE get rid of dropout.</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.abstract_models _ModelStrings.get_arch_str:0</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.abstract_models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.mnist</span> <span class="kn">import</span> <span class="n">MNISTModel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MNISTModel</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">data_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">output_dims</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">batch_norm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_arch_str</span><span class="p">(</span><span class="n">sep</span><span class="o">=</span><span class="n">ut</span><span class="o">.</span><span class="n">NEWLINE</span><span class="p">,</span> <span class="n">with_noise</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">InputLayer(name=I0,shape=(128, 1, 24, 24))</span>
<span class="go">Conv2DDNNLayer(name=C1,num_filters=32,stride=(1, 1),nonlinearity=rectify)</span>
<span class="go">MaxPool2DDNNLayer(name=P1,stride=(2, 2))</span>
<span class="go">Conv2DDNNLayer(name=C2,num_filters=32,stride=(1, 1),nonlinearity=rectify)</span>
<span class="go">MaxPool2DDNNLayer(name=P2,stride=(2, 2))</span>
<span class="go">DenseLayer(name=F3,num_units=256,nonlinearity=rectify)</span>
<span class="go">DenseLayer(name=O4,num_units=10,nonlinearity=softmax)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelStrings.get_layer_info_str">
<code class="sig-name descname">get_layer_info_str</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelStrings.get_layer_info_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelStrings.get_layer_info_str" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.abstract_models _ModelStrings.get_layer_info_str:0</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.abstract_models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.mnist</span> <span class="kn">import</span> <span class="n">MNISTModel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MNISTModel</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">data_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">output_dims</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_layer_info_str</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">Network Structure:</span>
<span class="go"> index  Name  Layer               Outputs      Bytes OutShape           Params</span>
<span class="go"> 0      I0    InputLayer              576    294,912 (128, 1, 24, 24)   []</span>
<span class="go"> 1      C1    Conv2DDNNLayer       12,800  6,556,928 (128, 32, 20, 20)  [C1.W(32,1,5,5, {t,r}), C1.b(32, {t})]</span>
<span class="go"> 2      P1    MaxPool2DDNNLayer     3,200  1,638,400 (128, 32, 10, 10)  []</span>
<span class="go"> 3      C2    Conv2DDNNLayer        1,152    692,352 (128, 32, 6, 6)    [C2.W(32,32,5,5, {t,r}), C2.b(32, {t})]</span>
<span class="go"> 4      P2    MaxPool2DDNNLayer       288    147,456 (128, 32, 3, 3)    []</span>
<span class="go"> 5      D2    DropoutLayer            288    147,456 (128, 32, 3, 3)    []</span>
<span class="go"> 6      F3    DenseLayer              256    427,008 (128, 256)         [F3.W(288,256, {t,r}), F3.b(256, {t})]</span>
<span class="go"> 7      D3    DropoutLayer            256    131,072 (128, 256)         []</span>
<span class="go"> 8      O4    DenseLayer               10     15,400 (128, 10)          [O4.W(256,10, {t,r}), O4.b(10, {t})]</span>
<span class="go">...this model has 103,018 learnable parameters</span>
<span class="go">...this model will use 10,050,984 bytes = 9.59 MB</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelStrings.get_state_str">
<code class="sig-name descname">get_state_str</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other_override_reprs</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelStrings.get_state_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelStrings.get_state_str" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelStrings.make_arch_json">
<code class="sig-name descname">make_arch_json</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">with_noise</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelStrings.make_arch_json"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelStrings.make_arch_json" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.abstract_models make_arch_json –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.abstract_models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="n">mnist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">testdata_mnist</span><span class="p">(</span><span class="n">defaultname</span><span class="o">=</span><span class="s1">&#39;resnet&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#model = mnist.MNISTModel(batch_size=128, data_shape=(28, 28, 1),</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#                         output_dims=10, batch_norm=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">json_str</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">make_arch_json</span><span class="p">(</span><span class="n">with_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">json_str</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelStrings.print_arch_str">
<code class="sig-name descname">print_arch_str</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sep</span><span class="o">=</span><span class="default_value">'\n  '</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelStrings.print_arch_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelStrings.print_arch_str" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelStrings.print_layer_info">
<code class="sig-name descname">print_layer_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelStrings.print_layer_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelStrings.print_layer_info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelStrings.print_model_info_str">
<code class="sig-name descname">print_model_info_str</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelStrings.print_model_info_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelStrings.print_model_info_str" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelStrings.print_state_str">
<code class="sig-name descname">print_state_str</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelStrings.print_state_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelStrings.print_state_str" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelStrings.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelStrings.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="wbia_cnn.models.abstract_models._ModelUtility">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.abstract_models.</code><code class="sig-name descname">_ModelUtility</code><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelUtility"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelUtility" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelUtility._validate_data">
<code class="sig-name descname">_validate_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X_train</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelUtility._validate_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelUtility._validate_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Check to make sure data agrees with model input</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelUtility._validate_input">
<code class="sig-name descname">_validate_input</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">w</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelUtility._validate_input"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelUtility._validate_input" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelUtility._validate_labels">
<code class="sig-name descname">_validate_labels</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">w</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelUtility._validate_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelUtility._validate_labels" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelUtility.get_all_layer_info">
<code class="sig-name descname">get_all_layer_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelUtility.get_all_layer_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelUtility.get_all_layer_info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelUtility.get_all_layers">
<code class="sig-name descname">get_all_layers</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">with_noise</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">with_weightless</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelUtility.get_all_layers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelUtility.get_all_layers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelUtility.get_all_param_values">
<code class="sig-name descname">get_all_param_values</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelUtility.get_all_param_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelUtility.get_all_param_values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelUtility.get_all_params">
<code class="sig-name descname">get_all_params</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">tags</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelUtility.get_all_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelUtility.get_all_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelUtility.get_output_layer">
<code class="sig-name descname">get_output_layer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelUtility.get_output_layer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelUtility.get_output_layer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelUtility.layers_">
<em class="property">property </em><code class="sig-name descname">layers_</code><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelUtility.layers_" title="Permalink to this definition">¶</a></dt>
<dd><p>for compatibility with nolearn visualizations</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelUtility.make_random_testdata">
<code class="sig-name descname">make_random_testdata</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num</span><span class="o">=</span><span class="default_value">37</span></em>, <em class="sig-param"><span class="n">rng</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">cv2_format</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">asint</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelUtility.make_random_testdata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelUtility.make_random_testdata" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelUtility.set_all_param_values">
<code class="sig-name descname">set_all_param_values</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weights_list</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelUtility.set_all_param_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelUtility.set_all_param_values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="wbia_cnn.models.abstract_models._ModelVisualization">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.abstract_models.</code><code class="sig-name descname">_ModelVisualization</code><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelVisualization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelVisualization" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.abstract_models _ModelVisualization
python -m wbia_cnn.models.abstract_models _ModelVisualization –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.abstract_models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="n">dummy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">DummyModel</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">autoinit</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#model._theano_mode = theano.compile.Mode(linker=&#39;py&#39;, optimizer=&#39;fast_compile&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#model._theano_mode = theano.compile.Mode(linker=&#39;py&#39;, optimizer=&#39;fast_compile&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_theano_mode</span> <span class="o">=</span> <span class="n">theano</span><span class="o">.</span><span class="n">compile</span><span class="o">.</span><span class="n">FAST_COMPILE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">make_random_testdata</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">27</span><span class="p">,</span> <span class="n">cv2_format</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">asint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">max_epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">era_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">buffered</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fnum</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">qt4ensure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fnum</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">show_loss_history</span><span class="p">(</span><span class="n">fnum</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#model.show_era_report(fnum)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelVisualization._show_era_acc">
<code class="sig-name descname">_show_era_acc</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelVisualization._show_era_acc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelVisualization._show_era_acc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelVisualization._show_era_class_pr">
<code class="sig-name descname">_show_era_class_pr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">types</span><span class="o">=</span><span class="default_value">['valid', 'learn']</span></em>, <em class="sig-param"><span class="n">measures</span><span class="o">=</span><span class="default_value">['precision', 'recall']</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelVisualization._show_era_class_pr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelVisualization._show_era_class_pr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelVisualization._show_era_loss">
<code class="sig-name descname">_show_era_loss</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelVisualization._show_era_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelVisualization._show_era_loss" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelVisualization._show_era_lossratio">
<code class="sig-name descname">_show_era_lossratio</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelVisualization._show_era_lossratio"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelVisualization._show_era_lossratio" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelVisualization._show_era_measure">
<code class="sig-name descname">_show_era_measure</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ydatas</span></em>, <em class="sig-param"><span class="n">labels</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">styles</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xdatas</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xlabel</span><span class="o">=</span><span class="default_value">'epoch'</span></em>, <em class="sig-param"><span class="n">ylabel</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">yspreads</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">colors</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fnum</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pnum</span><span class="o">=</span><span class="default_value">1, 1, 1</span></em>, <em class="sig-param"><span class="n">yscale</span><span class="o">=</span><span class="default_value">'log'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelVisualization._show_era_measure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelVisualization._show_era_measure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelVisualization.dump_class_dream">
<code class="sig-name descname">dump_class_dream</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fpath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelVisualization.dump_class_dream"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelVisualization.dump_class_dream" title="Permalink to this definition">¶</a></dt>
<dd><p>initial =</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelVisualization.imwrite_arch">
<code class="sig-name descname">imwrite_arch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fpath</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fullinfo</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelVisualization.imwrite_arch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelVisualization.imwrite_arch" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fpath</strong> (<em>str</em>) – file path string(default = None)</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.abstract_models imwrite_arch –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.abstract_models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.mnist</span> <span class="kn">import</span> <span class="n">MNISTModel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MNISTModel</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">data_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">output_dims</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">batch_norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;mnist&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fapth</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">imwrite_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">startfile</span><span class="p">(</span><span class="n">fapth</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelVisualization.render_arch">
<code class="sig-name descname">render_arch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fullinfo</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelVisualization.render_arch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelVisualization.render_arch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelVisualization.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelVisualization.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelVisualization.show_arch">
<code class="sig-name descname">show_arch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fnum</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fullinfo</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelVisualization.show_arch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelVisualization.show_arch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelVisualization.show_class_dream">
<code class="sig-name descname">show_class_dream</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fnum</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelVisualization.show_class_dream"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelVisualization.show_class_dream" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.abstract_models show_class_dream –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assumes mnist is trained</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.draw_net</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="n">mnist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">testdata_mnist</span><span class="p">(</span><span class="n">dropout</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">load_model_state</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.qt4ensure()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">show_class_dream</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelVisualization.show_loss_history">
<code class="sig-name descname">show_loss_history</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fnum</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelVisualization.show_loss_history"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelVisualization.show_loss_history" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fnum</strong> (<em>int</em>) – figure number(default = None)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>fig</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>mpl.Figure</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn _ModelVisualization.show_loss_history –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.abstract_models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">testdata_model_with_history</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fnum</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">show_loss_history</span><span class="p">(</span><span class="n">fnum</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelVisualization.show_pr_history">
<code class="sig-name descname">show_pr_history</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fnum</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelVisualization.show_pr_history"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelVisualization.show_pr_history" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn –tf _ModelVisualization.show_pr_history –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.abstract_models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">testdata_model_with_history</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fnum</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">show_pr_history</span><span class="p">(</span><span class="n">fnum</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelVisualization.show_regularization_stuff">
<code class="sig-name descname">show_regularization_stuff</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fnum</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pnum</span><span class="o">=</span><span class="default_value">1, 1, 1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelVisualization.show_regularization_stuff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelVisualization.show_regularization_stuff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelVisualization.show_update_mag_history">
<code class="sig-name descname">show_update_mag_history</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fnum</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelVisualization.show_update_mag_history"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelVisualization.show_update_mag_history" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn –tf _ModelVisualization.show_update_mag_history –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.abstract_models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">testdata_model_with_history</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fnum</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">show_update_mag_history</span><span class="p">(</span><span class="n">fnum</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelVisualization.show_weight_updates">
<code class="sig-name descname">show_weight_updates</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">param_keys</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelVisualization.show_weight_updates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelVisualization.show_weight_updates" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.abstract_models._ModelVisualization.show_weights_image">
<code class="sig-name descname">show_weights_image</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">index</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#_ModelVisualization.show_weights_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models._ModelVisualization.show_weights_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.abstract_models.delayed_import">
<code class="sig-prename descclassname">wbia_cnn.models.abstract_models.</code><code class="sig-name descname">delayed_import</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#delayed_import"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.delayed_import" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.abstract_models.report_error">
<code class="sig-prename descclassname">wbia_cnn.models.abstract_models.</code><code class="sig-name descname">report_error</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">msg</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#report_error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.report_error" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.abstract_models.testdata_model_with_history">
<code class="sig-prename descclassname">wbia_cnn.models.abstract_models.</code><code class="sig-name descname">testdata_model_with_history</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#testdata_model_with_history"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.testdata_model_with_history" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>
<div class="section" id="module-wbia_cnn.models.aoi">
<span id="wbia-cnn-models-aoi-module"></span><h2>wbia_cnn.models.aoi module<a class="headerlink" href="#module-wbia_cnn.models.aoi" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="wbia_cnn.models.aoi.AoIModel">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.aoi.</code><code class="sig-name descname">AoIModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">autoinit</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">128</span></em>, <em class="sig-param"><span class="n">data_shape</span><span class="o">=</span><span class="default_value">64, 64, 3</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">'aoi'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi.html#AoIModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.aoi.AoIModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.AbstractVectorVectorModel" title="wbia_cnn.models.abstract_models.AbstractVectorVectorModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.AbstractVectorVectorModel</span></code></a></p>
<dl class="py method">
<dt id="wbia_cnn.models.aoi.AoIModel.augment">
<code class="sig-name descname">augment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Xb</span></em>, <em class="sig-param"><span class="n">yb</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wb</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">parallel</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi.html#AoIModel.augment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.aoi.AoIModel.augment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.aoi.AoIModel.get_aoi_def">
<code class="sig-name descname">get_aoi_def</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi.html#AoIModel.get_aoi_def"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.aoi.AoIModel.get_aoi_def" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.aoi.AoIModel.init_arch">
<code class="sig-name descname">init_arch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi.html#AoIModel.init_arch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.aoi.AoIModel.init_arch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.aoi.AoIModel.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.aoi.AoIModel.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.aoi.augment_parallel">
<code class="sig-prename descclassname">wbia_cnn.models.aoi.</code><code class="sig-name descname">augment_parallel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">w</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi.html#augment_parallel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.aoi.augment_parallel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.aoi.augment_wrapper">
<code class="sig-prename descclassname">wbia_cnn.models.aoi.</code><code class="sig-name descname">augment_wrapper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Xb</span></em>, <em class="sig-param"><span class="n">yb</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wb</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi.html#augment_wrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.aoi.augment_wrapper" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.aoi.train_aoi">
<code class="sig-prename descclassname">wbia_cnn.models.aoi.</code><code class="sig-name descname">train_aoi</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">output_path</span></em>, <em class="sig-param"><span class="n">data_fpath</span></em>, <em class="sig-param"><span class="n">labels_fpath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi.html#train_aoi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.aoi.train_aoi" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.train –test-train_aoi</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.train</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">train_aoi</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-wbia_cnn.models.aoi2">
<span id="wbia-cnn-models-aoi2-module"></span><h2>wbia_cnn.models.aoi2 module<a class="headerlink" href="#module-wbia_cnn.models.aoi2" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="wbia_cnn.models.aoi2.AoI2Model">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.aoi2.</code><code class="sig-name descname">AoI2Model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">autoinit</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">128</span></em>, <em class="sig-param"><span class="n">data_shape</span><span class="o">=</span><span class="default_value">64, 64, 3</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">'aoi2'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi2.html#AoI2Model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.aoi2.AoI2Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel" title="wbia_cnn.models.abstract_models.AbstractCategoricalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.AbstractCategoricalModel</span></code></a></p>
<dl class="py method">
<dt id="wbia_cnn.models.aoi2.AoI2Model.augment">
<code class="sig-name descname">augment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Xb</span></em>, <em class="sig-param"><span class="n">yb</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wb</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">parallel</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi2.html#AoI2Model.augment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.aoi2.AoI2Model.augment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.aoi2.AoI2Model.get_aoi2_def">
<code class="sig-name descname">get_aoi2_def</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi2.html#AoI2Model.get_aoi2_def"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.aoi2.AoI2Model.get_aoi2_def" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.aoi2.AoI2Model.init_arch">
<code class="sig-name descname">init_arch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi2.html#AoI2Model.init_arch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.aoi2.AoI2Model.init_arch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.aoi2.AoI2Model.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.aoi2.AoI2Model.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.aoi2.augment_parallel">
<code class="sig-prename descclassname">wbia_cnn.models.aoi2.</code><code class="sig-name descname">augment_parallel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">w</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi2.html#augment_parallel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.aoi2.augment_parallel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.aoi2.augment_wrapper">
<code class="sig-prename descclassname">wbia_cnn.models.aoi2.</code><code class="sig-name descname">augment_wrapper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Xb</span></em>, <em class="sig-param"><span class="n">yb</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wb</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi2.html#augment_wrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.aoi2.augment_wrapper" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.aoi2.train_aoi2">
<code class="sig-prename descclassname">wbia_cnn.models.aoi2.</code><code class="sig-name descname">train_aoi2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">output_path</span></em>, <em class="sig-param"><span class="n">data_fpath</span></em>, <em class="sig-param"><span class="n">labels_fpath</span></em>, <em class="sig-param"><span class="n">purge</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi2.html#train_aoi2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.aoi2.train_aoi2" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.train –test-train_aoi2</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.train</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">train_aoi2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-wbia_cnn.models.background">
<span id="wbia-cnn-models-background-module"></span><h2>wbia_cnn.models.background module<a class="headerlink" href="#module-wbia_cnn.models.background" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="wbia_cnn.models.background.BackgroundModel">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.background.</code><code class="sig-name descname">BackgroundModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">autoinit</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">128</span></em>, <em class="sig-param"><span class="n">data_shape</span><span class="o">=</span><span class="default_value">48, 48, 3</span></em>, <em class="sig-param"><span class="n">num_output</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/background.html#BackgroundModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.background.BackgroundModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel" title="wbia_cnn.models.abstract_models.AbstractCategoricalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.AbstractCategoricalModel</span></code></a></p>
<dl class="py method">
<dt id="wbia_cnn.models.background.BackgroundModel.augment">
<code class="sig-name descname">augment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Xb</span></em>, <em class="sig-param"><span class="n">yb</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/background.html#BackgroundModel.augment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.background.BackgroundModel.augment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.background.BackgroundModel.get_background_def">
<code class="sig-name descname">get_background_def</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/background.html#BackgroundModel.get_background_def"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.background.BackgroundModel.get_background_def" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.background.BackgroundModel.init_arch">
<code class="sig-name descname">init_arch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/background.html#BackgroundModel.init_arch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.background.BackgroundModel.init_arch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.background.BackgroundModel.learning_rate_shock">
<code class="sig-name descname">learning_rate_shock</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/background.html#BackgroundModel.learning_rate_shock"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.background.BackgroundModel.learning_rate_shock" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.background.BackgroundModel.learning_rate_update">
<code class="sig-name descname">learning_rate_update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/background.html#BackgroundModel.learning_rate_update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.background.BackgroundModel.learning_rate_update" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.background.BackgroundModel.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.background.BackgroundModel.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="wbia_cnn.models.background.NonlinearityLayerSpatial">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.background.</code><code class="sig-name descname">NonlinearityLayerSpatial</code><span class="sig-paren">(</span><em class="sig-param">incoming</em>, <em class="sig-param">nonlinearity=&lt;function rectify&gt;</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/background.html#NonlinearityLayerSpatial"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.background.NonlinearityLayerSpatial" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Lasagne.lasagne.layers.special.NonlinearityLayer</span></code></p>
<dl class="py method">
<dt id="wbia_cnn.models.background.NonlinearityLayerSpatial.get_output_for">
<code class="sig-name descname">get_output_for</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/background.html#NonlinearityLayerSpatial.get_output_for"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.background.NonlinearityLayerSpatial.get_output_for" title="Permalink to this definition">¶</a></dt>
<dd><p>Propagates the given input through this layer (and only this layer).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<em>Theano expression</em>) – The expression to propagate through this layer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output</strong> – The output of this layer given the input to this layer.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Theano expression</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is called by the base <code class="xref py py-meth docutils literal notranslate"><span class="pre">lasagne.layers.get_output()</span></code>
to propagate data through a network.</p>
<p>This method should be overridden when implementing a new
<code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code> class. By default it raises <cite>NotImplementedError</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.background.NonlinearityLayerSpatial.get_output_shape_for">
<code class="sig-name descname">get_output_shape_for</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input_shape</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/background.html#NonlinearityLayerSpatial.get_output_shape_for"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.background.NonlinearityLayerSpatial.get_output_shape_for" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the output shape of this layer, given an input shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_shape</strong> (<em>tuple</em>) – A tuple representing the shape of the input. The tuple should have
as many elements as there are input dimensions, and the elements
should be integers or <cite>None</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple representing the shape of the output of this layer. The
tuple has as many elements as there are output dimensions, and the
elements are all either integers or <cite>None</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method will typically be overridden when implementing a new
<code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code> class. By default it simply returns the input
shape. This means that a layer that does not modify the shape
(e.g. because it applies an elementwise operation) does not need
to override this method.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.background.train_background">
<code class="sig-prename descclassname">wbia_cnn.models.background.</code><code class="sig-name descname">train_background</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">output_path</span></em>, <em class="sig-param"><span class="n">data_fpath</span></em>, <em class="sig-param"><span class="n">labels_fpath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/background.html#train_background"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.background.train_background" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.train –test-train_background</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.train</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">train_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-wbia_cnn.models.classifier">
<span id="wbia-cnn-models-classifier-module"></span><h2>wbia_cnn.models.classifier module<a class="headerlink" href="#module-wbia_cnn.models.classifier" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="wbia_cnn.models.classifier.ClassifierModel">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.classifier.</code><code class="sig-name descname">ClassifierModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">autoinit</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">128</span></em>, <em class="sig-param"><span class="n">data_shape</span><span class="o">=</span><span class="default_value">64, 64, 3</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">'classifier'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier.html#ClassifierModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.classifier.ClassifierModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel" title="wbia_cnn.models.abstract_models.AbstractCategoricalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.AbstractCategoricalModel</span></code></a></p>
<dl class="py method">
<dt id="wbia_cnn.models.classifier.ClassifierModel.augment">
<code class="sig-name descname">augment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Xb</span></em>, <em class="sig-param"><span class="n">yb</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">parallel</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier.html#ClassifierModel.augment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.classifier.ClassifierModel.augment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.classifier.ClassifierModel.get_classifier_def">
<code class="sig-name descname">get_classifier_def</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier.html#ClassifierModel.get_classifier_def"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.classifier.ClassifierModel.get_classifier_def" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.classifier.ClassifierModel.init_arch">
<code class="sig-name descname">init_arch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier.html#ClassifierModel.init_arch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.classifier.ClassifierModel.init_arch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.classifier.ClassifierModel.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.classifier.ClassifierModel.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.classifier.augment_parallel">
<code class="sig-prename descclassname">wbia_cnn.models.classifier.</code><code class="sig-name descname">augment_parallel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier.html#augment_parallel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.classifier.augment_parallel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.classifier.augment_wrapper">
<code class="sig-prename descclassname">wbia_cnn.models.classifier.</code><code class="sig-name descname">augment_wrapper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Xb</span></em>, <em class="sig-param"><span class="n">yb</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier.html#augment_wrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.classifier.augment_wrapper" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.classifier.train_classifier">
<code class="sig-prename descclassname">wbia_cnn.models.classifier.</code><code class="sig-name descname">train_classifier</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">output_path</span></em>, <em class="sig-param"><span class="n">data_fpath</span></em>, <em class="sig-param"><span class="n">labels_fpath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier.html#train_classifier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.classifier.train_classifier" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.train –test-train_classifier</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.train</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">train_classifier</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-wbia_cnn.models.classifier2">
<span id="wbia-cnn-models-classifier2-module"></span><h2>wbia_cnn.models.classifier2 module<a class="headerlink" href="#module-wbia_cnn.models.classifier2" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="wbia_cnn.models.classifier2.Classifier2Model">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.classifier2.</code><code class="sig-name descname">Classifier2Model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">autoinit</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">128</span></em>, <em class="sig-param"><span class="n">data_shape</span><span class="o">=</span><span class="default_value">64, 64, 3</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">'classifier2'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier2.html#Classifier2Model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.classifier2.Classifier2Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.AbstractVectorModel" title="wbia_cnn.models.abstract_models.AbstractVectorModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.AbstractVectorModel</span></code></a></p>
<dl class="py method">
<dt id="wbia_cnn.models.classifier2.Classifier2Model.augment">
<code class="sig-name descname">augment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Xb</span></em>, <em class="sig-param"><span class="n">yb</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">parallel</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier2.html#Classifier2Model.augment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.classifier2.Classifier2Model.augment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.classifier2.Classifier2Model.get_classifier2_def">
<code class="sig-name descname">get_classifier2_def</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier2.html#Classifier2Model.get_classifier2_def"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.classifier2.Classifier2Model.get_classifier2_def" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.classifier2.Classifier2Model.init_arch">
<code class="sig-name descname">init_arch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier2.html#Classifier2Model.init_arch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.classifier2.Classifier2Model.init_arch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.classifier2.Classifier2Model.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.classifier2.Classifier2Model.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.classifier2.augment_parallel">
<code class="sig-prename descclassname">wbia_cnn.models.classifier2.</code><code class="sig-name descname">augment_parallel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier2.html#augment_parallel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.classifier2.augment_parallel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.classifier2.augment_wrapper">
<code class="sig-prename descclassname">wbia_cnn.models.classifier2.</code><code class="sig-name descname">augment_wrapper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Xb</span></em>, <em class="sig-param"><span class="n">yb</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier2.html#augment_wrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.classifier2.augment_wrapper" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.classifier2.train_classifier2">
<code class="sig-prename descclassname">wbia_cnn.models.classifier2.</code><code class="sig-name descname">train_classifier2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">output_path</span></em>, <em class="sig-param"><span class="n">data_fpath</span></em>, <em class="sig-param"><span class="n">labels_fpath</span></em>, <em class="sig-param"><span class="n">purge</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier2.html#train_classifier2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.classifier2.train_classifier2" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.train –test-train_classifier2</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.train</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">train_classifier2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-wbia_cnn.models.dummy">
<span id="wbia-cnn-models-dummy-module"></span><h2>wbia_cnn.models.dummy module<a class="headerlink" href="#module-wbia_cnn.models.dummy" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="wbia_cnn.models.dummy.DummyModel">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.dummy.</code><code class="sig-name descname">DummyModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">8</span></em>, <em class="sig-param"><span class="n">data_shape</span><span class="o">=</span><span class="default_value">4, 4, 1</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/dummy.html#DummyModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.dummy.DummyModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel" title="wbia_cnn.models.abstract_models.AbstractCategoricalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.AbstractCategoricalModel</span></code></a></p>
<dl class="py method">
<dt id="wbia_cnn.models.dummy.DummyModel.init_arch">
<code class="sig-name descname">init_arch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/dummy.html#DummyModel.init_arch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.dummy.DummyModel.init_arch" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn DummyModel.init_arch –verbcnn –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.dummy</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">DummyModel</span><span class="p">(</span><span class="n">autoinit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">print_model_info_str</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">show_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.dummy.DummyModel.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.dummy.DummyModel.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-wbia_cnn.models.labeler">
<span id="wbia-cnn-models-labeler-module"></span><h2>wbia_cnn.models.labeler module<a class="headerlink" href="#module-wbia_cnn.models.labeler" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="wbia_cnn.models.labeler.LabelerModel">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.labeler.</code><code class="sig-name descname">LabelerModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">autoinit</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">128</span></em>, <em class="sig-param"><span class="n">data_shape</span><span class="o">=</span><span class="default_value">64, 64, 3</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">'labeler'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/labeler.html#LabelerModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.labeler.LabelerModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel" title="wbia_cnn.models.abstract_models.AbstractCategoricalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.AbstractCategoricalModel</span></code></a></p>
<dl class="py method">
<dt id="wbia_cnn.models.labeler.LabelerModel.augment">
<code class="sig-name descname">augment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Xb</span></em>, <em class="sig-param"><span class="n">yb</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">parallel</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/labeler.html#LabelerModel.augment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.labeler.LabelerModel.augment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.labeler.LabelerModel.get_labeler_def">
<code class="sig-name descname">get_labeler_def</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/labeler.html#LabelerModel.get_labeler_def"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.labeler.LabelerModel.get_labeler_def" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.labeler.LabelerModel.init_arch">
<code class="sig-name descname">init_arch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/labeler.html#LabelerModel.init_arch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.labeler.LabelerModel.init_arch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.labeler.LabelerModel.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.labeler.LabelerModel.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.labeler.augment_parallel">
<code class="sig-prename descclassname">wbia_cnn.models.labeler.</code><code class="sig-name descname">augment_parallel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/labeler.html#augment_parallel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.labeler.augment_parallel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.labeler.augment_wrapper">
<code class="sig-prename descclassname">wbia_cnn.models.labeler.</code><code class="sig-name descname">augment_wrapper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Xb</span></em>, <em class="sig-param"><span class="n">yb</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/labeler.html#augment_wrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.labeler.augment_wrapper" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.labeler.train_labeler">
<code class="sig-prename descclassname">wbia_cnn.models.labeler.</code><code class="sig-name descname">train_labeler</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">output_path</span></em>, <em class="sig-param"><span class="n">data_fpath</span></em>, <em class="sig-param"><span class="n">labels_fpath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/labeler.html#train_labeler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.labeler.train_labeler" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.train –test-train_labeler</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.train</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">train_labeler</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-wbia_cnn.models.mnist">
<span id="wbia-cnn-models-mnist-module"></span><h2>wbia_cnn.models.mnist module<a class="headerlink" href="#module-wbia_cnn.models.mnist" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="wbia_cnn.models.mnist.MNISTModel">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.mnist.</code><code class="sig-name descname">MNISTModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/mnist.html#MNISTModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.mnist.MNISTModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel" title="wbia_cnn.models.abstract_models.AbstractCategoricalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.AbstractCategoricalModel</span></code></a></p>
<p>Toy model for testing and playing with mnist</p>
<dl>
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.mnist MNISTModel:0
python -m wbia_cnn.models.mnist MNISTModel:1</p>
<p>python -m wbia_cnn _ModelFitting.fit:0 –vd –monitor
python -m wbia_cnn _ModelFitting.fit:1 –vd</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.mnist</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">ingest_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">ingest_data</span><span class="o">.</span><span class="n">grab_mnist_category_dataset_float</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MNISTModel</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">data_shape</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">data_shape</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">output_dims</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">output_dims</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">training_dpath</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">training_dpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">print_model_info_str</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;FAST_COMPILE&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">build_backprop_func</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.mnist</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="n">mnist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">testdata_mnist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">print_layer_info</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">print_model_info_str</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#model.reinit_weights()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">print_layer_info</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># parse training arguments</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">monitor_config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">ut</span><span class="o">.</span><span class="n">argparse_dict</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">era_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">max_epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">rate_schedule</span><span class="o">=.</span><span class="mi">8</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="wbia_cnn.models.mnist.MNISTModel.augment">
<code class="sig-name descname">augment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Xb</span></em>, <em class="sig-param"><span class="n">yb</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/mnist.html#MNISTModel.augment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.mnist.MNISTModel.augment" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.mnist MNISTModel.augment –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.mnist</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="n">mnist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">testdata_mnist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">_rng</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ensure_rng</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">hyperparams</span><span class="p">[</span><span class="s1">&#39;random_seed&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_valid</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb</span> <span class="o">=</span> <span class="n">X_valid</span><span class="p">[:</span><span class="n">num</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yb</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb</span> <span class="o">=</span> <span class="n">Xb</span> <span class="o">/</span> <span class="mf">255.0</span> <span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">is_int</span><span class="p">(</span><span class="n">Xb</span><span class="p">)</span> <span class="k">else</span> <span class="n">Xb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb</span> <span class="o">=</span> <span class="n">Xb</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yb</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">yb</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">yb</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Rescale the batch data to the range 0 to 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb_</span><span class="p">,</span> <span class="n">yb_</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">Xb</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yb_</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">qt4ensure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">augment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">augment</span><span class="o">.</span><span class="n">show_augmented_patches</span><span class="p">(</span><span class="n">Xb</span><span class="p">,</span> <span class="n">Xb_</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">yb_</span><span class="p">,</span> <span class="n">data_per_label</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.mnist.MNISTModel.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/mnist.html#MNISTModel.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.mnist.MNISTModel.fit" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.mnist MNISTModel.fit –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.mnist</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="n">mnist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">testdata_mnist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># parse training arguments</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">monitor_config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">ut</span><span class="o">.</span><span class="n">argparse_dict</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">era_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">max_epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">rate_schedule</span><span class="o">=.</span><span class="mi">9</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.mnist.MNISTModel.get_inception_def">
<code class="sig-name descname">get_inception_def</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/mnist.html#MNISTModel.get_inception_def"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.mnist.MNISTModel.get_inception_def" title="Permalink to this definition">¶</a></dt>
<dd><p>python -m wbia_cnn MNISTModel.init_arch –verbcnn –name=resnet –show
python -m wbia_cnn.models.mnist MNISTModel.fit:0 –name=resnet –vd –monitor</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.mnist.MNISTModel.get_lenet_def">
<code class="sig-name descname">get_lenet_def</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/mnist.html#MNISTModel.get_lenet_def"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.mnist.MNISTModel.get_lenet_def" title="Permalink to this definition">¶</a></dt>
<dd><p>python -m wbia_cnn MNISTModel.init_arch –verbcnn –name=lenet –show
python -m wbia_cnn.models.mnist MNISTModel.fit:0 –name=lenet –vd –monitor</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.mnist.MNISTModel.get_mnist_def">
<code class="sig-name descname">get_mnist_def</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/mnist.html#MNISTModel.get_mnist_def"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.mnist.MNISTModel.get_mnist_def" title="Permalink to this definition">¶</a></dt>
<dd><p>Follows <a class="reference external" href="https://github.com/Lasagne/Lasagne/blob/master/examples/mnist.py">https://github.com/Lasagne/Lasagne/blob/master/examples/mnist.py</a></p>
<p>python -m wbia_cnn MNISTModel.init_arch –verbcnn –name=mnist –show
python -m wbia_cnn.models.mnist MNISTModel.fit:0 –name=mnist –vd –monitor</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.mnist.MNISTModel.get_resnet_def">
<code class="sig-name descname">get_resnet_def</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/mnist.html#MNISTModel.get_resnet_def"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.mnist.MNISTModel.get_resnet_def" title="Permalink to this definition">¶</a></dt>
<dd><p>A residual network with pre-activations</p>
<p>python -m wbia_cnn MNISTModel.init_arch –verbcnn –name=resnet –show
python -m wbia_cnn.models.mnist MNISTModel.fit:0 –name=resnet –vd –monitor</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.mnist.MNISTModel.init_arch">
<code class="sig-name descname">init_arch</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/mnist.html#MNISTModel.init_arch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.mnist.MNISTModel.init_arch" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn  MNISTModel.init_arch –verbcnn
python -m wbia_cnn  MNISTModel.init_arch –verbcnn –show</p>
<p>python -m wbia_cnn  MNISTModel.init_arch –verbcnn –name=bnorm –show
python -m wbia_cnn  MNISTModel.init_arch –verbcnn –name=incep –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.mnist</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--name&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;bnorm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MNISTModel</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">data_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">output_dims</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">print_model_info_str</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">show_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.mnist.MNISTModel.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.mnist.MNISTModel.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.mnist.testdata_mnist">
<code class="sig-prename descclassname">wbia_cnn.models.mnist.</code><code class="sig-name descname">testdata_mnist</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">defaultname</span><span class="o">=</span><span class="default_value">'lenet'</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">128</span></em>, <em class="sig-param"><span class="n">dropout</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/mnist.html#testdata_mnist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.mnist.testdata_mnist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-wbia_cnn.models.pretrained">
<span id="wbia-cnn-models-pretrained-module"></span><h2>wbia_cnn.models.pretrained module<a class="headerlink" href="#module-wbia_cnn.models.pretrained" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="wbia_cnn.models.pretrained.PretrainedNetwork">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.pretrained.</code><code class="sig-name descname">PretrainedNetwork</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model_key</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">show_network</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/pretrained.html#PretrainedNetwork"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.pretrained.PretrainedNetwork" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>TODO: move to new class</p>
<p>Intialize weights from a specified (Caffe) pretrained network layers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>layer</strong> (<em>int</em>) – int</p>
</dd>
</dl>
<dl>
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn –tf PretrainedNetwork:0
python -m wbia_cnn –tf PretrainedNetwork:1</p>
</dd>
<dt>Example0:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">PretrainedNetwork</span><span class="p">(</span><span class="s1">&#39;caffenet&#39;</span><span class="p">,</span> <span class="n">show_network</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Example1:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">PretrainedNetwork</span><span class="p">(</span><span class="s1">&#39;vggnet&#39;</span><span class="p">,</span> <span class="n">show_network</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt id="wbia_cnn.models.pretrained.PretrainedNetwork.get_conv2d_layer">
<code class="sig-name descname">get_conv2d_layer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">layer_index</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/pretrained.html#PretrainedNetwork.get_conv2d_layer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.pretrained.PretrainedNetwork.get_conv2d_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Assumes requested layer is convolutional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Layer</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>lasagne.layers.Layer</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.pretrained.PretrainedNetwork.get_layer_filter_size">
<code class="sig-name descname">get_layer_filter_size</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">layer_index</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/pretrained.html#PretrainedNetwork.get_layer_filter_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.pretrained.PretrainedNetwork.get_layer_filter_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.pretrained.PretrainedNetwork.get_layer_num_filters">
<code class="sig-name descname">get_layer_num_filters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">layer_index</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/pretrained.html#PretrainedNetwork.get_layer_num_filters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.pretrained.PretrainedNetwork.get_layer_num_filters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.pretrained.PretrainedNetwork.get_num_layers">
<code class="sig-name descname">get_num_layers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/pretrained.html#PretrainedNetwork.get_num_layers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.pretrained.PretrainedNetwork.get_num_layers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.pretrained.PretrainedNetwork.get_pretrained_layer">
<code class="sig-name descname">get_pretrained_layer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">layer_index</span></em>, <em class="sig-param"><span class="n">rand</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/pretrained.html#PretrainedNetwork.get_pretrained_layer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.pretrained.PretrainedNetwork.get_pretrained_layer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-wbia_cnn.models.quality">
<span id="wbia-cnn-models-quality-module"></span><h2>wbia_cnn.models.quality module<a class="headerlink" href="#module-wbia_cnn.models.quality" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="wbia_cnn.models.quality.QualityModel">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.quality.</code><code class="sig-name descname">QualityModel</code><a class="reference internal" href="_modules/wbia_cnn/models/quality.html#QualityModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.quality.QualityModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel" title="wbia_cnn.models.abstract_models.AbstractCategoricalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.AbstractCategoricalModel</span></code></a></p>
<dl class="py method">
<dt id="wbia_cnn.models.quality.QualityModel.build_model">
<code class="sig-name descname">build_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_size</span></em>, <em class="sig-param"><span class="n">input_width</span></em>, <em class="sig-param"><span class="n">input_height</span></em>, <em class="sig-param"><span class="n">input_channels</span></em>, <em class="sig-param"><span class="n">output_dims</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/quality.html#QualityModel.build_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.quality.QualityModel.build_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.quality.QualityModel.label_order_mapping">
<code class="sig-name descname">label_order_mapping</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">category_list</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/quality.html#QualityModel.label_order_mapping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.quality.QualityModel.label_order_mapping" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.quality.QualityModel.learning_rate_shock">
<code class="sig-name descname">learning_rate_shock</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/quality.html#QualityModel.learning_rate_shock"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.quality.QualityModel.learning_rate_shock" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.quality.QualityModel.learning_rate_update">
<code class="sig-name descname">learning_rate_update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/quality.html#QualityModel.learning_rate_update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.quality.QualityModel.learning_rate_update" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.quality.QualityModel.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.quality.QualityModel.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-wbia_cnn.models.siam">
<span id="wbia-cnn-models-siam-module"></span><h2>wbia_cnn.models.siam module<a class="headerlink" href="#module-wbia_cnn.models.siam" title="Permalink to this headline">¶</a></h2>
<p>Siamese based models</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://yann.lecun.com/exdb/publis/pdf/hadsell-chopra-lecun-06.pdf">http://yann.lecun.com/exdb/publis/pdf/hadsell-chopra-lecun-06.pdf</a>
<a class="reference external" href="https://github.com/BVLC/caffe/pull/959">https://github.com/BVLC/caffe/pull/959</a>
<a class="reference external" href="http://yann.lecun.com/exdb/publis/pdf/chopra-05.pdf">http://yann.lecun.com/exdb/publis/pdf/chopra-05.pdf</a>
<a class="reference external" href="http://www.commendo.at/references/files/paperCVWW08.pdf">http://www.commendo.at/references/files/paperCVWW08.pdf</a>
<a class="reference external" href="https://tspace.library.utoronto.ca/bitstream/1807/43097/3/Liu_Chen_201311_MASc_thesis.pdf">https://tspace.library.utoronto.ca/bitstream/1807/43097/3/Liu_Chen_201311_MASc_thesis.pdf</a>
<a class="reference external" href="http://arxiv.org/pdf/1412.6622.pdf">http://arxiv.org/pdf/1412.6622.pdf</a>
<a class="reference external" href="http://papers.nips.cc/paper/4314-extracting-speaker-specific-information-with-a-regularized-siamese-deep-network.pdf">http://papers.nips.cc/paper/4314-extracting-speaker-specific-information-with-a-regularized-siamese-deep-network.pdf</a>
<a class="reference external" href="http://machinelearning.wustl.edu/mlpapers/paper_files/NIPS2005_265.pdf">http://machinelearning.wustl.edu/mlpapers/paper_files/NIPS2005_265.pdf</a>
<a class="reference external" href="http://vision.ia.ac.cn/zh/senimar/reports/Siamese-Network-Architecture-and-Applications-in-Computer-Vision.pdf">http://vision.ia.ac.cn/zh/senimar/reports/Siamese-Network-Architecture-and-Applications-in-Computer-Vision.pdf</a></p>
<p><a class="reference external" href="https://groups.google.com/forum/#!topic/caffe-users/D-7sRDw9v8c">https://groups.google.com/forum/#!topic/caffe-users/D-7sRDw9v8c</a>
<a class="reference external" href="http://caffe.berkeleyvision.org/gathered/examples/siamese.html">http://caffe.berkeleyvision.org/gathered/examples/siamese.html</a>
<a class="reference external" href="https://groups.google.com/forum/#!topic/lasagne-users/N9zDNvNkyWY">https://groups.google.com/forum/#!topic/lasagne-users/N9zDNvNkyWY</a>
<a class="reference external" href="http://www.cs.nyu.edu/~sumit/research/research.html">http://www.cs.nyu.edu/~sumit/research/research.html</a>
<a class="reference external" href="https://github.com/Lasagne/Lasagne/issues/168">https://github.com/Lasagne/Lasagne/issues/168</a>
<a class="reference external" href="https://groups.google.com/forum/#!topic/lasagne-users/7JX_8zKfDI0">https://groups.google.com/forum/#!topic/lasagne-users/7JX_8zKfDI0</a></p>
<dl class="py class">
<dt id="wbia_cnn.models.siam.AbstractSiameseModel">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.siam.</code><code class="sig-name descname">AbstractSiameseModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#AbstractSiameseModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.siam.AbstractSiameseModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.BaseModel" title="wbia_cnn.models.abstract_models.BaseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.BaseModel</span></code></a></p>
<dl class="py method">
<dt id="wbia_cnn.models.siam.AbstractSiameseModel.augment">
<code class="sig-name descname">augment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Xb</span></em>, <em class="sig-param"><span class="n">yb</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#AbstractSiameseModel.augment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.siam.AbstractSiameseModel.augment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.siam.AbstractSiameseModel.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.siam.AbstractSiameseModel.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="wbia_cnn.models.siam.SiameseCenterSurroundModel">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.siam.</code><code class="sig-name descname">SiameseCenterSurroundModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">autoinit</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">128</span></em>, <em class="sig-param"><span class="n">input_shape</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_shape</span><span class="o">=</span><span class="default_value">64, 64, 3</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseCenterSurroundModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseCenterSurroundModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.siam.AbstractSiameseModel" title="wbia_cnn.models.siam.AbstractSiameseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.siam.AbstractSiameseModel</span></code></a></p>
<p>Model for individual identification</p>
<dl class="py method">
<dt id="wbia_cnn.models.siam.SiameseCenterSurroundModel.get_2ch2stream_def">
<code class="sig-name descname">get_2ch2stream_def</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseCenterSurroundModel.get_2ch2stream_def"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseCenterSurroundModel.get_2ch2stream_def" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Notes</p>
<ol class="lowerroman">
<li><p>2ch-2stream consists of two branches
C(95, 5, 1)- ReLU- P(2, 2)- C(96, 3, 1)- ReLU- P(2, 2)- C(192, 3, 1)-</p>
<blockquote>
<div><p>ReLU- C(192, 3, 1)- ReLU,</p>
</div></blockquote>
<p>one for central and one for surround parts, followed by
F(768)- ReLU- F(1)</p>
</li>
</ol>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.siam.SiameseCenterSurroundModel.get_siam2stream_def">
<code class="sig-name descname">get_siam2stream_def</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseCenterSurroundModel.get_siam2stream_def"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseCenterSurroundModel.get_siam2stream_def" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Notes</p>
<ol class="lowerroman simple" start="8">
<li><p>siam-2stream has 4 branches</p></li>
</ol>
<blockquote>
<div><dl class="simple">
<dt>C(96, 4, 2)- ReLU- P(2, 2)- C(192, 3, 1)- ReLU- C(256, 3, 1)- ReLU- C(256, 3, 1)-</dt><dd><p>ReLU</p>
</dd>
</dl>
<p>(coupled in pairs for central and surround streams, and decision layer)
F(512)-ReLU- F(1)</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.siam.SiameseCenterSurroundModel.get_siam2stream_l2_def">
<code class="sig-name descname">get_siam2stream_l2_def</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseCenterSurroundModel.get_siam2stream_l2_def"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseCenterSurroundModel.get_siam2stream_l2_def" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Notes</p>
<ol class="lowerroman simple" start="9">
<li><p>siam-2stream-l2 consists of one central and one surround</p></li>
</ol>
<blockquote>
<div><p>branch of siam-2stream.</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.siam.SiameseCenterSurroundModel.init_arch">
<code class="sig-name descname">init_arch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseCenterSurroundModel.init_arch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseCenterSurroundModel.init_arch" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Notes</p>
<p><a class="reference external" href="http://arxiv.org/pdf/1504.03641.pdf">http://arxiv.org/pdf/1504.03641.pdf</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.siam –test-SiameseCenterSurroundModel.init_arch
python -m wbia_cnn.models.siam –test-SiameseCenterSurroundModel.init_arch –verbcnn
python -m wbia_cnn.models.siam –test-SiameseCenterSurroundModel.init_arch –verbcnn –show
python -m wbia_cnn.train –test-pz_patchmatch –vtd –max-examples=5 –batch_size=128 –learning_rate .0000001 –verbcnn
python -m wbia_cnn.train –test-pz_patchmatch –vtd</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">SiameseCenterSurroundModel</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">print_model_info_str</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">output_layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">show_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.siam.SiameseCenterSurroundModel.learn_encoder">
<code class="sig-name descname">learn_encoder</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">labels</span></em>, <em class="sig-param"><span class="n">scores</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseCenterSurroundModel.learn_encoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseCenterSurroundModel.learn_encoder" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.siam.SiameseCenterSurroundModel.loss_function">
<code class="sig-name descname">loss_function</code><span class="sig-paren">(</span><em class="sig-param">network_output</em>, <em class="sig-param">Y</em>, <em class="sig-param">T=&lt;module 'theano.tensor' from '/Users/jason.parham/virtualenv/wildme3.7/lib/python3.7/site-packages/Theano-1.0.5-py3.7.egg/theano/tensor/__init__.py'&gt;</em>, <em class="sig-param">verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseCenterSurroundModel.loss_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseCenterSurroundModel.loss_function" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.siam –test-loss_function
python -m wbia_cnn.models.siam –test-loss_function:1 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">ingest_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">batch_processing</span> <span class="k">as</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ingest_data</span><span class="o">.</span><span class="n">testdata_patchmatch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">SiameseCenterSurroundModel</span><span class="p">(</span><span class="n">autoinit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">128</span><span class="p">,)</span> <span class="o">+</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theano_forward</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">create_unbuffered_network_output_func</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_size</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">batch_size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">batch_size</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">data_per_label_input</span><span class="p">],</span> <span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">batch_size</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">network_output</span> <span class="o">=</span> <span class="n">theano_forward</span><span class="p">(</span><span class="n">Xb</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">network_output</span> <span class="o">=</span> <span class="n">network_output</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">yb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg_loss</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">loss_function</span><span class="p">(</span><span class="n">network_output</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">avg_loss</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<dl>
<dt>Example1:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">network_output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">network_output</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">network_output</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span> <span class="o">=</span> <span class="n">SiameseCenterSurroundModel</span><span class="o">.</span><span class="n">loss_function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss0</span><span class="p">,</span> <span class="n">Y0_</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="nb">locals</span><span class="p">(),</span> <span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="s1">&#39;Y_&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss1</span><span class="p">,</span> <span class="n">Y1_</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="nb">locals</span><span class="p">(),</span> <span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="s1">&#39;Y_&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">Y1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">Y1_</span> <span class="o">==</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;bad label mapping&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">Y0</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">Y0_</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;bad label mapping&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">network_output</span><span class="p">,</span> <span class="n">loss0</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">TRUE_BLUE</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;imposter_loss&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;network output&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">network_output</span><span class="p">,</span> <span class="n">loss1</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">FALSE_RED</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;genuine_loss&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;network output&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.siam.SiameseCenterSurroundModel.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.siam.SiameseCenterSurroundModel.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="wbia_cnn.models.siam.SiameseL2">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.siam.</code><code class="sig-name descname">SiameseL2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">autoinit</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">128</span></em>, <em class="sig-param"><span class="n">data_shape</span><span class="o">=</span><span class="default_value">64, 64, 3</span></em>, <em class="sig-param"><span class="n">arch_tag</span><span class="o">=</span><span class="default_value">'siaml2'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseL2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseL2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.siam.AbstractSiameseModel" title="wbia_cnn.models.siam.AbstractSiameseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.siam.AbstractSiameseModel</span></code></a></p>
<p>Model for individual identification</p>
<dl class="py method">
<dt id="wbia_cnn.models.siam.SiameseL2.get_mnist_siaml2_def">
<code class="sig-name descname">get_mnist_siaml2_def</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseL2.get_mnist_siaml2_def"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseL2.get_mnist_siaml2_def" title="Permalink to this definition">¶</a></dt>
<dd><p>python -m wbia_cnn –tf  SiameseL2.init_arch –archtag mnist_siaml2 –datashape=28,28,1 –verbose  –show</p>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.siam.SiameseL2.get_siam2streaml2_def">
<code class="sig-name descname">get_siam2streaml2_def</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseL2.get_siam2streaml2_def"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseL2.get_siam2streaml2_def" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Notes</p>
<ol class="lowerroman simple" start="9">
<li><p>siam-2stream-l2 consists of one central and one surround</p></li>
</ol>
<blockquote>
<div><p>branch of siam-2stream.</p>
<p>C0(96, 7, 3) - ReLU - P0(2, 2) - C1(192, 5, 1) - ReLU - P1(2, 2) - C2(256, 3, 1)</p>
</div></blockquote>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn –tf  SiameseL2.init_arch –archtag siam2streaml2 –datashape=64,64,1 –verbose  –show</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.siam.SiameseL2.get_siam_deepfaceish_def">
<code class="sig-name descname">get_siam_deepfaceish_def</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseL2.get_siam_deepfaceish_def"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseL2.get_siam_deepfaceish_def" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn –tf  SiameseL2.init_arch –archtag siam_deepfaceish –datashape=128,256,1 –verbose  –show
python -m wbia_cnn –tf  SiameseL2.init_arch –archtag siam_deepface –datashape=152,152,3 –verbose  –show</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.siam.SiameseL2.get_siaml2_128_def">
<code class="sig-name descname">get_siaml2_128_def</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseL2.get_siaml2_128_def"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseL2.get_siaml2_128_def" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Notes</p>
<ol class="lowerroman simple" start="9">
<li><p>siam-2stream-l2 consists of one central and one surround</p></li>
</ol>
<blockquote>
<div><p>branch of siam-2stream.</p>
<p>C0(96, 7, 3) - ReLU - P0(2, 2) - C1(192, 5, 1) - ReLU - P1(2, 2) - C2(256, 3, 1)</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.siam.SiameseL2.get_siaml2_def">
<code class="sig-name descname">get_siaml2_def</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseL2.get_siaml2_def"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseL2.get_siaml2_def" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Notes</p>
<ol class="lowerroman simple" start="9">
<li><p>siam-2stream-l2 consists of one central and one surround</p></li>
</ol>
<blockquote>
<div><p>branch of siam-2stream.</p>
<p>C0(96, 7, 3) - ReLU - P0(2, 2) - C1(192, 5, 1) - ReLU - P1(2, 2) - C2(256, 3, 1)</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.siam.SiameseL2.get_siaml2_partmatch_def">
<code class="sig-name descname">get_siaml2_partmatch_def</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseL2.get_siaml2_partmatch_def"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseL2.get_siaml2_partmatch_def" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn –tf  SiameseL2.init_arch –archtag siaml2_partmatch –datashape=128,256,1 –verbose  –show</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.siam.SiameseL2.init_arch">
<code class="sig-name descname">init_arch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseL2.init_arch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseL2.init_arch" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Notes</p>
<p><a class="reference external" href="http://arxiv.org/pdf/1504.03641.pdf">http://arxiv.org/pdf/1504.03641.pdf</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.siam –test-SiameseL2.init_arch –verbcnn –show
python -m wbia_cnn –tf  SiameseL2.init_arch –verbcnn –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.siam</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arch_tag</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--archtag&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;siaml2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_shape</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--datashape&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">SiameseL2</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">data_shape</span><span class="o">=</span><span class="n">data_shape</span><span class="p">,</span> <span class="n">arch_tag</span><span class="o">=</span><span class="n">arch_tag</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">print_model_info_str</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">show_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.siam.SiameseL2.learn_encoder">
<code class="sig-name descname">learn_encoder</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">labels</span></em>, <em class="sig-param"><span class="n">scores</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseL2.learn_encoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseL2.learn_encoder" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.siam.SiameseL2.loss_function">
<code class="sig-name descname">loss_function</code><span class="sig-paren">(</span><em class="sig-param">network_output</em>, <em class="sig-param">labels</em>, <em class="sig-param">T=&lt;module 'theano.tensor' from '/Users/jason.parham/virtualenv/wildme3.7/lib/python3.7/site-packages/Theano-1.0.5-py3.7.egg/theano/tensor/__init__.py'&gt;</em>, <em class="sig-param">verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseL2.loss_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseL2.loss_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements the contrastive loss term from (Hasdel, Chopra, LeCun 06)</p>
<dl>
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.siam –test-SiameseL2.loss_function –show</p>
</dd>
<dt>Example1:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">network_output</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_siam_desc</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span> <span class="o">=</span> <span class="n">SiameseL2</span><span class="o">.</span><span class="n">loss_function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span><span class="p">,</span> <span class="n">dist_l2</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="nb">locals</span><span class="p">(),</span> <span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="s1">&#39;dist_l2&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist0_l2</span> <span class="o">=</span> <span class="n">dist_l2</span><span class="p">[</span><span class="n">labels</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist1_l2</span> <span class="o">=</span> <span class="n">dist_l2</span><span class="p">[</span><span class="o">~</span><span class="n">labels</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss0</span> <span class="o">=</span> <span class="n">loss</span><span class="p">[</span><span class="n">labels</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss1</span> <span class="o">=</span> <span class="n">loss</span><span class="p">[</span><span class="o">~</span><span class="n">labels</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">dist0_l2</span><span class="p">,</span> <span class="n">loss0</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">TRUE_BLUE</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;imposter_loss&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;loss&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">dist1_l2</span><span class="p">,</span> <span class="n">loss1</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">FALSE_RED</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;genuine_loss&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;loss&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.siam.SiameseL2.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.siam.SiameseL2.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.siam.constrastive_loss">
<code class="sig-prename descclassname">wbia_cnn.models.siam.</code><code class="sig-name descname">constrastive_loss</code><span class="sig-paren">(</span><em class="sig-param">dist_l2</em>, <em class="sig-param">labels</em>, <em class="sig-param">margin</em>, <em class="sig-param">T=&lt;module 'theano.tensor' from '/Users/jason.parham/virtualenv/wildme3.7/lib/python3.7/site-packages/Theano-1.0.5-py3.7.egg/theano/tensor/__init__.py'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#constrastive_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.siam.constrastive_loss" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>LaTeX:</dt><dd><p>$(y E)^2 + ((1 - y) max(m - E, 0)^2)$</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist_l2</strong> (<em>ndarray</em>) – energy of a training example (l2 distance of descriptor pairs)</p></li>
<li><p><strong>labels</strong> (<em>ndarray</em>) – 1 if genuine pair, 0 if imposter pair</p></li>
<li><p><strong>margin</strong> (<em>float</em>) – positive number</p></li>
<li><p><strong>T</strong> (<em>module</em>) – (default = theano.tensor)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>loss</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Carefull, you need to pass the the euclidean distance in here here, NOT
the squared euclidean distance otherwise you end up with
T.maximum(0, (m ** 2 - 2 * m * d + d ** 2)),
which still requires the square root operation</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.siam –test-constrastive_loss –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.siam</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_l2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># margin, T = 1.25, np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">margin</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="mf">1.25</span><span class="p">,</span> <span class="n">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span> <span class="o">=</span> <span class="n">constrastive_loss</span><span class="p">(</span><span class="n">dist_l2</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">margin</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">plottool</span> <span class="k">as</span> <span class="nn">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdat_genuine</span><span class="p">,</span> <span class="n">ydat_genuine</span> <span class="o">=</span> <span class="n">dist_l2</span><span class="p">[</span><span class="n">labels</span><span class="p">],</span> <span class="n">loss</span><span class="p">[</span><span class="n">labels</span><span class="p">]</span> <span class="o">*</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdat_imposter</span><span class="p">,</span> <span class="n">ydat_imposter</span> <span class="o">=</span> <span class="n">dist_l2</span><span class="p">[</span><span class="o">~</span><span class="n">labels</span><span class="p">],</span> <span class="n">loss</span><span class="p">[</span><span class="o">~</span><span class="n">labels</span><span class="p">]</span> <span class="o">*</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.presetup_axes(x_label=&#39;Energy (D_w)&#39;, y_label=&#39;Loss (L)&#39;, equal_aspect=False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">presetup_axes</span><span class="p">(</span><span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;Energy (E)&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;Loss (L)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdat_genuine</span><span class="p">,</span> <span class="n">ydat_genuine</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">TRUE</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Correct training pairs&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdat_imposter</span><span class="p">,</span> <span class="n">ydat_imposter</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">FALSE</span><span class="p">,</span>  <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Incorrect training pairs&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">pad_axes</span><span class="p">(</span><span class="o">.</span><span class="mi">03</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">postsetup_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.siam.ignore_hardest_cases">
<code class="sig-prename descclassname">wbia_cnn.models.siam.</code><code class="sig-name descname">ignore_hardest_cases</code><span class="sig-paren">(</span><em class="sig-param">loss</em>, <em class="sig-param">labels</em>, <em class="sig-param">num_ignore=3</em>, <em class="sig-param">T=&lt;module 'theano.tensor' from '/Users/jason.parham/virtualenv/wildme3.7/lib/python3.7/site-packages/Theano-1.0.5-py3.7.egg/theano/tensor/__init__.py'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#ignore_hardest_cases"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.siam.ignore_hardest_cases" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss</strong> (<em>theano.Tensor</em>) – </p></li>
<li><p><strong>labels</strong> (<em>theano.Tensor</em>) – </p></li>
<li><p><strong>num_ignore</strong> (<em>int</em>) – (default = 3)</p></li>
<li><p><strong>T</strong> (<em>module</em>) – (default = theano.tensor)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>loss</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>theano.Tensor</p>
</dd>
</dl>
<dl>
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.siam –test-ignore_hardest_cases:0
python -m wbia_cnn.models.siam –test-ignore_hardest_cases:1
python -m wbia_cnn.models.siam –test-ignore_hardest_cases:2</p>
</dd>
<dt>Example0:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Test numpy version</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.siam</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss_arr</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span>   <span class="o">=</span> <span class="n">loss_arr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="n">labels_arr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_ignore</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ignored_loss_arr</span> <span class="o">=</span> <span class="n">ignore_hardest_cases</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">num_ignore</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;ignored_loss_arr = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">ignored_loss_arr</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">ignored_loss = np.array([0, 1, 0, 3, 4, 5, 0, 0, 0], dtype=np.int32)</span>
</pre></div>
</div>
<dl>
<dt>Example1:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Test theano version</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.siam</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">theano.tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss_arr</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">theano</span><span class="o">.</span><span class="n">tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">ivector</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;loss&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">ivector</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;labels&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_ignore</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ignored_loss</span> <span class="o">=</span> <span class="n">ignore_hardest_cases</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">num_ignore</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ignored_loss_arr</span> <span class="o">=</span> <span class="n">ignored_loss</span><span class="o">.</span><span class="n">eval</span><span class="p">({</span><span class="n">loss</span><span class="p">:</span> <span class="n">loss_arr</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span> <span class="n">labels_arr</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;ignored_loss = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">ignored_loss_arr</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">ignored_loss = np.array([0, 1, 0, 3, 4, 5, 0, 0, 0], dtype=np.int32)</span>
</pre></div>
</div>
</dd>
</dl>
</dd>
<dt>Example2:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Test version compatiblity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.siam</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia_cnn.theano_ext</span> <span class="k">as</span> <span class="nn">theano_ext</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">theano.tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss_arr</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">ivector</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;loss&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">ivector</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;labels&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_ignore</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build numpy targets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numpy_locals</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;np&#39;</span><span class="p">:</span> <span class="n">np</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="n">np</span><span class="p">,</span> <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="n">loss_arr</span><span class="p">,</span> <span class="s1">&#39;labels&#39;</span><span class="p">:</span> <span class="n">labels_arr</span><span class="p">,</span> <span class="s1">&#39;num_ignore&#39;</span><span class="p">:</span> <span class="n">num_ignore</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span> <span class="o">=</span> <span class="n">ignore_hardest_cases</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numpy_vars</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="p">{},</span> <span class="n">numpy_locals</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numpy_targets</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">delete_dict_keys</span><span class="p">(</span><span class="n">numpy_vars</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;__doc__&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;np&#39;</span><span class="p">,</span> <span class="s1">&#39;num_ignore&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build theano functions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theano_locals</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;np&#39;</span><span class="p">:</span> <span class="n">np</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="n">theano</span><span class="o">.</span><span class="n">tensor</span><span class="p">,</span> <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="n">loss</span><span class="p">,</span> <span class="s1">&#39;labels&#39;</span><span class="p">:</span> <span class="n">labels</span><span class="p">,</span> <span class="s1">&#39;num_ignore&#39;</span><span class="p">:</span> <span class="n">num_ignore</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span> <span class="o">=</span> <span class="n">ignore_hardest_cases</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theano_vars</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="p">{},</span> <span class="n">theano_locals</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theano_symbols</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">delete_dict_keys</span><span class="p">(</span><span class="n">theano_vars</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;__doc__&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;np&#39;</span><span class="p">,</span> <span class="s1">&#39;num_ignore&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inputs_to_value</span> <span class="o">=</span> <span class="p">{</span><span class="n">loss</span><span class="p">:</span> <span class="n">loss_arr</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span> <span class="n">labels_arr</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evalute and test consistency</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key_order</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">theano_symbols</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theano_values</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noerror</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">key_order</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">symbol</span> <span class="o">=</span> <span class="n">theano_symbols</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;key=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,))</span>
<span class="gp">... </span>    <span class="n">theano_value</span> <span class="o">=</span> <span class="n">theano_ext</span><span class="o">.</span><span class="n">eval_symbol</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="n">inputs_to_value</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">theano_values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">theano_value</span>
<span class="gp">... </span>    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;  * &#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">theano_values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="n">numpy_targets</span><span class="p">[</span><span class="n">key</span><span class="p">]):</span>
<span class="gp">... </span>        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39; !!! &#39;</span>
<span class="gp">... </span>        <span class="n">noerror</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">... </span>    <span class="c1"># Cast to compatible dtype</span>
<span class="gp">... </span>    <span class="n">numpy_value</span> <span class="o">=</span> <span class="n">numpy_targets</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">result_dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">result_type</span><span class="p">(</span><span class="n">numpy_value</span><span class="p">,</span> <span class="n">theano_value</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">numpy_value</span> <span class="o">=</span> <span class="n">numpy_value</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">result_dtype</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">theano_value</span> <span class="o">=</span> <span class="n">theano_value</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">result_dtype</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">numpy_targets</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy_value</span>
<span class="gp">... </span>    <span class="n">theano_values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">theano_value</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="s1">&#39;numpy_value  = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">numpy_value</span><span class="p">,))</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="s1">&#39;theano_value = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">theano_value</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;numpy_targets = &#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="n">numpy_targets</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;theano_values = &#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="n">theano_values</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">noerror</span><span class="p">,</span> <span class="s1">&#39;There was an error&#39;</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.siam.predict">
<code class="sig-prename descclassname">wbia_cnn.models.siam.</code><code class="sig-name descname">predict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.siam.predict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.siam.testdata_siam_desc">
<code class="sig-prename descclassname">wbia_cnn.models.siam.</code><code class="sig-name descname">testdata_siam_desc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num_data</span><span class="o">=</span><span class="default_value">128</span></em>, <em class="sig-param"><span class="n">desc_dim</span><span class="o">=</span><span class="default_value">8</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#testdata_siam_desc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.siam.testdata_siam_desc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-wbia_cnn.models.viewpoint">
<span id="wbia-cnn-models-viewpoint-module"></span><h2>wbia_cnn.models.viewpoint module<a class="headerlink" href="#module-wbia_cnn.models.viewpoint" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="wbia_cnn.models.viewpoint.ViewpointModel">
<em class="property">class </em><code class="sig-prename descclassname">wbia_cnn.models.viewpoint.</code><code class="sig-name descname">ViewpointModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">autoinit</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">128</span></em>, <em class="sig-param"><span class="n">data_shape</span><span class="o">=</span><span class="default_value">96, 96, 3</span></em>, <em class="sig-param"><span class="n">arch_tag</span><span class="o">=</span><span class="default_value">'viewpoint'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/viewpoint.html#ViewpointModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.viewpoint.ViewpointModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel" title="wbia_cnn.models.abstract_models.AbstractCategoricalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.AbstractCategoricalModel</span></code></a></p>
<dl class="py method">
<dt id="wbia_cnn.models.viewpoint.ViewpointModel.augment">
<code class="sig-name descname">augment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Xb</span></em>, <em class="sig-param"><span class="n">yb</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/viewpoint.html#ViewpointModel.augment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.viewpoint.ViewpointModel.augment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.viewpoint.ViewpointModel.init_arch">
<code class="sig-name descname">init_arch</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/viewpoint.html#ViewpointModel.init_arch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.viewpoint.ViewpointModel.init_arch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.viewpoint.ViewpointModel.label_order_mapping">
<code class="sig-name descname">label_order_mapping</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">category_list</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/viewpoint.html#ViewpointModel.label_order_mapping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.viewpoint.ViewpointModel.label_order_mapping" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>category_list</strong> (<em>list</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>category_mapping</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><p>?</p>
</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.viewpoint –exec-label_order_mapping</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.viewpoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">ViewpointModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">category_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;LEFT&#39;</span><span class="p">,</span> <span class="s1">&#39;FRONT_LEFT&#39;</span><span class="p">,</span> <span class="s1">&#39;FRONT&#39;</span><span class="p">,</span> <span class="s1">&#39;FRONT_RIGHT&#39;</span><span class="p">,</span> <span class="s1">&#39;RIGHT&#39;</span><span class="p">,</span> <span class="s1">&#39;BACK_RIGHT&#39;</span><span class="p">,</span> <span class="s1">&#39;BACK&#39;</span><span class="p">,</span> <span class="s1">&#39;BACK_LEFT&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">category_mapping</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">label_order_mapping</span><span class="p">(</span><span class="n">category_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;category_mapping = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">category_mapping</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.viewpoint.ViewpointModel.learning_rate_shock">
<code class="sig-name descname">learning_rate_shock</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/viewpoint.html#ViewpointModel.learning_rate_shock"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.viewpoint.ViewpointModel.learning_rate_shock" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.viewpoint.ViewpointModel.learning_rate_update">
<code class="sig-name descname">learning_rate_update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/viewpoint.html#ViewpointModel.learning_rate_update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.viewpoint.ViewpointModel.learning_rate_update" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="wbia_cnn.models.viewpoint.ViewpointModel.rrr">
<code class="sig-name descname">rrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reload_module</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.viewpoint.ViewpointModel.rrr" title="Permalink to this definition">¶</a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-wbia_cnn.models">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-wbia_cnn.models" title="Permalink to this headline">¶</a></h2>
<dl class="py data">
<dt id="wbia_cnn.models.IMPORT_TUPLES">
<code class="sig-prename descclassname">wbia_cnn.models.</code><code class="sig-name descname">IMPORT_TUPLES</code><em class="property"> = [('_model_legacy', None), ('abstract_models', None), ('aoi2', None), ('background', None), ('classifier', None), ('classifier2', None), ('labeler', None), ('dummy', None), ('mnist', None), ('pretrained', None), ('quality', None), ('siam', None), ('viewpoint', None)]</em><a class="headerlink" href="#wbia_cnn.models.IMPORT_TUPLES" title="Permalink to this definition">¶</a></dt>
<dd><p>python -c “import wbia_cnn.models” –dump-wbia_cnn.models-init
python -c “import wbia_cnn.models” –update-wbia_cnn.models-init</p>
</dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.reassign_submodule_attributes">
<code class="sig-prename descclassname">wbia_cnn.models.</code><code class="sig-name descname">reassign_submodule_attributes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models.html#reassign_submodule_attributes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.reassign_submodule_attributes" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates attributes in the __init__ modules with updated attributes
in the submodules.</p>
</dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.reload_subs">
<code class="sig-prename descclassname">wbia_cnn.models.</code><code class="sig-name descname">reload_subs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models.html#reload_subs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#wbia_cnn.models.reload_subs" title="Permalink to this definition">¶</a></dt>
<dd><p>Reloads wbia_cnn.models and submodules</p>
</dd></dl>

<dl class="py function">
<dt id="wbia_cnn.models.rrrr">
<code class="sig-prename descclassname">wbia_cnn.models.</code><code class="sig-name descname">rrrr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.rrrr" title="Permalink to this definition">¶</a></dt>
<dd><p>Reloads wbia_cnn.models and submodules</p>
</dd></dl>

</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">wbia-cnn</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="wbia_cnn.html">wbia_cnn package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="wbia_cnn.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">wbia_cnn.models package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models._model_legacy">wbia_cnn.models._model_legacy module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.abstract_models">wbia_cnn.models.abstract_models module</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#netdir-training-dpath">|– netdir &lt;training_dpath&gt;</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.aoi">wbia_cnn.models.aoi module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.aoi2">wbia_cnn.models.aoi2 module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.background">wbia_cnn.models.background module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.classifier">wbia_cnn.models.classifier module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.classifier2">wbia_cnn.models.classifier2 module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.dummy">wbia_cnn.models.dummy module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.labeler">wbia_cnn.models.labeler module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.mnist">wbia_cnn.models.mnist module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.pretrained">wbia_cnn.models.pretrained module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.quality">wbia_cnn.models.quality module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.siam">wbia_cnn.models.siam module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.viewpoint">wbia_cnn.models.viewpoint module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.__main__">wbia_cnn.__main__ module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn._plugin">wbia_cnn._plugin module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn._plugin_grabmodels">wbia_cnn._plugin_grabmodels module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn._version">wbia_cnn._version module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.augment">wbia_cnn.augment module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.batch_processing">wbia_cnn.batch_processing module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#wbia-cnn-custom-layers-module">wbia_cnn.custom_layers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.dataset">wbia_cnn.dataset module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.draw_net">wbia_cnn.draw_net module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.draw_results">wbia_cnn.draw_results module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.experiments">wbia_cnn.experiments module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.harness">wbia_cnn.harness module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.ingest_data">wbia_cnn.ingest_data module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.ingest_helpers">wbia_cnn.ingest_helpers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.ingest_wbia">wbia_cnn.ingest_wbia module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.lasagne_ext">wbia_cnn.lasagne_ext module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.net_strs">wbia_cnn.net_strs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.netrun">wbia_cnn.netrun module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.process">wbia_cnn.process module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#wbia-cnn-sandbox-module">wbia_cnn.sandbox module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.test">wbia_cnn.test module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.theano_ext">wbia_cnn.theano_ext module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.utils">wbia_cnn.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn">Module contents</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="wbia_cnn.html">wbia_cnn package</a><ul>
      <li>Previous: <a href="wbia_cnn.html" title="previous chapter">wbia_cnn package</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Wild Me.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.2.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/wbia_cnn.models.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>