<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>wbia_cnn.models package &mdash; wbia-cnn 4.0.1.dev0+dirty documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="wbia_cnn package" href="wbia_cnn.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> wbia-cnn
          </a>
              <div class="version">
                4.0.1.dev0+dirty
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="wbia_cnn.html">wbia_cnn package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="wbia_cnn.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">wbia_cnn.models package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models._model_legacy">wbia_cnn.models._model_legacy module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.abstract_models">wbia_cnn.models.abstract_models module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.aoi">wbia_cnn.models.aoi module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.aoi2">wbia_cnn.models.aoi2 module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.background">wbia_cnn.models.background module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.classifier">wbia_cnn.models.classifier module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.classifier2">wbia_cnn.models.classifier2 module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.dummy">wbia_cnn.models.dummy module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.labeler">wbia_cnn.models.labeler module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.mnist">wbia_cnn.models.mnist module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.pretrained">wbia_cnn.models.pretrained module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.quality">wbia_cnn.models.quality module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.siam">wbia_cnn.models.siam module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models.viewpoint">wbia_cnn.models.viewpoint module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-wbia_cnn.models">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.__main__">wbia_cnn.__main__ module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn._plugin">wbia_cnn._plugin module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn._plugin_grabmodels">wbia_cnn._plugin_grabmodels module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.augment">wbia_cnn.augment module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.batch_processing">wbia_cnn.batch_processing module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.custom_layers">wbia_cnn.custom_layers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.dataset">wbia_cnn.dataset module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.draw_net">wbia_cnn.draw_net module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.draw_results">wbia_cnn.draw_results module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.experiments">wbia_cnn.experiments module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.harness">wbia_cnn.harness module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.ingest_data">wbia_cnn.ingest_data module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.ingest_helpers">wbia_cnn.ingest_helpers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.ingest_wbia">wbia_cnn.ingest_wbia module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.lasagne_ext">wbia_cnn.lasagne_ext module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.net_strs">wbia_cnn.net_strs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.netrun">wbia_cnn.netrun module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.process">wbia_cnn.process module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.sandbox">wbia_cnn.sandbox module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.test">wbia_cnn.test module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.theano_ext">wbia_cnn.theano_ext module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn.utils">wbia_cnn.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wbia_cnn.html#module-wbia_cnn">Module contents</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">wbia-cnn</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="wbia_cnn.html">wbia_cnn package</a> &raquo;</li>
      <li>wbia_cnn.models package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/wbia_cnn.models.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="wbia-cnn-models-package">
<h1>wbia_cnn.models package<a class="headerlink" href="#wbia-cnn-models-package" title="Permalink to this headline"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline"></a></h2>
</section>
<section id="module-wbia_cnn.models._model_legacy">
<span id="wbia-cnn-models-model-legacy-module"></span><h2>wbia_cnn.models._model_legacy module<a class="headerlink" href="#module-wbia_cnn.models._model_legacy" title="Permalink to this headline"></a></h2>
</section>
<section id="module-wbia_cnn.models.abstract_models">
<span id="wbia-cnn-models-abstract-models-module"></span><h2>wbia_cnn.models.abstract_models module<a class="headerlink" href="#module-wbia_cnn.models.abstract_models" title="Permalink to this headline"></a></h2>
<p>Directory structure of training</p>
<p>The network directory is the root of the structure and is typically in
_ibeis_cache/nets for ibeis databases. Otherwise it it custom defined (like in
.cache/wbia_cnn/training for mnist tests)</p>
<p># era=(group of epochs)</p>
<p>Datasets contain ingested data packed into a single file for quick loading.
Data can be presplit into testing /  learning / validation sets.  Metadata is
always a dictionary where keys specify columns and each item corresponds a row
of data. Non-corresponding metadata is currently not supported, but should
probably be located in a manifest.json file.</p>
<p># TODO: what is the same data has tasks that use different labels?
# need to incorporate that structure.</p>
<p>The model directory must keep track of several things:
* The network architecture (which may depend on the dataset being used)
- input / output shape
- network layers
* The state of learning
- epoch/era number
- learning rate
- regularization rate
* diagnostic information
- graphs of loss / error rates
- images of convolutional weights
- other visualizations</p>
<p>The trained model keeps track of the trained weights and is now independant of
the dataset. Finalized weights should be copied to and loaded from here.</p>
<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.AbstractCategoricalModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.abstract_models.</span></span><span class="sig-name descname"><span class="pre">AbstractCategoricalModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#AbstractCategoricalModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.BaseModel" title="wbia_cnn.models.abstract_models.BaseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.BaseModel</span></code></a></p>
<p>base model for catagory classifiers</p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.AbstractCategoricalModel.custom_labeled_outputs">
<span class="sig-name descname"><span class="pre">custom_labeled_outputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_batch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#AbstractCategoricalModel.custom_labeled_outputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel.custom_labeled_outputs" title="Permalink to this definition"></a></dt>
<dd><p>override in inherited subclass to enable custom symbolic expressions
based on the network output and the labels</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.AbstractCategoricalModel.custom_unlabeled_outputs">
<span class="sig-name descname"><span class="pre">custom_unlabeled_outputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network_output</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#AbstractCategoricalModel.custom_unlabeled_outputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel.custom_unlabeled_outputs" title="Permalink to this definition"></a></dt>
<dd><p>override in inherited subclass to enable custom symbolic expressions
based on the network output alone</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.AbstractCategoricalModel.init_encoder">
<span class="sig-name descname"><span class="pre">init_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#AbstractCategoricalModel.init_encoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel.init_encoder" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.AbstractCategoricalModel.loss_function">
<span class="sig-name descname"><span class="pre">loss_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truth</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#AbstractCategoricalModel.loss_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel.loss_function" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.AbstractCategoricalModel.rrr">
<span class="sig-name descname"><span class="pre">rrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel.rrr" title="Permalink to this definition"></a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.AbstractVectorModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.abstract_models.</span></span><span class="sig-name descname"><span class="pre">AbstractVectorModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#AbstractVectorModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractVectorModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.BaseModel" title="wbia_cnn.models.abstract_models.BaseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.BaseModel</span></code></a></p>
<p>base model for catagory classifiers</p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.AbstractVectorModel.custom_labeled_outputs">
<span class="sig-name descname"><span class="pre">custom_labeled_outputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_batch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#AbstractVectorModel.custom_labeled_outputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractVectorModel.custom_labeled_outputs" title="Permalink to this definition"></a></dt>
<dd><p>override in inherited subclass to enable custom symbolic expressions
based on the network output and the labels</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.AbstractVectorModel.custom_unlabeled_outputs">
<span class="sig-name descname"><span class="pre">custom_unlabeled_outputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network_output</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#AbstractVectorModel.custom_unlabeled_outputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractVectorModel.custom_unlabeled_outputs" title="Permalink to this definition"></a></dt>
<dd><p>override in inherited subclass to enable custom symbolic expressions
based on the network output alone</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.AbstractVectorModel.init_output_dims">
<span class="sig-name descname"><span class="pre">init_output_dims</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#AbstractVectorModel.init_output_dims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractVectorModel.init_output_dims" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.AbstractVectorModel.loss_function">
<span class="sig-name descname"><span class="pre">loss_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truth</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#AbstractVectorModel.loss_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractVectorModel.loss_function" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.AbstractVectorModel.rrr">
<span class="sig-name descname"><span class="pre">rrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractVectorModel.rrr" title="Permalink to this definition"></a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.AbstractVectorVectorModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.abstract_models.</span></span><span class="sig-name descname"><span class="pre">AbstractVectorVectorModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#AbstractVectorVectorModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractVectorVectorModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.AbstractVectorModel" title="wbia_cnn.models.abstract_models.AbstractVectorModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.AbstractVectorModel</span></code></a></p>
<p>base model for catagory classifiers</p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.AbstractVectorVectorModel.custom_labeled_outputs">
<span class="sig-name descname"><span class="pre">custom_labeled_outputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_batch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#AbstractVectorVectorModel.custom_labeled_outputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractVectorVectorModel.custom_labeled_outputs" title="Permalink to this definition"></a></dt>
<dd><p>override in inherited subclass to enable custom symbolic expressions
based on the network output and the labels</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.AbstractVectorVectorModel.rrr">
<span class="sig-name descname"><span class="pre">rrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.abstract_models.AbstractVectorVectorModel.rrr" title="Permalink to this definition"></a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.BaseModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.abstract_models.</span></span><span class="sig-name descname"><span class="pre">BaseModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#BaseModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.BaseModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models._model_legacy._ModelLegacy</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models._ModelVisualization</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models._ModelIO</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models._ModelStrings</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models._ModelIDs</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models._ModelBackend</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models._ModelFitter</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models._ModelPredicter</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models._ModelBatch</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models._ModelUtility</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">utool.util_dev.NiceRepr</span></code></p>
<p>Abstract model providing functionality for all other models to derive from</p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.BaseModel.augment">
<span class="sig-name descname"><span class="pre">augment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#BaseModel.augment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.BaseModel.augment" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.BaseModel.init_arch">
<span class="sig-name descname"><span class="pre">init_arch</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#BaseModel.init_arch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.BaseModel.init_arch" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.BaseModel.init_from_json">
<span class="sig-name descname"><span class="pre">init_from_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#BaseModel.init_from_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.BaseModel.init_from_json" title="Permalink to this definition"></a></dt>
<dd><p>fpath = ut.truepath(‘~/Desktop/manually_saved/arch_injur-shark-resnet_o2_d27_c2942_jzuddodd/model_state_arch_jzuddodd.pkl’)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.BaseModel.input_batchsize">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">input_batchsize</span></span><a class="headerlink" href="#wbia_cnn.models.abstract_models.BaseModel.input_batchsize" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.BaseModel.input_channels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">input_channels</span></span><a class="headerlink" href="#wbia_cnn.models.abstract_models.BaseModel.input_channels" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.BaseModel.input_height">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">input_height</span></span><a class="headerlink" href="#wbia_cnn.models.abstract_models.BaseModel.input_height" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.BaseModel.input_width">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">input_width</span></span><a class="headerlink" href="#wbia_cnn.models.abstract_models.BaseModel.input_width" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.BaseModel.loss_function">
<span class="sig-name descname"><span class="pre">loss_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truth</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#BaseModel.loss_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.BaseModel.loss_function" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.BaseModel.reinit_weights">
<span class="sig-name descname"><span class="pre">reinit_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#BaseModel.reinit_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.BaseModel.reinit_weights" title="Permalink to this definition"></a></dt>
<dd><p>initailizes weights after the architecture has been defined.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.BaseModel.rrr">
<span class="sig-name descname"><span class="pre">rrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.abstract_models.BaseModel.rrr" title="Permalink to this definition"></a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.History">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.abstract_models.</span></span><span class="sig-name descname"><span class="pre">History</span></span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#History"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.History" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">utool.util_dev.NiceRepr</span></code></p>
<p>Manages bookkeeping for training history</p>
<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.History.current_era_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">current_era_size</span></span><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.current_era_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.History.from_oldstyle">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_oldstyle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">era_history</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#History.from_oldstyle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.from_oldstyle" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.History.get_history_hashid">
<span class="sig-name descname"><span class="pre">get_history_hashid</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#History.get_history_hashid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.get_history_hashid" title="Permalink to this definition"></a></dt>
<dd><p>Builds a hashid that uniquely identifies the architecture and the
training procedure this model has gone through to produce the current
architecture weights.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.History.get_history_nice">
<span class="sig-name descname"><span class="pre">get_history_nice</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#History.get_history_nice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.get_history_nice" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.History.grouped_epochs">
<span class="sig-name descname"><span class="pre">grouped_epochs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#History.grouped_epochs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.grouped_epochs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.History.grouped_epochsT">
<span class="sig-name descname"><span class="pre">grouped_epochsT</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#History.grouped_epochsT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.grouped_epochsT" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.History.hist_id">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hist_id</span></span><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.hist_id" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.abstract_models –test-History.hist_id:0</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.abstract_models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">testdata_model_with_history</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">history</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">hist_id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">epoch0003_era012_zamwoidy</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.History.record_epoch">
<span class="sig-name descname"><span class="pre">record_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch_info</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#History.record_epoch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.record_epoch" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.History.rewind_to">
<span class="sig-name descname"><span class="pre">rewind_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch_num</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#History.rewind_to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.rewind_to" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.History.rrr">
<span class="sig-name descname"><span class="pre">rrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.rrr" title="Permalink to this definition"></a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.History.to_json">
<span class="sig-name descname"><span class="pre">to_json</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#History.to_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.to_json" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.History.total_epochs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total_epochs</span></span><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.total_epochs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.History.total_eras">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total_eras</span></span><a class="headerlink" href="#wbia_cnn.models.abstract_models.History.total_eras" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.LearnState">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.abstract_models.</span></span><span class="sig-name descname"><span class="pre">LearnState</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momentum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#LearnState"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.LearnState" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">utool.util_dict.DictLike</span></code></p>
<p>Keeps track of parameters that can be changed during theano execution</p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.LearnState.getitem">
<span class="sig-name descname"><span class="pre">getitem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#LearnState.getitem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.LearnState.getitem" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.LearnState.init">
<span class="sig-name descname"><span class="pre">init</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#LearnState.init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.LearnState.init" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.LearnState.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#LearnState.keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.LearnState.keys" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.LearnState.learning_rate">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">learning_rate</span></span><a class="headerlink" href="#wbia_cnn.models.abstract_models.LearnState.learning_rate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.LearnState.momentum">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">momentum</span></span><a class="headerlink" href="#wbia_cnn.models.abstract_models.LearnState.momentum" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.LearnState.rrr">
<span class="sig-name descname"><span class="pre">rrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.abstract_models.LearnState.rrr" title="Permalink to this definition"></a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.LearnState.setitem">
<span class="sig-name descname"><span class="pre">setitem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#LearnState.setitem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.LearnState.setitem" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.LearnState.shared">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shared</span></span><a class="headerlink" href="#wbia_cnn.models.abstract_models.LearnState.shared" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.LearnState.weight_decay">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">weight_decay</span></span><a class="headerlink" href="#wbia_cnn.models.abstract_models.LearnState.weight_decay" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.delayed_import">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.abstract_models.</span></span><span class="sig-name descname"><span class="pre">delayed_import</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#delayed_import"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.delayed_import" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.report_error">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.abstract_models.</span></span><span class="sig-name descname"><span class="pre">report_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#report_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.report_error" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.abstract_models.testdata_model_with_history">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.abstract_models.</span></span><span class="sig-name descname"><span class="pre">testdata_model_with_history</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/abstract_models.html#testdata_model_with_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.abstract_models.testdata_model_with_history" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-wbia_cnn.models.aoi">
<span id="wbia-cnn-models-aoi-module"></span><h2>wbia_cnn.models.aoi module<a class="headerlink" href="#module-wbia_cnn.models.aoi" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.models.aoi.AoIModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.aoi.</span></span><span class="sig-name descname"><span class="pre">AoIModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">autoinit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(64,</span> <span class="pre">64,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'aoi'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi.html#AoIModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.aoi.AoIModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.AbstractVectorVectorModel" title="wbia_cnn.models.abstract_models.AbstractVectorVectorModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.AbstractVectorVectorModel</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.aoi.AoIModel.augment">
<span class="sig-name descname"><span class="pre">augment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi.html#AoIModel.augment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.aoi.AoIModel.augment" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.aoi.AoIModel.get_aoi_def">
<span class="sig-name descname"><span class="pre">get_aoi_def</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi.html#AoIModel.get_aoi_def"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.aoi.AoIModel.get_aoi_def" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.aoi.AoIModel.init_arch">
<span class="sig-name descname"><span class="pre">init_arch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi.html#AoIModel.init_arch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.aoi.AoIModel.init_arch" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.aoi.AoIModel.rrr">
<span class="sig-name descname"><span class="pre">rrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.aoi.AoIModel.rrr" title="Permalink to this definition"></a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.aoi.augment_parallel">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.aoi.</span></span><span class="sig-name descname"><span class="pre">augment_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi.html#augment_parallel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.aoi.augment_parallel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.aoi.augment_wrapper">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.aoi.</span></span><span class="sig-name descname"><span class="pre">augment_wrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi.html#augment_wrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.aoi.augment_wrapper" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.aoi.train_aoi">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.aoi.</span></span><span class="sig-name descname"><span class="pre">train_aoi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_fpath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi.html#train_aoi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.aoi.train_aoi" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.train –test-train_aoi</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.aoi</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">train_aoi</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-wbia_cnn.models.aoi2">
<span id="wbia-cnn-models-aoi2-module"></span><h2>wbia_cnn.models.aoi2 module<a class="headerlink" href="#module-wbia_cnn.models.aoi2" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.models.aoi2.AoI2Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.aoi2.</span></span><span class="sig-name descname"><span class="pre">AoI2Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">autoinit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(64,</span> <span class="pre">64,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'aoi2'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi2.html#AoI2Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.aoi2.AoI2Model" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel" title="wbia_cnn.models.abstract_models.AbstractCategoricalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.AbstractCategoricalModel</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.aoi2.AoI2Model.augment">
<span class="sig-name descname"><span class="pre">augment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi2.html#AoI2Model.augment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.aoi2.AoI2Model.augment" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.aoi2.AoI2Model.get_aoi2_def">
<span class="sig-name descname"><span class="pre">get_aoi2_def</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi2.html#AoI2Model.get_aoi2_def"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.aoi2.AoI2Model.get_aoi2_def" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.aoi2.AoI2Model.init_arch">
<span class="sig-name descname"><span class="pre">init_arch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi2.html#AoI2Model.init_arch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.aoi2.AoI2Model.init_arch" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.aoi2.AoI2Model.rrr">
<span class="sig-name descname"><span class="pre">rrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.aoi2.AoI2Model.rrr" title="Permalink to this definition"></a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.aoi2.augment_parallel">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.aoi2.</span></span><span class="sig-name descname"><span class="pre">augment_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi2.html#augment_parallel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.aoi2.augment_parallel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.aoi2.augment_wrapper">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.aoi2.</span></span><span class="sig-name descname"><span class="pre">augment_wrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi2.html#augment_wrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.aoi2.augment_wrapper" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.aoi2.train_aoi2">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.aoi2.</span></span><span class="sig-name descname"><span class="pre">train_aoi2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">purge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/aoi2.html#train_aoi2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.aoi2.train_aoi2" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.train –test-train_aoi2</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.aoi2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">train_aoi2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-wbia_cnn.models.background">
<span id="wbia-cnn-models-background-module"></span><h2>wbia_cnn.models.background module<a class="headerlink" href="#module-wbia_cnn.models.background" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.models.background.BackgroundModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.background.</span></span><span class="sig-name descname"><span class="pre">BackgroundModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">autoinit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(48,</span> <span class="pre">48,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/background.html#BackgroundModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.background.BackgroundModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel" title="wbia_cnn.models.abstract_models.AbstractCategoricalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.AbstractCategoricalModel</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.background.BackgroundModel.augment">
<span class="sig-name descname"><span class="pre">augment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/background.html#BackgroundModel.augment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.background.BackgroundModel.augment" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.background.BackgroundModel.get_background_def">
<span class="sig-name descname"><span class="pre">get_background_def</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/background.html#BackgroundModel.get_background_def"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.background.BackgroundModel.get_background_def" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.background.BackgroundModel.init_arch">
<span class="sig-name descname"><span class="pre">init_arch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/background.html#BackgroundModel.init_arch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.background.BackgroundModel.init_arch" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.background.BackgroundModel.learning_rate_shock">
<span class="sig-name descname"><span class="pre">learning_rate_shock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/background.html#BackgroundModel.learning_rate_shock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.background.BackgroundModel.learning_rate_shock" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.background.BackgroundModel.learning_rate_update">
<span class="sig-name descname"><span class="pre">learning_rate_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/background.html#BackgroundModel.learning_rate_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.background.BackgroundModel.learning_rate_update" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.background.BackgroundModel.rrr">
<span class="sig-name descname"><span class="pre">rrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.background.BackgroundModel.rrr" title="Permalink to this definition"></a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.models.background.NonlinearityLayerSpatial">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.background.</span></span><span class="sig-name descname"><span class="pre">NonlinearityLayerSpatial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">incoming</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlinearity=&lt;function</span> <span class="pre">rectify&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/background.html#NonlinearityLayerSpatial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.background.NonlinearityLayerSpatial" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">lasagne.layers.special.NonlinearityLayer</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.background.NonlinearityLayerSpatial.get_output_for">
<span class="sig-name descname"><span class="pre">get_output_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/background.html#NonlinearityLayerSpatial.get_output_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.background.NonlinearityLayerSpatial.get_output_for" title="Permalink to this definition"></a></dt>
<dd><p>Propagates the given input through this layer (and only this layer).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input</strong> (<em>Theano expression</em>) – The expression to propagate through this layer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output</strong> – The output of this layer given the input to this layer.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Theano expression</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is called by the base <code class="xref py py-meth docutils literal notranslate"><span class="pre">lasagne.layers.get_output()</span></code>
to propagate data through a network.</p>
<p>This method should be overridden when implementing a new
<code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code> class. By default it raises <cite>NotImplementedError</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.background.NonlinearityLayerSpatial.get_output_shape_for">
<span class="sig-name descname"><span class="pre">get_output_shape_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/background.html#NonlinearityLayerSpatial.get_output_shape_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.background.NonlinearityLayerSpatial.get_output_shape_for" title="Permalink to this definition"></a></dt>
<dd><p>Computes the output shape of this layer, given an input shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – A tuple representing the shape of the input. The tuple should have
as many elements as there are input dimensions, and the elements
should be integers or <cite>None</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple representing the shape of the output of this layer. The
tuple has as many elements as there are output dimensions, and the
elements are all either integers or <cite>None</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method will typically be overridden when implementing a new
<code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code> class. By default it simply returns the input
shape. This means that a layer that does not modify the shape
(e.g. because it applies an elementwise operation) does not need
to override this method.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.background.train_background">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.background.</span></span><span class="sig-name descname"><span class="pre">train_background</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_fpath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/background.html#train_background"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.background.train_background" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.train –test-train_background</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.background</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">train_background</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-wbia_cnn.models.classifier">
<span id="wbia-cnn-models-classifier-module"></span><h2>wbia_cnn.models.classifier module<a class="headerlink" href="#module-wbia_cnn.models.classifier" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.models.classifier.ClassifierModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.classifier.</span></span><span class="sig-name descname"><span class="pre">ClassifierModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">autoinit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(64,</span> <span class="pre">64,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'classifier'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier.html#ClassifierModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.classifier.ClassifierModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel" title="wbia_cnn.models.abstract_models.AbstractCategoricalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.AbstractCategoricalModel</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.classifier.ClassifierModel.augment">
<span class="sig-name descname"><span class="pre">augment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier.html#ClassifierModel.augment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.classifier.ClassifierModel.augment" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.classifier.ClassifierModel.get_classifier_def">
<span class="sig-name descname"><span class="pre">get_classifier_def</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier.html#ClassifierModel.get_classifier_def"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.classifier.ClassifierModel.get_classifier_def" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.classifier.ClassifierModel.init_arch">
<span class="sig-name descname"><span class="pre">init_arch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier.html#ClassifierModel.init_arch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.classifier.ClassifierModel.init_arch" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.classifier.ClassifierModel.rrr">
<span class="sig-name descname"><span class="pre">rrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.classifier.ClassifierModel.rrr" title="Permalink to this definition"></a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.classifier.augment_parallel">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.classifier.</span></span><span class="sig-name descname"><span class="pre">augment_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier.html#augment_parallel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.classifier.augment_parallel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.classifier.augment_wrapper">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.classifier.</span></span><span class="sig-name descname"><span class="pre">augment_wrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier.html#augment_wrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.classifier.augment_wrapper" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.classifier.train_classifier">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.classifier.</span></span><span class="sig-name descname"><span class="pre">train_classifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_fpath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier.html#train_classifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.classifier.train_classifier" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.train –test-train_classifier</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.classifier</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">train_classifier</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-wbia_cnn.models.classifier2">
<span id="wbia-cnn-models-classifier2-module"></span><h2>wbia_cnn.models.classifier2 module<a class="headerlink" href="#module-wbia_cnn.models.classifier2" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.models.classifier2.Classifier2Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.classifier2.</span></span><span class="sig-name descname"><span class="pre">Classifier2Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">autoinit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(64,</span> <span class="pre">64,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'classifier2'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier2.html#Classifier2Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.classifier2.Classifier2Model" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.AbstractVectorModel" title="wbia_cnn.models.abstract_models.AbstractVectorModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.AbstractVectorModel</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.classifier2.Classifier2Model.augment">
<span class="sig-name descname"><span class="pre">augment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier2.html#Classifier2Model.augment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.classifier2.Classifier2Model.augment" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.classifier2.Classifier2Model.get_classifier2_def">
<span class="sig-name descname"><span class="pre">get_classifier2_def</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier2.html#Classifier2Model.get_classifier2_def"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.classifier2.Classifier2Model.get_classifier2_def" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.classifier2.Classifier2Model.init_arch">
<span class="sig-name descname"><span class="pre">init_arch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier2.html#Classifier2Model.init_arch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.classifier2.Classifier2Model.init_arch" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.classifier2.Classifier2Model.rrr">
<span class="sig-name descname"><span class="pre">rrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.classifier2.Classifier2Model.rrr" title="Permalink to this definition"></a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.classifier2.augment_parallel">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.classifier2.</span></span><span class="sig-name descname"><span class="pre">augment_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier2.html#augment_parallel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.classifier2.augment_parallel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.classifier2.augment_wrapper">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.classifier2.</span></span><span class="sig-name descname"><span class="pre">augment_wrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier2.html#augment_wrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.classifier2.augment_wrapper" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.classifier2.train_classifier2">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.classifier2.</span></span><span class="sig-name descname"><span class="pre">train_classifier2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">purge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/classifier2.html#train_classifier2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.classifier2.train_classifier2" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.train –test-train_classifier2</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.classifier2</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">train_classifier2</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-wbia_cnn.models.dummy">
<span id="wbia-cnn-models-dummy-module"></span><h2>wbia_cnn.models.dummy module<a class="headerlink" href="#module-wbia_cnn.models.dummy" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.models.dummy.DummyModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.dummy.</span></span><span class="sig-name descname"><span class="pre">DummyModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(4,</span> <span class="pre">4,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/dummy.html#DummyModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.dummy.DummyModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel" title="wbia_cnn.models.abstract_models.AbstractCategoricalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.AbstractCategoricalModel</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.dummy.DummyModel.init_arch">
<span class="sig-name descname"><span class="pre">init_arch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/dummy.html#DummyModel.init_arch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.dummy.DummyModel.init_arch" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn DummyModel.init_arch –verbcnn –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.dummy</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">DummyModel</span><span class="p">(</span><span class="n">autoinit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">print_model_info_str</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">show_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.dummy.DummyModel.rrr">
<span class="sig-name descname"><span class="pre">rrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.dummy.DummyModel.rrr" title="Permalink to this definition"></a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-wbia_cnn.models.labeler">
<span id="wbia-cnn-models-labeler-module"></span><h2>wbia_cnn.models.labeler module<a class="headerlink" href="#module-wbia_cnn.models.labeler" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.models.labeler.LabelerModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.labeler.</span></span><span class="sig-name descname"><span class="pre">LabelerModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">autoinit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(64,</span> <span class="pre">64,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'labeler'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/labeler.html#LabelerModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.labeler.LabelerModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel" title="wbia_cnn.models.abstract_models.AbstractCategoricalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.AbstractCategoricalModel</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.labeler.LabelerModel.augment">
<span class="sig-name descname"><span class="pre">augment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/labeler.html#LabelerModel.augment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.labeler.LabelerModel.augment" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.labeler.LabelerModel.get_labeler_def">
<span class="sig-name descname"><span class="pre">get_labeler_def</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/labeler.html#LabelerModel.get_labeler_def"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.labeler.LabelerModel.get_labeler_def" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.labeler.LabelerModel.init_arch">
<span class="sig-name descname"><span class="pre">init_arch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/labeler.html#LabelerModel.init_arch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.labeler.LabelerModel.init_arch" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.labeler.LabelerModel.rrr">
<span class="sig-name descname"><span class="pre">rrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.labeler.LabelerModel.rrr" title="Permalink to this definition"></a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.labeler.augment_parallel">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.labeler.</span></span><span class="sig-name descname"><span class="pre">augment_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/labeler.html#augment_parallel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.labeler.augment_parallel" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.labeler.augment_wrapper">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.labeler.</span></span><span class="sig-name descname"><span class="pre">augment_wrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/labeler.html#augment_wrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.labeler.augment_wrapper" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.labeler.train_labeler">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.labeler.</span></span><span class="sig-name descname"><span class="pre">train_labeler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_fpath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/labeler.html#train_labeler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.labeler.train_labeler" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.train –test-train_labeler</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.labeler</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">train_labeler</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-wbia_cnn.models.mnist">
<span id="wbia-cnn-models-mnist-module"></span><h2>wbia_cnn.models.mnist module<a class="headerlink" href="#module-wbia_cnn.models.mnist" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.models.mnist.MNISTModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.mnist.</span></span><span class="sig-name descname"><span class="pre">MNISTModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/mnist.html#MNISTModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.mnist.MNISTModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel" title="wbia_cnn.models.abstract_models.AbstractCategoricalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.AbstractCategoricalModel</span></code></a></p>
<p>Toy model for testing and playing with mnist</p>
<dl>
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.mnist MNISTModel:0
python -m wbia_cnn.models.mnist MNISTModel:1</p>
<p>python -m wbia_cnn _ModelFitting.fit:0 –vd –monitor
python -m wbia_cnn _ModelFitting.fit:1 –vd</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.mnist</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">ingest_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">ingest_data</span><span class="o">.</span><span class="n">grab_mnist_category_dataset_float</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MNISTModel</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">data_shape</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">data_shape</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">output_dims</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">unique_labels</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">training_dpath</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">training_dpath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">print_model_info_str</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;FAST_COMPILE&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">build_backprop_func</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.mnist</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="n">mnist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">testdata_mnist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">print_layer_info</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">print_model_info_str</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#model.reinit_weights()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">print_layer_info</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># parse training arguments</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">monitor_config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">ut</span><span class="o">.</span><span class="n">argparse_dict</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">era_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">max_epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">rate_schedule</span><span class="o">=</span><span class="mf">.8</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.mnist.MNISTModel.augment">
<span class="sig-name descname"><span class="pre">augment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/mnist.html#MNISTModel.augment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.mnist.MNISTModel.augment" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.mnist MNISTModel.augment –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.mnist</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="n">mnist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">testdata_mnist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">_rng</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ensure_rng</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">hyperparams</span><span class="p">[</span><span class="s1">&#39;random_seed&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_valid</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb</span> <span class="o">=</span> <span class="n">X_valid</span><span class="p">[:</span><span class="n">num</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yb</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb</span> <span class="o">=</span> <span class="n">Xb</span> <span class="o">/</span> <span class="mf">255.0</span> <span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">is_int</span><span class="p">(</span><span class="n">Xb</span><span class="p">)</span> <span class="k">else</span> <span class="n">Xb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb</span> <span class="o">=</span> <span class="n">Xb</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yb</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">yb</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">yb</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Rescale the batch data to the range 0 to 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb_</span><span class="p">,</span> <span class="n">yb_</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">Xb</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yb_</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia</span> <span class="kn">import</span> <span class="n">plottool</span> <span class="k">as</span> <span class="n">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">qt4ensure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">augment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">augment</span><span class="o">.</span><span class="n">show_augmented_patches</span><span class="p">(</span><span class="n">Xb</span><span class="p">,</span> <span class="n">Xb_</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">yb_</span><span class="p">,</span> <span class="n">data_per_label</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.mnist.MNISTModel.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/mnist.html#MNISTModel.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.mnist.MNISTModel.fit" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.mnist MNISTModel.fit –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.mnist</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="n">mnist</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">testdata_mnist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># parse training arguments</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">monitor_config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">ut</span><span class="o">.</span><span class="n">argparse_dict</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">era_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">max_epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">rate_schedule</span><span class="o">=</span><span class="mf">.9</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.mnist.MNISTModel.get_inception_def">
<span class="sig-name descname"><span class="pre">get_inception_def</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/mnist.html#MNISTModel.get_inception_def"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.mnist.MNISTModel.get_inception_def" title="Permalink to this definition"></a></dt>
<dd><p>python -m wbia_cnn MNISTModel.init_arch –verbcnn –name=resnet –show
python -m wbia_cnn.models.mnist MNISTModel.fit:0 –name=resnet –vd –monitor</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.mnist.MNISTModel.get_lenet_def">
<span class="sig-name descname"><span class="pre">get_lenet_def</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/mnist.html#MNISTModel.get_lenet_def"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.mnist.MNISTModel.get_lenet_def" title="Permalink to this definition"></a></dt>
<dd><p>python -m wbia_cnn MNISTModel.init_arch –verbcnn –name=lenet –show
python -m wbia_cnn.models.mnist MNISTModel.fit:0 –name=lenet –vd –monitor</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.mnist.MNISTModel.get_mnist_def">
<span class="sig-name descname"><span class="pre">get_mnist_def</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/mnist.html#MNISTModel.get_mnist_def"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.mnist.MNISTModel.get_mnist_def" title="Permalink to this definition"></a></dt>
<dd><p>Follows <a class="reference external" href="https://github.com/Lasagne/Lasagne/blob/master/examples/mnist.py">https://github.com/Lasagne/Lasagne/blob/master/examples/mnist.py</a></p>
<p>python -m wbia_cnn MNISTModel.init_arch –verbcnn –name=mnist –show
python -m wbia_cnn.models.mnist MNISTModel.fit:0 –name=mnist –vd –monitor</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.mnist.MNISTModel.get_resnet_def">
<span class="sig-name descname"><span class="pre">get_resnet_def</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/mnist.html#MNISTModel.get_resnet_def"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.mnist.MNISTModel.get_resnet_def" title="Permalink to this definition"></a></dt>
<dd><p>A residual network with pre-activations</p>
<p>python -m wbia_cnn MNISTModel.init_arch –verbcnn –name=resnet –show
python -m wbia_cnn.models.mnist MNISTModel.fit:0 –name=resnet –vd –monitor</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.mnist.MNISTModel.init_arch">
<span class="sig-name descname"><span class="pre">init_arch</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/mnist.html#MNISTModel.init_arch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.mnist.MNISTModel.init_arch" title="Permalink to this definition"></a></dt>
<dd><dl>
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn  MNISTModel.init_arch –verbcnn
python -m wbia_cnn  MNISTModel.init_arch –verbcnn –show</p>
<p>python -m wbia_cnn  MNISTModel.init_arch –verbcnn –name=bnorm –show
python -m wbia_cnn  MNISTModel.init_arch –verbcnn –name=incep –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.mnist</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--name&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;bnorm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MNISTModel</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">data_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>                   <span class="n">output_dims</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">print_model_info_str</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">show_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.mnist.MNISTModel.rrr">
<span class="sig-name descname"><span class="pre">rrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.mnist.MNISTModel.rrr" title="Permalink to this definition"></a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.mnist.testdata_mnist">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.mnist.</span></span><span class="sig-name descname"><span class="pre">testdata_mnist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">defaultname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lenet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/mnist.html#testdata_mnist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.mnist.testdata_mnist" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-wbia_cnn.models.pretrained">
<span id="wbia-cnn-models-pretrained-module"></span><h2>wbia_cnn.models.pretrained module<a class="headerlink" href="#module-wbia_cnn.models.pretrained" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.models.pretrained.PretrainedNetwork">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.pretrained.</span></span><span class="sig-name descname"><span class="pre">PretrainedNetwork</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_network</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/pretrained.html#PretrainedNetwork"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.pretrained.PretrainedNetwork" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>TODO: move to new class</p>
<p>Intialize weights from a specified (Caffe) pretrained network layers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>layer</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – int</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn –tf PretrainedNetwork:0
python -m wbia_cnn –tf PretrainedNetwork:1</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">PretrainedNetwork</span><span class="p">(</span><span class="s1">&#39;caffenet&#39;</span><span class="p">,</span> <span class="n">show_network</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">PretrainedNetwork</span><span class="p">(</span><span class="s1">&#39;vggnet&#39;</span><span class="p">,</span> <span class="n">show_network</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.pretrained.PretrainedNetwork.get_conv2d_layer">
<span class="sig-name descname"><span class="pre">get_conv2d_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/pretrained.html#PretrainedNetwork.get_conv2d_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.pretrained.PretrainedNetwork.get_conv2d_layer" title="Permalink to this definition"></a></dt>
<dd><p>Assumes requested layer is convolutional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Layer</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>lasagne.layers.Layer</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.pretrained.PretrainedNetwork.get_layer_filter_size">
<span class="sig-name descname"><span class="pre">get_layer_filter_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/pretrained.html#PretrainedNetwork.get_layer_filter_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.pretrained.PretrainedNetwork.get_layer_filter_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.pretrained.PretrainedNetwork.get_layer_num_filters">
<span class="sig-name descname"><span class="pre">get_layer_num_filters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/pretrained.html#PretrainedNetwork.get_layer_num_filters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.pretrained.PretrainedNetwork.get_layer_num_filters" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.pretrained.PretrainedNetwork.get_num_layers">
<span class="sig-name descname"><span class="pre">get_num_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/pretrained.html#PretrainedNetwork.get_num_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.pretrained.PretrainedNetwork.get_num_layers" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.pretrained.PretrainedNetwork.get_pretrained_layer">
<span class="sig-name descname"><span class="pre">get_pretrained_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rand</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/pretrained.html#PretrainedNetwork.get_pretrained_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.pretrained.PretrainedNetwork.get_pretrained_layer" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-wbia_cnn.models.quality">
<span id="wbia-cnn-models-quality-module"></span><h2>wbia_cnn.models.quality module<a class="headerlink" href="#module-wbia_cnn.models.quality" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.models.quality.QualityModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.quality.</span></span><span class="sig-name descname"><span class="pre">QualityModel</span></span><a class="reference internal" href="_modules/wbia_cnn/models/quality.html#QualityModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.quality.QualityModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel" title="wbia_cnn.models.abstract_models.AbstractCategoricalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.AbstractCategoricalModel</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.quality.QualityModel.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/quality.html#QualityModel.build_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.quality.QualityModel.build_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.quality.QualityModel.label_order_mapping">
<span class="sig-name descname"><span class="pre">label_order_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">category_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/quality.html#QualityModel.label_order_mapping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.quality.QualityModel.label_order_mapping" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.quality.QualityModel.learning_rate_shock">
<span class="sig-name descname"><span class="pre">learning_rate_shock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/quality.html#QualityModel.learning_rate_shock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.quality.QualityModel.learning_rate_shock" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.quality.QualityModel.learning_rate_update">
<span class="sig-name descname"><span class="pre">learning_rate_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/quality.html#QualityModel.learning_rate_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.quality.QualityModel.learning_rate_update" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.quality.QualityModel.rrr">
<span class="sig-name descname"><span class="pre">rrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.quality.QualityModel.rrr" title="Permalink to this definition"></a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-wbia_cnn.models.siam">
<span id="wbia-cnn-models-siam-module"></span><h2>wbia_cnn.models.siam module<a class="headerlink" href="#module-wbia_cnn.models.siam" title="Permalink to this headline"></a></h2>
<p>Siamese based models</p>
<p class="rubric">References</p>
<p><a class="reference external" href="http://yann.lecun.com/exdb/publis/pdf/hadsell-chopra-lecun-06.pdf">http://yann.lecun.com/exdb/publis/pdf/hadsell-chopra-lecun-06.pdf</a>
<a class="reference external" href="https://github.com/BVLC/caffe/pull/959">https://github.com/BVLC/caffe/pull/959</a>
<a class="reference external" href="http://yann.lecun.com/exdb/publis/pdf/chopra-05.pdf">http://yann.lecun.com/exdb/publis/pdf/chopra-05.pdf</a>
<a class="reference external" href="http://www.commendo.at/references/files/paperCVWW08.pdf">http://www.commendo.at/references/files/paperCVWW08.pdf</a>
<a class="reference external" href="https://tspace.library.utoronto.ca/bitstream/1807/43097/3/Liu_Chen_201311_MASc_thesis.pdf">https://tspace.library.utoronto.ca/bitstream/1807/43097/3/Liu_Chen_201311_MASc_thesis.pdf</a>
<a class="reference external" href="http://arxiv.org/pdf/1412.6622.pdf">http://arxiv.org/pdf/1412.6622.pdf</a>
<a class="reference external" href="http://papers.nips.cc/paper/4314-extracting-speaker-specific-information-with-a-regularized-siamese-deep-network.pdf">http://papers.nips.cc/paper/4314-extracting-speaker-specific-information-with-a-regularized-siamese-deep-network.pdf</a>
<a class="reference external" href="http://machinelearning.wustl.edu/mlpapers/paper_files/NIPS2005_265.pdf">http://machinelearning.wustl.edu/mlpapers/paper_files/NIPS2005_265.pdf</a>
<a class="reference external" href="http://vision.ia.ac.cn/zh/senimar/reports/Siamese-Network-Architecture-and-Applications-in-Computer-Vision.pdf">http://vision.ia.ac.cn/zh/senimar/reports/Siamese-Network-Architecture-and-Applications-in-Computer-Vision.pdf</a></p>
<p><a class="reference external" href="https://groups.google.com/forum/#!topic/caffe-users/D-7sRDw9v8c">https://groups.google.com/forum/#!topic/caffe-users/D-7sRDw9v8c</a>
<a class="reference external" href="http://caffe.berkeleyvision.org/gathered/examples/siamese.html">http://caffe.berkeleyvision.org/gathered/examples/siamese.html</a>
<a class="reference external" href="https://groups.google.com/forum/#!topic/lasagne-users/N9zDNvNkyWY">https://groups.google.com/forum/#!topic/lasagne-users/N9zDNvNkyWY</a>
<a class="reference external" href="http://www.cs.nyu.edu/~sumit/research/research.html">http://www.cs.nyu.edu/~sumit/research/research.html</a>
<a class="reference external" href="https://github.com/Lasagne/Lasagne/issues/168">https://github.com/Lasagne/Lasagne/issues/168</a>
<a class="reference external" href="https://groups.google.com/forum/#!topic/lasagne-users/7JX_8zKfDI0">https://groups.google.com/forum/#!topic/lasagne-users/7JX_8zKfDI0</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.AbstractSiameseModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.siam.</span></span><span class="sig-name descname"><span class="pre">AbstractSiameseModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#AbstractSiameseModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.siam.AbstractSiameseModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.BaseModel" title="wbia_cnn.models.abstract_models.BaseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.BaseModel</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.AbstractSiameseModel.augment">
<span class="sig-name descname"><span class="pre">augment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#AbstractSiameseModel.augment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.siam.AbstractSiameseModel.augment" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.AbstractSiameseModel.rrr">
<span class="sig-name descname"><span class="pre">rrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.siam.AbstractSiameseModel.rrr" title="Permalink to this definition"></a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.SiameseCenterSurroundModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.siam.</span></span><span class="sig-name descname"><span class="pre">SiameseCenterSurroundModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">autoinit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(64,</span> <span class="pre">64,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseCenterSurroundModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseCenterSurroundModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.siam.AbstractSiameseModel" title="wbia_cnn.models.siam.AbstractSiameseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.siam.AbstractSiameseModel</span></code></a></p>
<p>Model for individual identification</p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.SiameseCenterSurroundModel.get_2ch2stream_def">
<span class="sig-name descname"><span class="pre">get_2ch2stream_def</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseCenterSurroundModel.get_2ch2stream_def"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseCenterSurroundModel.get_2ch2stream_def" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Notes</p>
<p>(i) 2ch-2stream consists of two branches
C(95, 5, 1)- ReLU- P(2, 2)- C(96, 3, 1)- ReLU- P(2, 2)- C(192, 3, 1)-
ReLU- C(192, 3, 1)- ReLU,
one for central and one for surround parts, followed by
F(768)- ReLU- F(1)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.SiameseCenterSurroundModel.get_siam2stream_def">
<span class="sig-name descname"><span class="pre">get_siam2stream_def</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseCenterSurroundModel.get_siam2stream_def"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseCenterSurroundModel.get_siam2stream_def" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Notes</p>
<p>(viii) siam-2stream has 4 branches
C(96, 4, 2)- ReLU- P(2, 2)- C(192, 3, 1)- ReLU- C(256, 3, 1)- ReLU- C(256, 3, 1)-
ReLU
(coupled in pairs for central and surround streams, and decision layer)
F(512)-ReLU- F(1)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.SiameseCenterSurroundModel.get_siam2stream_l2_def">
<span class="sig-name descname"><span class="pre">get_siam2stream_l2_def</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseCenterSurroundModel.get_siam2stream_l2_def"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseCenterSurroundModel.get_siam2stream_l2_def" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Notes</p>
<p>(ix) siam-2stream-l2 consists of one central and one surround
branch of siam-2stream.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.SiameseCenterSurroundModel.init_arch">
<span class="sig-name descname"><span class="pre">init_arch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseCenterSurroundModel.init_arch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseCenterSurroundModel.init_arch" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Notes</p>
<p><a class="reference external" href="http://arxiv.org/pdf/1504.03641.pdf">http://arxiv.org/pdf/1504.03641.pdf</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.siam –test-SiameseCenterSurroundModel.init_arch
python -m wbia_cnn.models.siam –test-SiameseCenterSurroundModel.init_arch –verbcnn
python -m wbia_cnn.models.siam –test-SiameseCenterSurroundModel.init_arch –verbcnn –show
python -m wbia_cnn.train –test-pz_patchmatch –vtd –max-examples=5 –batch_size=128 –learning_rate .0000001 –verbcnn
python -m wbia_cnn.train –test-pz_patchmatch –vtd</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">SiameseCenterSurroundModel</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">print_model_info_str</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">output_layer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia</span> <span class="kn">import</span> <span class="n">plottool</span> <span class="k">as</span> <span class="n">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">show_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.SiameseCenterSurroundModel.learn_encoder">
<span class="sig-name descname"><span class="pre">learn_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseCenterSurroundModel.learn_encoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseCenterSurroundModel.learn_encoder" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.SiameseCenterSurroundModel.loss_function">
<span class="sig-name descname"><span class="pre">loss_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T=&lt;module</span> <span class="pre">'theano.tensor'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/theano/tensor/__init__.py'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseCenterSurroundModel.loss_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseCenterSurroundModel.loss_function" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.siam –test-loss_function
python -m wbia_cnn.models.siam –test-loss_function:1 –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">ingest_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn</span> <span class="kn">import</span> <span class="n">batch_processing</span> <span class="k">as</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ingest_data</span><span class="o">.</span><span class="n">testdata_patchmatch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">SiameseCenterSurroundModel</span><span class="p">(</span><span class="n">autoinit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">128</span><span class="p">,)</span> <span class="o">+</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theano_forward</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">create_unbuffered_network_output_func</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_size</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">batch_size</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">batch_size</span> <span class="o">*</span> <span class="n">model</span><span class="o">.</span><span class="n">data_per_label_input</span><span class="p">],</span> <span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">batch_size</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">network_output</span> <span class="o">=</span> <span class="n">theano_forward</span><span class="p">(</span><span class="n">Xb</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">network_output</span> <span class="o">=</span> <span class="n">network_output</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">yb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># execute function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg_loss</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">loss_function</span><span class="p">(</span><span class="n">network_output</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">avg_loss</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">network_output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">network_output</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">network_output</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span> <span class="o">=</span> <span class="n">SiameseCenterSurroundModel</span><span class="o">.</span><span class="n">loss_function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss0</span><span class="p">,</span> <span class="n">Y0_</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="nb">locals</span><span class="p">(),</span> <span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="s1">&#39;Y_&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss1</span><span class="p">,</span> <span class="n">Y1_</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="nb">locals</span><span class="p">(),</span> <span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="s1">&#39;Y_&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">Y1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">Y1_</span> <span class="o">==</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;bad label mapping&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">Y0</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">Y0_</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;bad label mapping&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia</span> <span class="kn">import</span> <span class="n">plottool</span> <span class="k">as</span> <span class="n">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">network_output</span><span class="p">,</span> <span class="n">loss0</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">TRUE_BLUE</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;imposter_loss&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;network output&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">network_output</span><span class="p">,</span> <span class="n">loss1</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">FALSE_RED</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;genuine_loss&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;network output&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.SiameseCenterSurroundModel.rrr">
<span class="sig-name descname"><span class="pre">rrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.siam.SiameseCenterSurroundModel.rrr" title="Permalink to this definition"></a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.SiameseL2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.siam.</span></span><span class="sig-name descname"><span class="pre">SiameseL2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">autoinit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(64,</span> <span class="pre">64,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arch_tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'siaml2'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseL2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseL2" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.siam.AbstractSiameseModel" title="wbia_cnn.models.siam.AbstractSiameseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.siam.AbstractSiameseModel</span></code></a></p>
<p>Model for individual identification</p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.SiameseL2.get_mnist_siaml2_def">
<span class="sig-name descname"><span class="pre">get_mnist_siaml2_def</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseL2.get_mnist_siaml2_def"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseL2.get_mnist_siaml2_def" title="Permalink to this definition"></a></dt>
<dd><p>python -m wbia_cnn –tf  SiameseL2.init_arch –archtag mnist_siaml2 –datashape=28,28,1 –verbose  –show</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.SiameseL2.get_siam2streaml2_def">
<span class="sig-name descname"><span class="pre">get_siam2streaml2_def</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseL2.get_siam2streaml2_def"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseL2.get_siam2streaml2_def" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Notes</p>
<p>(ix) siam-2stream-l2 consists of one central and one surround
branch of siam-2stream.
C0(96, 7, 3) - ReLU - P0(2, 2) - C1(192, 5, 1) - ReLU - P1(2, 2) - C2(256, 3, 1)</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn –tf  SiameseL2.init_arch –archtag siam2streaml2 –datashape=64,64,1 –verbose  –show</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.SiameseL2.get_siam_deepfaceish_def">
<span class="sig-name descname"><span class="pre">get_siam_deepfaceish_def</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseL2.get_siam_deepfaceish_def"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseL2.get_siam_deepfaceish_def" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn –tf  SiameseL2.init_arch –archtag siam_deepfaceish –datashape=128,256,1 –verbose  –show
python -m wbia_cnn –tf  SiameseL2.init_arch –archtag siam_deepface –datashape=152,152,3 –verbose  –show</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.SiameseL2.get_siaml2_128_def">
<span class="sig-name descname"><span class="pre">get_siaml2_128_def</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseL2.get_siaml2_128_def"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseL2.get_siaml2_128_def" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Notes</p>
<p>(ix) siam-2stream-l2 consists of one central and one surround
branch of siam-2stream.
C0(96, 7, 3) - ReLU - P0(2, 2) - C1(192, 5, 1) - ReLU - P1(2, 2) - C2(256, 3, 1)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.SiameseL2.get_siaml2_def">
<span class="sig-name descname"><span class="pre">get_siaml2_def</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseL2.get_siaml2_def"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseL2.get_siaml2_def" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Notes</p>
<p>(ix) siam-2stream-l2 consists of one central and one surround
branch of siam-2stream.
C0(96, 7, 3) - ReLU - P0(2, 2) - C1(192, 5, 1) - ReLU - P1(2, 2) - C2(256, 3, 1)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.SiameseL2.get_siaml2_partmatch_def">
<span class="sig-name descname"><span class="pre">get_siaml2_partmatch_def</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseL2.get_siaml2_partmatch_def"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseL2.get_siaml2_partmatch_def" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn –tf  SiameseL2.init_arch –archtag siaml2_partmatch –datashape=128,256,1 –verbose  –show</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.SiameseL2.init_arch">
<span class="sig-name descname"><span class="pre">init_arch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseL2.init_arch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseL2.init_arch" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Notes</p>
<p><a class="reference external" href="http://arxiv.org/pdf/1504.03641.pdf">http://arxiv.org/pdf/1504.03641.pdf</a></p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.siam –test-SiameseL2.init_arch –verbcnn –show
python -m wbia_cnn –tf  SiameseL2.init_arch –verbcnn –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.siam</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arch_tag</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--archtag&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;siaml2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_shape</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">get_argval</span><span class="p">(</span><span class="s1">&#39;--datashape&#39;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">SiameseL2</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">data_shape</span><span class="o">=</span><span class="n">data_shape</span><span class="p">,</span> <span class="n">arch_tag</span><span class="o">=</span><span class="n">arch_tag</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_layer</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">init_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">print_model_info_str</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">show_arch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.SiameseL2.learn_encoder">
<span class="sig-name descname"><span class="pre">learn_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseL2.learn_encoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseL2.learn_encoder" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.SiameseL2.loss_function">
<span class="sig-name descname"><span class="pre">loss_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T=&lt;module</span> <span class="pre">'theano.tensor'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/theano/tensor/__init__.py'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#SiameseL2.loss_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.siam.SiameseL2.loss_function" title="Permalink to this definition"></a></dt>
<dd><p>Implements the contrastive loss term from (Hasdel, Chopra, LeCun 06)</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.siam –test-SiameseL2.loss_function –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">network_output</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">testdata_siam_desc</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span> <span class="o">=</span> <span class="n">SiameseL2</span><span class="o">.</span><span class="n">loss_function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span><span class="p">,</span> <span class="n">dist_l2</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="nb">locals</span><span class="p">(),</span> <span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="s1">&#39;dist_l2&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist0_l2</span> <span class="o">=</span> <span class="n">dist_l2</span><span class="p">[</span><span class="n">labels</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist1_l2</span> <span class="o">=</span> <span class="n">dist_l2</span><span class="p">[</span><span class="o">~</span><span class="n">labels</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss0</span> <span class="o">=</span> <span class="n">loss</span><span class="p">[</span><span class="n">labels</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss1</span> <span class="o">=</span> <span class="n">loss</span><span class="p">[</span><span class="o">~</span><span class="n">labels</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia</span> <span class="kn">import</span> <span class="n">plottool</span> <span class="k">as</span> <span class="n">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">dist0_l2</span><span class="p">,</span> <span class="n">loss0</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">TRUE_BLUE</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;imposter_loss&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;loss&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot2</span><span class="p">(</span><span class="n">dist1_l2</span><span class="p">,</span> <span class="n">loss1</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">FALSE_RED</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;genuine_loss&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;loss&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.SiameseL2.rrr">
<span class="sig-name descname"><span class="pre">rrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.siam.SiameseL2.rrr" title="Permalink to this definition"></a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.constrastive_loss">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.siam.</span></span><span class="sig-name descname"><span class="pre">constrastive_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist_l2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">margin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T=&lt;module</span> <span class="pre">'theano.tensor'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/theano/tensor/__init__.py'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#constrastive_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.siam.constrastive_loss" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>LaTeX:</dt><dd><p>$(y E)^2 + ((1 - y) max(m - E, 0)^2)$</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist_l2</strong> (<em>ndarray</em>) – energy of a training example (l2 distance of descriptor pairs)</p></li>
<li><p><strong>labels</strong> (<em>ndarray</em>) – 1 if genuine pair, 0 if imposter pair</p></li>
<li><p><strong>margin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – positive number</p></li>
<li><p><strong>T</strong> (<em>module</em>) – (default = theano.tensor)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>loss</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Carefull, you need to pass the the euclidean distance in here here, NOT
the squared euclidean distance otherwise you end up with
T.maximum(0, (m ** 2 - 2 * m * d + d ** 2)),
which still requires the square root operation</p>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.siam –test-constrastive_loss –show</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.siam</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_l2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># margin, T = 1.25, np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">margin</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="mf">1.25</span><span class="p">,</span> <span class="n">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span> <span class="o">=</span> <span class="n">constrastive_loss</span><span class="p">(</span><span class="n">dist_l2</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">margin</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">quit_if_noshow</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia</span> <span class="kn">import</span> <span class="n">plottool</span> <span class="k">as</span> <span class="n">pt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdat_genuine</span><span class="p">,</span> <span class="n">ydat_genuine</span> <span class="o">=</span> <span class="n">dist_l2</span><span class="p">[</span><span class="n">labels</span><span class="p">],</span> <span class="n">loss</span><span class="p">[</span><span class="n">labels</span><span class="p">]</span> <span class="o">*</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdat_imposter</span><span class="p">,</span> <span class="n">ydat_imposter</span> <span class="o">=</span> <span class="n">dist_l2</span><span class="p">[</span><span class="o">~</span><span class="n">labels</span><span class="p">],</span> <span class="n">loss</span><span class="p">[</span><span class="o">~</span><span class="n">labels</span><span class="p">]</span> <span class="o">*</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#pt.presetup_axes(x_label=&#39;Energy (D_w)&#39;, y_label=&#39;Loss (L)&#39;, equal_aspect=False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">presetup_axes</span><span class="p">(</span><span class="n">x_label</span><span class="o">=</span><span class="s1">&#39;Energy (E)&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;Loss (L)&#39;</span><span class="p">,</span> <span class="n">equal_aspect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdat_genuine</span><span class="p">,</span> <span class="n">ydat_genuine</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">TRUE</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Correct training pairs&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdat_imposter</span><span class="p">,</span> <span class="n">ydat_imposter</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">pt</span><span class="o">.</span><span class="n">FALSE</span><span class="p">,</span>  <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Incorrect training pairs&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">pad_axes</span><span class="p">(</span><span class="mf">.03</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="o">.</span><span class="n">postsetup_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ut</span><span class="o">.</span><span class="n">show_if_requested</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.ignore_hardest_cases">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.siam.</span></span><span class="sig-name descname"><span class="pre">ignore_hardest_cases</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_ignore=3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T=&lt;module</span> <span class="pre">'theano.tensor'</span> <span class="pre">from</span> <span class="pre">'/Users/jason.parham/virtualenv/wbia.3.8.9/lib/python3.8/site-packages/theano/tensor/__init__.py'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#ignore_hardest_cases"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.siam.ignore_hardest_cases" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss</strong> (<em>theano.Tensor</em>) – </p></li>
<li><p><strong>labels</strong> (<em>theano.Tensor</em>) – </p></li>
<li><p><strong>num_ignore</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – (default = 3)</p></li>
<li><p><strong>T</strong> (<em>module</em>) – (default = theano.tensor)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>loss</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>theano.Tensor</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.siam –test-ignore_hardest_cases:0
python -m wbia_cnn.models.siam –test-ignore_hardest_cases:1
python -m wbia_cnn.models.siam –test-ignore_hardest_cases:2</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ENABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Test numpy version</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.siam</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss_arr</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span>   <span class="o">=</span> <span class="n">loss_arr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="n">labels_arr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_ignore</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ignored_loss_arr</span> <span class="o">=</span> <span class="n">ignore_hardest_cases</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">num_ignore</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;ignored_loss_arr = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">numpy_str</span><span class="p">(</span><span class="n">ignored_loss_arr</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">ignored_loss_arr = np.array([0, 1, 0, 3, 4, 5, 0, 0, 0])</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Test version compatiblity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.siam</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wbia_cnn.theano_ext</span> <span class="k">as</span> <span class="nn">theano_ext</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">theano.tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss_arr</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">ivector</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;loss&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">ivector</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;labels&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_ignore</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build numpy targets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numpy_locals</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;np&#39;</span><span class="p">:</span> <span class="n">np</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="n">np</span><span class="p">,</span> <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="n">loss_arr</span><span class="p">,</span> <span class="s1">&#39;labels&#39;</span><span class="p">:</span> <span class="n">labels_arr</span><span class="p">,</span> <span class="s1">&#39;num_ignore&#39;</span><span class="p">:</span> <span class="n">num_ignore</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span> <span class="o">=</span> <span class="n">ignore_hardest_cases</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numpy_vars</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="p">{},</span> <span class="n">numpy_locals</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numpy_targets</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">delete_dict_keys</span><span class="p">(</span><span class="n">numpy_vars</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;__doc__&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;np&#39;</span><span class="p">,</span> <span class="s1">&#39;num_ignore&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build theano functions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theano_locals</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;np&#39;</span><span class="p">:</span> <span class="n">np</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="n">theano</span><span class="o">.</span><span class="n">tensor</span><span class="p">,</span> <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="n">loss</span><span class="p">,</span> <span class="s1">&#39;labels&#39;</span><span class="p">:</span> <span class="n">labels</span><span class="p">,</span> <span class="s1">&#39;num_ignore&#39;</span><span class="p">:</span> <span class="n">num_ignore</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span> <span class="o">=</span> <span class="n">ignore_hardest_cases</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theano_vars</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">exec_func_src</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="p">{},</span> <span class="n">theano_locals</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theano_symbols</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">delete_dict_keys</span><span class="p">(</span><span class="n">theano_vars</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;__doc__&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;np&#39;</span><span class="p">,</span> <span class="s1">&#39;num_ignore&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inputs_to_value</span> <span class="o">=</span> <span class="p">{</span><span class="n">loss</span><span class="p">:</span> <span class="n">loss_arr</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span> <span class="n">labels_arr</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evalute and test consistency</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key_order</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">theano_symbols</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theano_values</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noerror</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">key_order</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">symbol</span> <span class="o">=</span> <span class="n">theano_symbols</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;key=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,))</span>
<span class="gp">... </span>    <span class="n">theano_value</span> <span class="o">=</span> <span class="n">theano_ext</span><span class="o">.</span><span class="n">eval_symbol</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="n">inputs_to_value</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">theano_values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">theano_value</span>
<span class="gp">... </span>    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;  * &#39;</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">theano_values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="n">numpy_targets</span><span class="p">[</span><span class="n">key</span><span class="p">]):</span>
<span class="gp">... </span>        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39; !!! &#39;</span>
<span class="gp">... </span>        <span class="n">noerror</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">... </span>    <span class="c1"># Cast to compatible dtype</span>
<span class="gp">... </span>    <span class="n">numpy_value</span> <span class="o">=</span> <span class="n">numpy_targets</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">result_dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">result_type</span><span class="p">(</span><span class="n">numpy_value</span><span class="p">,</span> <span class="n">theano_value</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">numpy_value</span> <span class="o">=</span> <span class="n">numpy_value</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">result_dtype</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">theano_value</span> <span class="o">=</span> <span class="n">theano_value</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">result_dtype</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">numpy_targets</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy_value</span>
<span class="gp">... </span>    <span class="n">theano_values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">theano_value</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="s1">&#39;numpy_value  = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">numpy_value</span><span class="p">,))</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="s1">&#39;theano_value = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">theano_value</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;numpy_targets = &#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="n">numpy_targets</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;theano_values = &#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="n">theano_values</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">noerror</span><span class="p">,</span> <span class="s1">&#39;There was an error&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.predict">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.siam.</span></span><span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.siam.predict" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.siam.testdata_siam_desc">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.siam.</span></span><span class="sig-name descname"><span class="pre">testdata_siam_desc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desc_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/siam.html#testdata_siam_desc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.siam.testdata_siam_desc" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-wbia_cnn.models.viewpoint">
<span id="wbia-cnn-models-viewpoint-module"></span><h2>wbia_cnn.models.viewpoint module<a class="headerlink" href="#module-wbia_cnn.models.viewpoint" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wbia_cnn.models.viewpoint.ViewpointModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.viewpoint.</span></span><span class="sig-name descname"><span class="pre">ViewpointModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">autoinit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(96,</span> <span class="pre">96,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arch_tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viewpoint'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/viewpoint.html#ViewpointModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.viewpoint.ViewpointModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#wbia_cnn.models.abstract_models.AbstractCategoricalModel" title="wbia_cnn.models.abstract_models.AbstractCategoricalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">wbia_cnn.models.abstract_models.AbstractCategoricalModel</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.viewpoint.ViewpointModel.augment">
<span class="sig-name descname"><span class="pre">augment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/viewpoint.html#ViewpointModel.augment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.viewpoint.ViewpointModel.augment" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.viewpoint.ViewpointModel.init_arch">
<span class="sig-name descname"><span class="pre">init_arch</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/viewpoint.html#ViewpointModel.init_arch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.viewpoint.ViewpointModel.init_arch" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.viewpoint.ViewpointModel.label_order_mapping">
<span class="sig-name descname"><span class="pre">label_order_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">category_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/viewpoint.html#ViewpointModel.label_order_mapping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.viewpoint.ViewpointModel.label_order_mapping" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>category_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>category_mapping</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><p>?</p>
</p>
</dd>
</dl>
<dl class="simple">
<dt>CommandLine:</dt><dd><p>python -m wbia_cnn.models.viewpoint –exec-label_order_mapping</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DISABLE_DOCTEST</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wbia_cnn.models.viewpoint</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">ViewpointModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">category_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;LEFT&#39;</span><span class="p">,</span> <span class="s1">&#39;FRONT_LEFT&#39;</span><span class="p">,</span> <span class="s1">&#39;FRONT&#39;</span><span class="p">,</span> <span class="s1">&#39;FRONT_RIGHT&#39;</span><span class="p">,</span> <span class="s1">&#39;RIGHT&#39;</span><span class="p">,</span> <span class="s1">&#39;BACK_RIGHT&#39;</span><span class="p">,</span> <span class="s1">&#39;BACK&#39;</span><span class="p">,</span> <span class="s1">&#39;BACK_LEFT&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">category_mapping</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">label_order_mapping</span><span class="p">(</span><span class="n">category_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;category_mapping = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">category_mapping</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.viewpoint.ViewpointModel.learning_rate_shock">
<span class="sig-name descname"><span class="pre">learning_rate_shock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/viewpoint.html#ViewpointModel.learning_rate_shock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.viewpoint.ViewpointModel.learning_rate_shock" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.viewpoint.ViewpointModel.learning_rate_update">
<span class="sig-name descname"><span class="pre">learning_rate_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models/viewpoint.html#ViewpointModel.learning_rate_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.viewpoint.ViewpointModel.learning_rate_update" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wbia_cnn.models.viewpoint.ViewpointModel.rrr">
<span class="sig-name descname"><span class="pre">rrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.viewpoint.ViewpointModel.rrr" title="Permalink to this definition"></a></dt>
<dd><p>special class reloading function
This function is often injected as rrr of classes</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-wbia_cnn.models">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-wbia_cnn.models" title="Permalink to this headline"></a></h2>
<dl class="py data">
<dt class="sig sig-object py" id="wbia_cnn.models.IMPORT_TUPLES">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.</span></span><span class="sig-name descname"><span class="pre">IMPORT_TUPLES</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[('_model_legacy',</span> <span class="pre">None),</span> <span class="pre">('abstract_models',</span> <span class="pre">None),</span> <span class="pre">('aoi2',</span> <span class="pre">None),</span> <span class="pre">('background',</span> <span class="pre">None),</span> <span class="pre">('classifier',</span> <span class="pre">None),</span> <span class="pre">('classifier2',</span> <span class="pre">None),</span> <span class="pre">('labeler',</span> <span class="pre">None),</span> <span class="pre">('dummy',</span> <span class="pre">None),</span> <span class="pre">('mnist',</span> <span class="pre">None),</span> <span class="pre">('pretrained',</span> <span class="pre">None),</span> <span class="pre">('quality',</span> <span class="pre">None),</span> <span class="pre">('siam',</span> <span class="pre">None),</span> <span class="pre">('viewpoint',</span> <span class="pre">None)]</span></em><a class="headerlink" href="#wbia_cnn.models.IMPORT_TUPLES" title="Permalink to this definition"></a></dt>
<dd><p>python -c “import wbia_cnn.models” –dump-wbia_cnn.models-init
python -c “import wbia_cnn.models” –update-wbia_cnn.models-init</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.reassign_submodule_attributes">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.</span></span><span class="sig-name descname"><span class="pre">reassign_submodule_attributes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models.html#reassign_submodule_attributes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.reassign_submodule_attributes" title="Permalink to this definition"></a></dt>
<dd><p>Updates attributes in the __init__ modules with updated attributes
in the submodules.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.reload_subs">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.</span></span><span class="sig-name descname"><span class="pre">reload_subs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wbia_cnn/models.html#reload_subs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wbia_cnn.models.reload_subs" title="Permalink to this definition"></a></dt>
<dd><p>Reloads wbia_cnn.models and submodules</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wbia_cnn.models.rrrr">
<span class="sig-prename descclassname"><span class="pre">wbia_cnn.models.</span></span><span class="sig-name descname"><span class="pre">rrrr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wbia_cnn.models.rrrr" title="Permalink to this definition"></a></dt>
<dd><p>Reloads wbia_cnn.models and submodules</p>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="wbia_cnn.html" class="btn btn-neutral float-left" title="wbia_cnn package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Wild Me.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>